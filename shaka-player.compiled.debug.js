(function(){var g={};
(function(window){var k,aa=this;function p(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function q(a,b){function c(){}c.prototype=b.prototype;a.Yb=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Xb=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2015 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function ba(){};function ca(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}ca("error");ca("warn");ca("info");ca("log");ca("debug");function da(a){ea[a]={la:fa(),end:NaN}}function ga(a){if(a=ea[a])a.end=fa()}function ha(a){return(a=ea[a])&&a.end?a.end-a.la:NaN}var fa=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,ea={};function ia(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}p("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function ja(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.minHeight=this.maxHeight=null}ja.prototype.clone=function(){var a=new ja;a.maxHeight=this.maxHeight;a.minHeight=this.minHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function r(){this.fontSize="100%";this.fontColor=ka;this.fontOpacity=la;this.backgroundColor=ma;this.backgroundOpacity=la;this.fontEdge=na}p("shaka.player.TextStyle",r);r.prototype.a=function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b=JSON.parse(a)}catch(c){return}if(b&&"object"==typeof b){var a=b,d;for(d in a)d in this&&(this[d]=a[d])}}};r.prototype.load=r.prototype.a;r.prototype.b=function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))};
r.prototype.store=r.prototype.b;function oa(a){var b=[];b.push("font-size: "+a.fontSize);b.push("color: "+pa(a.fontColor,a.fontOpacity));b.push("background-color: "+pa(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d<a.fontEdge.length;++d){var e=a.fontEdge[d].slice(3,6);c.push(pa(a.fontEdge[d].slice(0,3),a.fontOpacity)+" "+e.join("px ")+"px")}b.push("text-shadow: "+c.join(","));return b.join("; ")}function pa(a,b){return"rgba("+a.concat(b).join(",")+")"}var ka=[255,255,255],ma=[0,0,0];
r.StandardColors={WHITE:ka,BLACK:ma,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var la=1;r.StandardOpacities={OPAQUE:la,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var na=[];
r.EdgeStyles={NONE:na,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function qa(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}p("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function ra(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function sa(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}p("shaka.player.VideoTrack.compare",sa);function ta(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=ua)}p("shaka.polyfill.CustomEvent.install",ta);function ua(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function wa(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
xa);document.addEventListener("webkitfullscreenerror",xa);document.addEventListener("mozfullscreenchange",xa);document.addEventListener("mozfullscreenerror",xa);document.addEventListener("MSFullscreenChange",xa);document.addEventListener("MSFullscreenError",xa)}p("shaka.polyfill.Fullscreen.install",wa);function xa(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function ya(){return Promise.reject(Error("The key system specified is not supported."))}function za(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Aa(){throw new TypeError("Illegal constructor.");}Aa.prototype.createSession=function(){};Aa.prototype.setServerCertificate=function(){};function Ba(){throw new TypeError("Illegal constructor.");}Ba.prototype.getConfiguration=function(){};Ba.prototype.createMediaKeys=function(){};function u(a){this.c=[];this.b=[];this.aa=Ca;if(a)try{a(this.V.bind(this),this.a.bind(this))}catch(b){this.a(b)}}var Ca=0;function Da(){window.Promise||(window.Promise=u,window.Promise.resolve=Ea,window.Promise.reject=Fa,window.Promise.all=Ga,window.Promise.race=Ia,window.setImmediate?(Ja=function(a){return window.setImmediate(a)},Ka=function(a){return window.clearImmediate(a)}):(Ja=function(a){return window.setTimeout(a,0)},Ka=function(a){return window.clearTimeout(a)}))}
p("shaka.polyfill.Promise.install",Da);function Ea(a){var b=new u;b.V(a);return b}function Fa(a){var b=new u;b.a(a);return b}function Ga(a){function b(a,b,c){a.aa==Ca&&(e[b]=c,d++,d==e.length&&a.V(e))}var c=new u;if(!a.length)return c.V([]),c;for(var d=0,e=Array(a.length),f=c.a.bind(c),g=0;g<a.length;++g)a[g]&&a[g].then?a[g].then(b.bind(null,c,g),f):b(c,g,a[g]);return c}function Ia(a){for(var b=new u,c=b.V.bind(b),d=b.a.bind(b),e=0;e<a.length;++e)a[e]&&a[e].then?a[e].then(c,d):c(a[e]);return b}
u.prototype.then=function(a,b){var c=new u;switch(this.aa){case 1:La(this,c,a);break;case 2:La(this,c,b);break;case Ca:this.c.push({Ha:c,Aa:a}),this.b.push({Ha:c,Aa:b})}return c};u.prototype.then=u.prototype.then;u.prototype.catch=function(a){return this.then(void 0,a)};u.prototype["catch"]=u.prototype.catch;u.prototype.V=function(a){if(this.aa==Ca){this.wa=a;this.aa=1;for(a=0;a<this.c.length;++a)La(this,this.c[a].Ha,this.c[a].Aa);this.c=[];this.b=[]}};
u.prototype.a=function(a){if(this.aa==Ca){this.wa=a;this.aa=2;for(a=0;a<this.b.length;++a)La(this,this.b[a].Ha,this.b[a].Aa);this.c=[];this.b=[]}};function La(a,b,c){Ma.push(function(){if(c&&"function"==typeof c){try{var a=c(this.wa)}catch(e){b.a(e);return}a instanceof u?a==b?b.a(new TypeError("Chaining cycle detected")):a.then(b.V.bind(b),b.a.bind(b)):b.V(a)}else 1==this.aa?b.V(this.wa):b.a(this.wa)}.bind(a));null==Na&&(Na=Ja(Oa))}
function Oa(){for(;Ma.length;){null!=Na&&(Ka(Na),Na=null);var a=Ma;Ma=[];for(var b=0;b<a.length;++b)a[b]()}}function Ja(){return 0}function Ka(){}var Na=null,Ma=[];function Pa(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=Qa)}p("shaka.polyfill.VideoPlaybackQuality.install",Pa);function Qa(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}};function Ra(a,b){for(var c=[],d=0;d<a.length;++d){for(var e=!1,f=0;f<c.length&&!(e=b?b(a[d],c[f]):a[d]===c[f]);++f);e||c.push(a[d])}return c};function v(){return Date.now()+Sa}var Sa=0;function Ta(a){this.b=a;this.c=0==Ua;this.a=0}var Ua=1;function Va(a){return a.a<a.b.byteLength}function Wa(a){var b=a.b.getUint8(a.a);a.a+=1;return b}function w(a){var b=a.b.getUint32(a.a,a.c);a.a+=4;return b}function Xa(a){var b,c;a.c?(b=a.b.getUint32(a.a,!0),c=a.b.getUint32(a.a+4,!0)):(c=a.b.getUint32(a.a,!1),b=a.b.getUint32(a.a+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.a+=8;return c*Math.pow(2,32)+b}
function Ya(a){if(a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a+=16;return b}function Za(a,b){if(a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b};function $a(a){this.b=a;this.a=new Ta(a);ab||(ab=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var ab;
function bb(a){var b;b=cb(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=cb(a);a:{for(d=0;d<ab.length;d++)if(db(c,ab[d])){d=!0;break a}d=!1}if(d)c=a.b.byteLength-a.a.a;else{if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d}c=a.a.a+c<=a.b.byteLength?c:a.b.byteLength-a.a.a;d=new DataView(a.b.buffer,
a.b.byteOffset+a.a.a,c);Za(a.a,c);return new eb(b,d)}function cb(a){var b=Wa(a.a),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=Wa(a.a);return d}function eb(a,b){this.id=a;this.a=b}
function fb(a){if(8<a.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.a.byteLength&&a.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.a.byteLength;c++)var d=a.a.getUint8(c),b=256*b+d;return b};var gb={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function hb(a){this.c=Math.exp(Math.log(.5)/a);this.a=this.b=0}hb.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b;this.a+=a};function ib(a){return a.b/(1-Math.pow(a.c,a.a))};function x(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function y(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function jb(a,b,c){kb(b);kb(c);return c==b||a>=lb&&c==b.split("-")[0]||a>=mb&&c.split("-")[0]==b.split("-")[0]?!0:!1}var lb=1,mb=2;function kb(a){a=a.toLowerCase().split("-");var b=nb[a[0]];b&&(a[0]=b);return a.join("-")}
var nb={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function ob(a){return Object.keys(a).map(function(b){return a[b]})}function pb(a,b){return qb(a,b,"boolean")}function rb(a,b){var c=qb(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function sb(a,b){return qb(a,b,"string")}
function qb(a,b,c){a=a[b];if(null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}function tb(a,b,c){a=a[b];if(null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a};function z(){this.a={}}z.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]};z.prototype.set=function(a,b){this.a[a]=b};z.prototype.get=function(a){return(a=this.a[a])?a.slice():null};function ub(a){var b=[],c;for(c in a.a)b.push.apply(b,a.a[c]);return b}function vb(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function wb(a){var b=[],c;for(c in a.a)b.push(c);return b};function B(){this.a=new z}B.prototype.destroy=function(){xb(this);this.a=null};function C(a,b,c,d){b=new yb(b,c,d);a.a.push(c,b)}B.prototype.ra=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.ra(),vb(this.a,b,e))}};function xb(a){for(var b=ub(a.a),c=0;c<b.length;++c)b[c].ra();a.a.a={}}function yb(a,b,c){this.target=a;this.type=b;this.a=c;this.target.addEventListener(b,c,!1)}
yb.prototype.ra=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};function D(a){this.ya=new z;this.s=a}p("shaka.util.FakeEventTarget",D);D.prototype.addEventListener=function(a,b,c){c||this.ya.push(a,b)};D.prototype.removeEventListener=function(a,b,c){c||vb(this.ya,a,b)};
D.prototype.dispatchEvent=function(a){a.hasOwnProperty("srcElement")||(delete a.srcElement,Object.defineProperty(a,"srcElement",{get:function(){return null}}));if(a.hasOwnProperty("target"))a.target=this;else{delete a.target;var b=this;Object.defineProperty(a,"target",{get:function(){return b},set:function(a){b=a}})}if(a.hasOwnProperty("currentTarget"))a.currentTarget=null;else{delete a.currentTarget;var c=null;Object.defineProperty(a,"currentTarget",{get:function(){return c},set:function(a){c=a}})}return zb(this,
a)};function zb(a,b){b.currentTarget=a;for(var c=a.ya.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.s&&b.bubbles&&zb(a.s,b);return b.defaultPrevented};function Ab(){D.call(this,null);this.a=new hb(3);this.c=new hb(10);this.b=0}q(Ab,D);p("shaka.util.EWMABandwidthEstimator",Ab);Ab.prototype.sample=function(a,b){if(!(65536>b)){a=Math.max(a,50);var c=8E3*b/a,d=a/1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(x({type:"bandwidth"}));this.b=Date.now()}};Ab.prototype.getBandwidth=function(){return.5>this.a.a?5E5:Math.min(ib(this.a),ib(this.c))};Ab.prototype.getDataAge=function(){return(Date.now()-this.b)/1E3};
Ab.prototype.supportsCaching=function(){return!1};function E(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;c.destroy=E.prototype.destroy;return c}E.prototype.destroy=function(){this.catch(function(){});var a=Error("Destroyed!");a.type="destroy";this.reject(a)};function Bb(a){return a.split("").reduce(function(a,c,d){return a+(d&&0==d%4?" "+c:c)})};function Cb(){this.g=new E;this.f=!1;this.a=null;this.b=[];this.c=null}function Db(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}Cb.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0;this.b.unshift(function(){});Eb(this,void 0)};Cb.prototype.end=function(){this.b.splice(1)};
function Eb(a,b){var c=a.b[0](b),d;c?(d=c[0],a.c=c[1]):(d=Promise.resolve(),a.c=null);d.then(F(a,function(a){this.a?(this.b=[],this.c=null,Fb(this)):(this.b.shift(),this.b.length?Eb(this,a):(this.g.resolve(a),this.c=null))})).catch(F(a,function(a){this.b=[];this.c=null;this.a?Fb(this):this.g.reject(a)}))}function Fb(a){var b=Error("Task aborted.");b.type="aborted";a.g.reject(b);window.setTimeout(function(){this.a.resolve();this.a=null}.bind(a),5)};function F(a,b){return b.bind(a)};function Gb(a,b){D.call(this,b);this.a=null;this.h=a}q(Gb,D);
function Hb(a){if(!window.indexedDB)return a=Error("Persistant storage requires IndexedDB support."),a.type="storage",Promise.reject(a);if(a.a)return a=Error("A database connection is already open."),a.type="storage",Promise.reject(a);var b=new E,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=F(a,function(a){this.a=a.target.result;Ib(this,"group_store",{keyPath:"group_id"});Ib(this,"stream_index_store",{keyPath:"stream_id"});a=Ib(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",
["stream_id","segment_id"],{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=F(a,function(a){this.a=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function Jb(a){a.a&&(a.a.close(),a.a=null)}function Ib(a,b,c){a.a.objectStoreNames.contains(b)&&a.a.deleteObjectStore(b);return a.a.createObjectStore(b,c)}function Kb(a){return Lb(a,"content_store")}function Mb(a){return Lb(a,"stream_index_store")}function Ob(a){return Lb(a,"group_store")}
function Lb(a,b){return a.a.transaction([b],a.h).objectStore(b)}function Pb(a,b){var c=new E,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c};function Qb(){Gb.call(this,"readonly",null)}q(Qb,Gb);function Rb(a){var b=new E,c=[],d=Ob(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function Sb(a,b){return Pb(Ob(a),b).then(F(a,function(a){a.session_ids=Ra(a.session_ids);return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):Tb(this,a.stream_ids[0]).then(function(b){a.duration=b.duration;a.key_system=b.key_system;a.license_server=b.license_server;a.with_credentials=b.with_credentials;a.distinctive_identifier=b.distinctive_identifier;a.audio_robustness=b.audio_robustness;a.video_robustness=b.video_robustness;return Promise.resolve(a)})}))}
function Tb(a,b){return Pb(Mb(a),b)}function Ub(a,b,c){return Pb(Kb(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})};function Vb(a,b,c){MediaSource.isTypeSupported(b);b=a.addSourceBuffer(b);this.i=a;this.c=b;this.l=c;this.j=new B;this.g=null;this.b=[];this.u=0;this.f=this.a=null;this.o=0;C(this.j,this.c,"updateend",this.w.bind(this))}var Wb=1/60;Vb.prototype.destroy=function(){Xb(this).catch(function(){});this.f&&this.f.destroy();this.a=this.f=null;this.g&&(Jb(this.g),this.g=null);this.b=null;this.j.destroy();this.i=this.c=this.j=null};
function Yb(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-Wb,f=c.end(d)+Wb;if(b>=e&&b<=f)return c.end(d)-b}return 0}
Vb.prototype.fetch=function(a,b,c){if(this.a)return b=Error("Cannot fetch ("+this.s+"): previous operation not complete."),b.type="stream",Promise.reject(b);this.a=new Cb;b!=this.c.timestampOffset&&(this.c.timestampOffset=b);"idb"!=a.url.M[0].L||this.g||(this.g=new Qb,Db(this.a,function(){return[Hb(this.g)]}.bind(this)));c&&Db(this.a,function(){return[Zb(this,c),this.h.bind(this)]}.bind(this));Db(this.a,function(){var b=a.endTime?a.endTime-a.startTime:1,c=new $b;c.a=3;c.g=1E3*b;c.c=1E3*this.o;c.h=
this.g;return[a.url.fetch(c,this.l),G.prototype.c.bind(a.url)]}.bind(this));Db(this.a,F(this,function(a){this.l.getBandwidth();return[Zb(this,a),this.h.bind(this)]}));var d=0==this.c.buffered.length&&0==this.b.length,e=null;Db(this.a,function(){if(0==this.c.buffered.length){var b=Error("Failed to buffer segment ("+this.s+").");b.type="stream";return[Promise.reject(b)]}d&&(b=a.startTime,e=this.c.buffered.start(0)-b);b=ac(this.b,a.startTime);0<=b?this.b.splice(b+1,0,a):this.b.push(a)}.bind(this));return bc(this).then(function(){return Promise.resolve(e)}.bind(this))};
function cc(a){if(a.a)return a=Error("Cannot clear ("+a.s+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new Cb;Db(a.a,function(){var a;a:if(0==this.c.buffered.length)a=Promise.resolve();else{try{this.c.remove(0,this.i.duration)}catch(c){a=Promise.reject(c);break a}this.b=[];a=this.f=new E}return[a,this.h.bind(this)]}.bind(a));return bc(a)}
function dc(a,b){if(a.a){var c=Error("Cannot clearAfter ("+a.s+"): previous operation not complete.");c.type="stream";return Promise.reject(c)}a.a=new Cb;Db(a.a,function(){return[ec(this,b),this.h.bind(this)]}.bind(a));return bc(a)}function Xb(a){a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new E,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve();return a}function bc(a){a.a.start();return a.a.g.then(F(a,function(){this.a=null})).catch(F(a,function(a){this.a=null;return Promise.reject(a)}))}
function Zb(a,b){try{a.c.appendBuffer(b)}catch(c){return Promise.reject(c)}a.f=new E;return a.f}function ec(a,b){if(0==a.c.buffered.length)return Promise.resolve();var c=ac(a.b,b);if(-1==c||c==a.b.length-1)return Promise.resolve();try{a.c.remove(a.b[c+1].startTime,a.i.duration)}catch(d){return Promise.reject(d)}a.b=a.b.slice(0,c+1);a.f=new E;return a.f}Vb.prototype.h=function(){this.f&&"open"==this.i.readyState&&this.c.abort()};Vb.prototype.w=function(){this.f&&(this.f.resolve(),this.f=null)};function fc(a){return String.fromCharCode.apply(null,a)}p("shaka.util.Uint8ArrayUtils.toString",fc);function gc(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}p("shaka.util.Uint8ArrayUtils.fromString",gc);p("shaka.util.Uint8ArrayUtils.toBase64",function(a,b){var c=void 0==b?!0:b,d=window.btoa(fc(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")});function hc(a){return gc(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
p("shaka.util.Uint8ArrayUtils.fromBase64",hc);p("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function ic(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}p("shaka.util.Uint8ArrayUtils.toHex",ic);function db(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function jc(){this.h=this.a="";this.withCredentials=!1;this.l=this.s=null;this.j=this.g=!1;this.i=this.f="";this.c=null;this.b=[]}
function kc(a){var b=new jc;if(!a)return b;var c=sb(a,"keySystem");if(null!=c)b.a=c;else throw Error("'keySystem' cannot be null.");var d=sb(a,"licenseServerUrl");if(null!=d)b.h=d;else if(c)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");c=pb(a,"withCredentials");null!=c&&(b.withCredentials=c);c=tb(a,"licensePostProcessor",Function);null!=c&&(b.s=c);c=tb(a,"licensePreProcessor",Function);null!=c&&(b.l=c);c=pb(a,"distinctiveIdentifierRequired");null!=c&&
(b.g=c);c=pb(a,"persistentStateRequired");null!=c&&(b.j=c);c=sb(a,"audioRobustness");null!=c&&(b.f=c);c=sb(a,"videoRobustness");null!=c&&(b.i=c);c=tb(a,"serverCertificate",Uint8Array);null!=c&&(b.c=c);if(c=tb(a,"initData",Object)){a=tb(c,"initData",Uint8Array);if(null==a)throw Error("'initData.initData' cannot be null.");c=sb(c,"initDataType");if(null==c)throw Error("'initData.initDataType' cannot be null.");b.b.push({initData:new Uint8Array(a.buffer),initDataType:c})}return b}
function lc(a,b){var c=new jc;c.a=a.a;c.h=a.h;c.withCredentials=a.withCredentials;c.s=a.s;c.l=a.l;c.g=a.g;c.j=a.j;c.f=a.f;c.i=a.i;c.c=a.c?new Uint8Array(a.c.buffer):null;mc(c,a.b);mc(c,b.b);return c}function mc(a,b){var c=a.b.concat(b.map(function(a){return{initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType}}));a.b=Ra(c,nc)}function nc(a,b){return a.initDataType==b.initDataType&&db(a.initData,b.initData)};function oc(a,b){try{var c=new pc(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function qc(a){var b=this.mediaKeys;b&&b!=a&&rc(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&rc(a,this);return Promise.resolve()}
function pc(a,b){this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},l=!1;if(g.audioCapabilities)for(var m=0;m<g.audioCapabilities.length;++m){var n=g.audioCapabilities[m];
n.contentType&&(l=!0,e.canPlayType(n.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(n),d=!0))}if(g.videoCapabilities)for(m=0;m<g.videoCapabilities.length;++m)n=g.videoCapabilities[m],n.contentType&&(l=!0,e.canPlayType(n.contentType,this.a)&&(h.videoCapabilities.push(n),d=!0));l||(d=e.canPlayType("video/mp4",this.a)||e.canPlayType("video/webm",this.a));"required"==g.persistentState&&(c?(h.persistentState="required",h.sessionTypes=["persistent-license"]):d=!1);if(d){this.b=h;return}}c=
"Unsupported keySystem";if("org.w3.clearkey"==a||"com.widevine.alpha"==a)c="None of the requested configurations were supported.";c=Error(c);c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}pc.prototype.createMediaKeys=function(){var a=new sc(this.a);return Promise.resolve(a)};pc.prototype.getConfiguration=function(){return this.b};function sc(a){this.g=a;this.b=null;this.a=new B;this.c=[];this.f={}}
function rc(a,b){a.b=b;xb(a.a);b&&(C(a.a,b,"webkitneedkey",a.Ob.bind(a)),C(a.a,b,"webkitkeymessage",a.Nb.bind(a)),C(a.a,b,"webkitkeyadded",a.Lb.bind(a)),C(a.a,b,"webkitkeyerror",a.Mb.bind(a)))}k=sc.prototype;k.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.b||document.createElement("video");a.src||(a.src="about:blank");b=new tc(a,this.g,b);this.c.push(b);return b};
k.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};k.Ob=function(a){a=x({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a)};k.Nb=function(a){var b=uc(this,a.sessionId);b&&(a=x({type:"message",messageType:void 0==b.keyStatuses.Ea()?"licenserequest":"licenserenewal",message:a.message}),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a))};
k.Lb=function(a){if(a=uc(this,a.sessionId))vc(a,"usable"),a.a&&a.a.resolve(),a.a=null};
k.Mb=function(a){var b=uc(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode=a.errorCode;c.errorCode.systemCode=a.systemCode;!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?vc(b,"output-restricted"):1==c?vc(b,"expired"):vc(b,"internal-error"))}};
function uc(a,b){var c=a.f[b];return c?c:(c=a.c.shift())?(c.sessionId=b,a.f[b]=c):null}function tc(a,b,c){D.call(this,null);this.f=a;this.h=!1;this.a=this.b=null;this.c=b;this.g=c;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new wc}q(tc,D);
function xc(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var d;try{if("persistent-license"==a.g)if(c)d=gc("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=gc("PERSISTENT|"+fc(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.b=new E;try{a.f.webkitGenerateKeyRequest(a.c,d)}catch(g){if("InvalidStateError"!=g.name)return a.b=null,Promise.reject(g);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,d)}catch(a){this.b.reject(a),
this.b=null}}.bind(a),10)}return a.b}k=tc.prototype;k.Pa=function(a,b){if(this.a)this.a.then(this.Pa.bind(this,a,b)).catch(this.Pa.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=fc(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=hc(d.keys[0].k),d=hc(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}};
function vc(a,b){a.keyStatuses.La(b);var c=x({type:"keystatuseschange"});a.dispatchEvent(c)}k.generateRequest=function(a,b){return xc(this,b,null)};k.load=function(a){return"persistent-license"==this.g?xc(this,null,a):Promise.reject(Error("Not a persistent session."))};k.update=function(a){var b=new E;this.Pa(b,a);return b};
k.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}this.closed.resolve();return this.closed};k.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function wc(){this.size=0;this.a=void 0}var yc;k=wc.prototype;k.La=function(a){this.size=void 0==a?0:1;this.a=a};k.Ea=function(){return this.a};
k.forEach=function(a){this.a&&a(yc,this.a)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=yc;return this.a&&db(new Uint8Array(a),new Uint8Array(b))?!0:!1};function zc(a){this.systemIds=[];this.cencKeyIds=[];this.a=[];a=new Ta(new DataView(a.buffer));try{for(;Va(a);){var b=a.a,c=w(a),d=w(a);1==c?c=Xa(a):0==c&&(c=a.b.byteLength-b);if(1886614376!=d)Za(a,c-(a.a-b));else{var e=Wa(a);if(1<e)Za(a,c-(a.a-b));else{Za(a,3);var f=ic(Ya(a)),g=[];if(0<e)for(var h=w(a),l=0;l<h;++l){var m=ic(Ya(a));g.push(m)}var n=w(a);Za(a,n);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);this.a.push({start:b,end:a.a-1});a.a!=b+c&&Za(a,c-(a.a-b))}}}}catch(t){}}
;function Ac(a,b){try{var c=new Bc(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}
function Bc(a,b){this.keySystem=a;for(var c=!1,d=0;d<b.length;++d){var e=b[d],f={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"]},g=!1;if(e.audioCapabilities)for(var h=0;h<e.audioCapabilities.length;++h){var l=e.audioCapabilities[h];if(l.contentType){var g=!0,m=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,m)&&(f.audioCapabilities.push(l),c=!0)}}if(e.videoCapabilities)for(h=
0;h<e.videoCapabilities.length;++h)l=e.videoCapabilities[h],l.contentType&&(g=!0,m=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,m)&&(f.videoCapabilities.push(l),c=!0));g||(c=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==e.persistentState&&(f.persistentState="required",f.sessionTypes=["persistent-license"]);if(c){this.a=f;return}}c=Error("Unsupported keySystem");c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}
Bc.prototype.createMediaKeys=function(){var a=new Cc(this.keySystem);return Promise.resolve(a)};Bc.prototype.getConfiguration=function(){return this.a};function Dc(a){var b=this.mediaKeys;b&&b!=a&&Ec(b,null);delete this.mediaKeys;return(this.mediaKeys=a)?Ec(a,this):Promise.resolve()}function Cc(a){this.a=new MSMediaKeys(a);this.b=new B}Cc.prototype.createSession=function(a){if("temporary"!=(a||"temporary"))throw new TypeError("Session type "+a+" is unsupported on this platform.");return new Fc(this.a)};
Cc.prototype.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};function Ec(a,b){function c(){b.msSetMediaKeys(d.a);b.removeEventListener("loadedmetadata",c)}xb(a.b);if(!b)return Promise.resolve();C(a.b,b,"msneedkey",Gc);var d=a;try{return 1<=b.readyState?b.msSetMediaKeys(a.a):b.addEventListener("loadedmetadata",c),Promise.resolve()}catch(e){return Promise.reject(e)}}
function Fc(a){D.call(this,null);this.c=null;this.g=a;this.b=this.a=null;this.f=new B;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new Hc}q(Fc,D);k=Fc.prototype;k.generateRequest=function(a,b){this.a=new E;try{this.c=this.g.createSession("video/mp4",new Uint8Array(b),null),C(this.f,this.c,"mskeymessage",this.Bb.bind(this)),C(this.f,this.c,"mskeyadded",this.zb.bind(this)),C(this.f,this.c,"mskeyerror",this.Ab.bind(this)),Ic(this,"status-pending")}catch(c){this.a.reject(c)}return this.a};
k.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))};k.update=function(a){this.b=new E;try{this.c.update(new Uint8Array(a))}catch(b){this.b.reject(b)}return this.b};k.close=function(){try{this.c.close(),this.closed.resolve(),xb(this.f)}catch(a){this.closed.reject(a)}return this.closed};k.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function Gc(a){var b=a.initData;if(b){var c=new zc(b);if(1>=c.a.length)a=b;else{var d=[];for(a=0;a<c.a.length;a++)d.push(b.subarray(c.a[a].start,c.a[a].end+1));b=Ra(d,Jc);for(a=c=0;a<b.length;a++)c+=b[a].length;c=new Uint8Array(c);for(a=d=0;a<b.length;a++)c.set(b[a],d),d+=b[a].length;a=c}}else a=b;a=x({type:"encrypted",initDataType:"cenc",initData:a});this.dispatchEvent(a)}function Jc(a,b){return db(a,b)}
k.Bb=function(a){this.a&&(this.a.resolve(),this.a=null);a=x({type:"message",messageType:void 0==this.keyStatuses.Ea()?"licenserequest":"licenserenewal",message:a.message.buffer});this.dispatchEvent(a)};k.zb=function(){this.a?(this.a.resolve(),this.a=null):this.b&&(Ic(this,"usable"),this.b.resolve(),this.b=null)};
k.Ab=function(){var a=Error("EME v20140218 key error");a.errorCode=this.c.error;if(null!=this.a)this.a.reject(a),this.a=null;else if(null!=this.b)this.b.reject(a),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Ic(this,"output-not-allowed");default:Ic(this,"internal-error")}};function Ic(a,b){a.keyStatuses.La(b);var c=x({type:"keystatuseschange"});a.dispatchEvent(c)}function Hc(){this.size=0;this.a=void 0}var Kc;
k=Hc.prototype;k.La=function(a){this.size=void 0==a?0:1;this.a=a};k.Ea=function(){return this.a};k.forEach=function(a){this.a&&a(Kc,this.a)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=Kc;return this.a&&db(new Uint8Array(a),new Uint8Array(b))?!0:!1};function Lc(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(yc=(new Uint8Array([0])).buffer,Navigator.prototype.requestMediaKeySystemAccess=oc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=qc,window.MediaKeys=sc,window.MediaKeySystemAccess=pc):window.MSMediaKeys?(Kc=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Dc,window.MediaKeys=Cc,window.MediaKeySystemAccess=Bc,Navigator.prototype.requestMediaKeySystemAccess=Ac):(Navigator.prototype.requestMediaKeySystemAccess=ya,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=za,window.MediaKeys=Aa,window.MediaKeySystemAccess=Ba))}p("shaka.polyfill.MediaKeys.install",Lc);p("shaka.polyfill.installAll",function(){ta();wa();Pa();Da();Lc()});var Mc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function H(a){var b;a instanceof H?(Nc(this,a.L),this.ba=a.ba,this.O=a.O,Oc(this,a.ga),this.K=a.K,Pc(this,a.a.clone()),this.$=a.$):a&&(b=String(a).match(Mc))?(Nc(this,b[1]||"",!0),this.ba=Qc(b[2]||""),this.O=Qc(b[3]||"",!0),Oc(this,b[4]),this.K=Qc(b[5]||"",!0),Pc(this,b[6]||"",!0),this.$=Qc(b[7]||"")):this.a=new Rc(null)}k=H.prototype;k.L="";k.ba="";k.O="";k.ga=null;k.K="";k.$="";
k.toString=function(){var a=[],b=this.L;b&&a.push(Tc(b,Uc,!0),":");if(b=this.O){a.push("//");var c=this.ba;c&&a.push(Tc(c,Uc,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.ga;null!=b&&a.push(":",String(b))}if(b=this.K)this.O&&"/"!=b.charAt(0)&&a.push("/"),a.push(Tc(b,"/"==b.charAt(0)?Vc:Wc,!0));(b=this.a.toString())&&a.push("?",b);(b=this.$)&&a.push("#",Tc(b,Xc));return a.join("")};
k.resolve=function(a){var b=this.clone();"data"===b.L&&(b=new H);var c=!!a.L;c?Nc(b,a.L):c=!!a.ba;c?b.ba=a.ba:c=!!a.O;c?b.O=a.O:c=null!=a.ga;var d=a.K;if(c)Oc(b,a.ga);else if(c=!!a.K){if("/"!=d.charAt(0))if(this.O&&!this.K)d="/"+d;else{var e=b.K.lastIndexOf("/");-1!=e&&(d=b.K.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||
1==f.length&&""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.K=d:c=""!==a.a.toString();c?Pc(b,a.a.clone()):c=!!a.$;c&&(b.$=a.$);return b};k.clone=function(){return new H(this)};function Nc(a,b,c){a.L=c?Qc(b,!0):b;a.L&&(a.L=a.L.replace(/:$/,""))}function Oc(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.ga=b}else a.ga=null}function Pc(a,b,c){b instanceof Rc?a.a=b:(c||(b=Tc(b,Yc)),a.a=new Rc(b))}
function Qc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function Tc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Zc),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Zc(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Uc=/[#\/\?@]/g,Wc=/[\#\?:]/g,Vc=/[\#\?]/g,Yc=/[\#\?@]/g,Xc=/#/g;function Rc(a){this.b=a||null}Rc.prototype.a=null;Rc.prototype.c=null;
function $c(a,b,c){if(!a.a&&(a.a={},a.c=0,a.b))for(var d=a.b.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];g=decodeURIComponent(g.replace(/\+/g," "));h=h||"";$c(a,g,decodeURIComponent(h.replace(/\+/g," ")))}a.b=null;(d=a.a.hasOwnProperty(b)&&a.a[b])||(a.a[b]=d=[]);d.push(c);a.c++}
Rc.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var a=[],b;for(b in this.a)for(var c=encodeURIComponent(b),d=this.a[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.b=a.join("&")};Rc.prototype.clone=function(){var a=new Rc;a.b=this.b;if(this.a){var b={},c;for(c in this.a)b[c]=this.a[c].concat();a.a=b;a.c=this.c}return a};function ad(){this.id=this.url=null;this.type="static";this.b=this.j=this.m=this.gb=null;this.h=5;this.f=this.c=this.g=null;this.i=1;this.a=[]}function bd(){this.g=this.f=this.c=this.m=this.a=this.start=this.id=null;this.b=[]}function cd(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=!1;this.h=this.g=this.f=this.m=null;this.j=[];this.a=[]}function dd(){this.value=null}function ed(){this.contentType=this.lang=this.id=null}
function fd(){this.a=this.b=this.g=this.m=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[]}function gd(){this.b=this.a=this.c=this.f=null}function hd(){this.parsedPssh=this.psshBox=null}function id(){this.url=null}function jd(){this.url=null}function kd(){this.m=null;this.g=1;this.c=this.b=this.a=this.f=null}kd.prototype.clone=function(){var a=new kd;a.m=ld(this.m);a.g=this.g;a.f=this.f;a.a=I(this.a);a.b=I(this.b);a.c=I(this.c);return a};
function md(){this.a=this.url=null}md.prototype.clone=function(){var a=new md;a.url=ld(this.url);a.a=I(this.a);return a};function nd(){this.a=this.url=null}nd.prototype.clone=function(){var a=new nd;a.url=ld(this.url);a.a=I(this.a);return a};function od(){this.m=null;this.f=1;this.b=this.g=null;this.i=1;this.h=null;this.a=[];this.c=null}od.prototype.clone=function(){var a=new od;a.m=ld(this.m);a.f=this.f;a.g=this.g;a.b=this.b;a.i=this.i;a.h=I(this.h);a.a=ld(this.a)||[];a.c=I(this.c);return a};
function pd(){this.a=this.b=null}pd.prototype.clone=function(){var a=new pd;a.b=ld(this.b);a.a=I(this.a);return a};function qd(){this.a=1;this.b=this.i=null;this.j=1;this.c=this.g=this.f=this.h=null}qd.prototype.clone=function(){var a=new qd;a.a=this.a;a.i=this.i;a.b=this.b;a.j=this.j;a.h=this.h;a.f=this.f;a.g=this.g;a.c=I(this.c);return a};function rd(){this.a=[]}rd.prototype.clone=function(){var a=new rd;a.a=ld(this.a)||[];return a};function sd(){this.b=this.a=this.startTime=null}
sd.prototype.clone=function(){var a=new sd;a.startTime=this.startTime;a.a=this.a;a.b=this.b;return a};function td(a,b){this.la=a;this.end=b}td.prototype.clone=function(){return new td(this.la,this.end)};ad.TAG_NAME="MPD";bd.TAG_NAME="Period";cd.TAG_NAME="AdaptationSet";dd.TAG_NAME="Role";ed.TAG_NAME="ContentComponent";fd.TAG_NAME="Representation";gd.TAG_NAME="ContentProtection";hd.TAG_NAME="cenc:pssh";id.TAG_NAME="BaseURL";jd.TAG_NAME="Location";kd.TAG_NAME="SegmentBase";md.TAG_NAME="RepresentationIndex";
nd.TAG_NAME="Initialization";od.TAG_NAME="SegmentList";pd.TAG_NAME="SegmentURL";qd.TAG_NAME="SegmentTemplate";rd.TAG_NAME="SegmentTimeline";sd.TAG_NAME="S";
ad.prototype.parse=function(a,b){this.url=a.gb;this.id=K(b,"id",L);this.type=K(b,"type",L)||"static";this.b=K(b,"mediaPresentationDuration",ud);this.h=K(b,"minBufferTime",ud,this.h);this.g=K(b,"minimumUpdatePeriod",ud,this.g);this.c=K(b,"availabilityStartTime",vd,this.c);this.f=K(b,"timeShiftBufferDepth",ud,this.f);this.i=K(b,"suggestedPresentationDelay",ud,this.i);var c=a.m,d=M(this,b,id);this.m=wd(c,d);if(d=N(this,b,jd))this.j=xd(c,d.url);this.a=M(this,b,bd)};
bd.prototype.parse=function(a,b){this.id=K(b,"id",L);this.start=K(b,"start",ud);this.a=K(b,"duration",ud);var c=M(this,b,id);this.m=wd(a.m,c);this.c=N(this,b,kd);this.f=N(this,b,od);this.g=N(this,b,qd);this.b=M(this,b,cd);yd(this)};function yd(a){for(var b=[],c=0;c<a.b.length;++c){var d=a.b[c];null!=d.group&&(b[d.group]=!0)}for(c=0;c<a.b.length;++c)if(d=a.b[c],null==d.group){for(var e=1;1==b[e];)++e;b[e]=!0;d.group=e}}
cd.prototype.parse=function(a,b){var c=N(this,b,ed)||{},d=N(this,b,dd);this.id=K(b,"id",L);this.group=K(b,"group",P);this.lang=K(b,"lang",L,c.lang);this.contentType=K(b,"contentType",L,c.contentType);this.width=K(b,"width",Q);this.height=K(b,"height",Q);this.b=K(b,"mimeType",L);this.i=K(b,"codecs",L);this.c=d&&"main"==d.value;this.lang&&(this.lang=kb(this.lang));c=M(this,b,id);this.m=wd(a.m,c);this.j=M(this,b,gd);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=a.c?zd(this,
b,a.c):N(this,b,kd);this.g=a.f?zd(this,b,a.f):N(this,b,od);this.h=a.g?zd(this,b,a.g):N(this,b,qd);this.a=M(this,b,fd);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))};dd.prototype.parse=function(a,b){this.value=K(b,"value",L)};ed.prototype.parse=function(a,b){this.id=K(b,"id",L);this.lang=K(b,"lang",L);this.contentType=K(b,"contentType",L);this.lang&&(this.lang=kb(this.lang))};
fd.prototype.parse=function(a,b){this.id=K(b,"id",L);this.bandwidth=K(b,"bandwidth",Q);this.width=K(b,"width",Q,a.width);this.height=K(b,"height",Q,a.height);this.f=K(b,"mimeType",L,a.b);this.h=K(b,"codecs",L,a.i);this.lang=a.lang;var c=M(this,b,id);this.m=wd(a.m,c);this.c=M(this,b,gd);this.g=a.f?zd(this,b,a.f):N(this,b,kd);this.b=a.g?zd(this,b,a.g):N(this,b,od);this.a=a.h?zd(this,b,a.h):N(this,b,qd);this.c=this.c.concat(a.j)};
gd.prototype.parse=function(a,b){this.f=b;this.c=K(b,"schemeIdUri",L);var c=K(b,"cenc:default_KID",L);c&&(this.b=c.replace(/[-]/g,""));this.a=N(this,b,hd)};hd.prototype.parse=function(a,b){var c=Ad(b);if(c){this.psshBox=hc(c);try{this.parsedPssh=new zc(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};id.prototype.parse=function(a,b){this.url=Ad(b)};jd.prototype.parse=function(a,b){this.url=Ad(b)};
kd.prototype.parse=function(a,b){this.m=a.m||this.m;this.g=K(b,"timescale",Q,this.g);this.f=K(b,"presentationTimeOffset",P,this.f);this.a=K(b,"indexRange",Bd,this.a);this.b=N(this,b,md)||this.b;this.c=N(this,b,nd)||this.c};md.prototype.parse=function(a,b){var c=K(b,"sourceURL",L);this.url=xd(a.m,c);this.a=K(b,"range",Bd,I(a.a))};nd.prototype.parse=function(a,b){var c=K(b,"sourceURL",L);this.url=xd(a.m,c);this.a=K(b,"range",Bd)};
od.prototype.parse=function(a,b){this.m=a.m||this.m;this.f=K(b,"timescale",Q,this.f);this.g=K(b,"presentationTimeOffset",P,this.g);this.b=K(b,"duration",Q,this.b);var c=K(b,"startNumber",Q);null!=c&&(this.i=c);this.h=N(this,b,nd)||this.h;this.a=(c=M(this,b,pd))&&0<c.length?c:this.a;this.c=N(this,b,rd)||this.c};pd.prototype.parse=function(a,b){var c=K(b,"media",L);this.b=xd(a.m,c);this.a=K(b,"mediaRange",Bd)};
qd.prototype.parse=function(a,b){this.a=K(b,"timescale",Q,this.a);this.i=K(b,"presentationTimeOffset",P,this.i);this.b=K(b,"duration",Q,this.b);var c=K(b,"startNumber",P);null!=c&&(this.j=c);this.h=K(b,"media",L,this.h);this.f=K(b,"index",L,this.f);this.g=K(b,"initialization",L,this.g);this.c=N(this,b,rd)||this.c};rd.prototype.parse=function(a,b){this.a=M(this,b,sd)};sd.prototype.parse=function(a,b){this.startTime=K(b,"t",P);this.a=K(b,"d",P);this.b=K(b,"r",Cd)};
function wd(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new H(e)):(e=xd(a.slice(0,1),e),c.push(e[0]))}return c}function xd(a,b){if(!b)return a;var c=new H(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function zd(a,b,c){var d=I(c);(b=Dd(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function N(a,b,c){var d=null;if(b=Dd(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}
function Dd(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function M(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function Ad(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function ld(a){return a?a.map(function(a){return a.clone()}):null}function I(a){return a?a.clone():null}
function K(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function vd(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function ud(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=P(b[1]);c&&(a+=31536E3*c);(c=P(b[2]))&&(a+=2592E3*c);(c=P(b[3]))&&(a+=86400*c);(c=P(b[4]))&&(a+=3600*c);(c=P(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function Bd(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=P(b[1]);if(null==a)return null;b=P(b[2]);return null==b?null:new td(a,b)}function Cd(a){a=window.parseInt(a,10);return isNaN(a)?null:a}function Q(a){a=window.parseInt(a,10);return 0<a?a:null}function P(a){a=window.parseInt(a,10);return 0<=a?a:null}function L(a){return a};function Ed(a,b){this.url=a;this.b=b||new $b;this.g=this.i=this.h=0;this.a=null;this.c=new E;this.f=null}function $b(){this.body=null;this.a=1;this.g=1E3;this.c=0;this.method="GET";this.responseType="arraybuffer";this.b={};this.f=this.withCredentials=!1;this.h=null}var Fd=!0;function Gd(a){Hd(a);a.b.body=null;a.c.destroy();a.c=null;a.f=null}function Hd(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null);a.a=null}k=Ed.prototype;
k.send=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.b.responseType&&(b=gc(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.c;b.resolve(a);Gd(this);return b}if(0==this.url.lastIndexOf("idb:",0))return Id(this);this.h++;this.i=Date.now();
this.g||(this.g=this.b.g);window.hola_cdn&&window.hola_cdn.api&&window.hola_cdn.api.new_http_request&&(this.a=window.hola_cdn.api.new_http_request({url:this.url}));this.a||(this.a=new XMLHttpRequest);a=this.url;Fd&&(this.f&&!this.f.supportsCaching()||this.b.f)&&(a=new H(a),$c(a.a,"_",Date.now()),a=a.toString());this.a.open(this.b.method,a,!0);this.a.responseType=this.b.responseType;this.a.timeout=this.b.c;this.a.withCredentials=this.b.withCredentials;this.a.onload=this.xb.bind(this);this.b.f&&(this.a.onreadystatechange=
this.Eb.bind(this));this.a.onerror=this.Tb.bind(this);this.a.ontimeout=this.Ib.bind(this);for(b in this.b.b)this.a.setRequestHeader(b,this.b.b[b]);this.a.send(this.b.body);return this.c};function Id(a){var b=a.url.split("/");return Ub(a.b.h,parseInt(b[2],10),parseInt(b[3],10)).then(F(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.c;a.resolve(b);Gd(this);return a})).catch(F(a,function(a){Gd(this);return Promise.reject(a)}))}
function Jd(a,b,c){b=Error(b);b.type=c;b.status=a.a.status;b.url=a.url;b.method=a.b.method;b.body=a.b.body;b.xhr=a.a;return b}k.xb=function(a){this.f&&this.f.sample(Date.now()-this.i,a.loaded);200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),Gd(this)):this.h<this.b.a?Kd(this):(a=Jd(this,"HTTP error.","net"),this.c.reject(a),Gd(this))};k.Eb=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a&&(Sa=a-Date.now())}};
k.Tb=function(){var a=Jd(this,"Network failure.","net");this.c.reject(a);Gd(this)};k.Ib=function(){if(this.h<this.b.a)Kd(this);else{var a=Jd(this,"Request timed out.","net");this.c.reject(a);Gd(this)}};function Kd(a){Hd(a);window.setTimeout(a.send.bind(a),a.g*(1+.5*(2*Math.random()-1)));a.g*=2};function G(a,b,c,d){this.M=b;this.oa=c||0;this.g=null!=d?d:null;this.b=this.a=null;this.h=a;this.f=null}function Ld(a,b){return a&&0!==a.length?a.map(function(a){return a.resolve(b)}):[b]}G.prototype.fetch=function(a,b){if(this.a)return this.a;var c=a||new $b;if(this.oa||this.g)c.b.Range="bytes="+(this.oa+"-"+(null!=this.g?this.g:""));return this.a=Md(this,0,c,b)};
G.prototype.c=function(){if(this.b){this.a=null;var a=this.b;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){a.a.abort();var b=Jd(a,"Request aborted.","aborted");a.c.reject(b);Gd(a)}this.f=this.b=null}};
function Md(a,b,c,d){var e=a.M[b].toString();a.h&&(e=a.h(e,c.b)||e);a.b=new Ed(e,c);d&&(a.b.f=d);e=a.b.send().then(F(a,function(a){this.f=this.b=this.a=null;this.f=a.a?new H(a.a):this.M[b];return Promise.resolve(a.response)}));return e=e.catch(F(a,function(a){if(this.a&&b+1<this.M.length)return this.a=Md(this,b+1,c,d);this.a=this.b=null;return Promise.reject(a)}))}G.prototype.clone=function(){return new G(this.h,this.M.map(function(a){return a.clone()}),this.oa,this.g)};G.prototype.toString=function(){return this.M[0].toString()};function Nd(a,b){this.a=new $b;this.a.responseType="text";this.a.a=3;this.a.c=1E3*(null!=b?b:0);this.a.f=!0;this.b=a}Nd.prototype.send=function(){var a=this.b;return a.fetch(this.a).then(function(b){var c;c=a.M;var d=[a.f];c=(b=(new DOMParser).parseFromString(b,"text/xml"))?N({gb:c,m:d},b,ad):null;if(c)return Promise.resolve(c);c=Error("MPD parse failure.");c.type="dash";return Promise.reject(c)})};function Od(a,b,c,d){for(var e=b.a,f=[],g=0;g<d;++g){var h=g+c,l=(h-1)*e.b,m=l/e.a,n=(l+e.b)/e.a,h=Pd(a,b,e.j+h-1,l);if(!h)return null;f.push(new Qd(m,n,h))}return f}function Pd(a,b,c,d){if(!b.a)return null;var e=b.a.h;if(!e)return b.m?new G(a,b.m,0,null):null;c=Rd(e,b.id,c,b.bandwidth,d);if(!c)return null;b=Ld(b.m,c);return new G(a,b,0,null)}
function Rd(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new H(a)}catch(g){if(g instanceof URIError)return null;throw g;}}
function Sd(a,b,c){var d=0;b*=c;a=a.a;c=[];for(var e=0;e<a.length&&a[e].a;++e){var f=a[e].startTime,f=null!=f?f:d,g=a[e].b||0;0>g&&(g=a[e].a,g=e+1===a.length?Math.ceil((a[0].startTime+b-f)/g)-1:Math.ceil((a[e+1].startTime-f)/g)-1);0<c.length&&f!=d&&(c[c.length-1].end=f);for(var h=0;h<=g;++h)d=f+a[e].a,c.push({start:f,end:d}),f=d}return c};function Td(a,b){this.a=a;this.b=b||null}Td.prototype.destroy=function(){this.a&&(this.a.c(),this.a=null);this.b=null};Td.prototype.create=function(){return this.a?this.a.fetch():Promise.resolve(this.b)};function Qd(a,b,c){this.startTime=a;this.endTime=b;this.url=c}function Ud(a,b,c){return new Qd(b,c,a.url)}function ac(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.startTime&&(null==d.endTime||b<d.endTime))return c}return-1}function Vd(a,b){return a.map(function(a){return Ud(a,a.startTime+b,null!=a.endTime?a.endTime+b:null)})};function Wd(){}
Wd.prototype.parse=function(a,b,c,d){var e=null;try{a:{var f=[],g=new Ta(a),h=w(g);if(1936286840!=w(g))e=null;else{1==h&&(h=Xa(g));var l=Wa(g);Za(g,3);Za(g,4);var m=w(g);if(0==m)e=null;else{var n,t;0==l?(n=w(g),t=w(g)):(n=Xa(g),t=Xa(g));Za(g,2);var A=g.b.getUint16(g.a,g.c);g.a+=2;a=n;b=b+h+t;for(h=0;h<A;h++){var O=w(g);t=(O&2147483648)>>>31;var l=O&2147483647,J=w(g);w(g);if(1==t){e=null;break a}var va=new G(d,c,b,b+l-1);f.push(new Qd(a/m,(a+J)/m,va));a+=J;b+=l}e=f}}}}catch(Nb){if(!(Nb instanceof RangeError))throw Nb;
}return e};function R(a){this.references=a;this.i=0}R.prototype.destroy=function(){this.references=null};k=R.prototype;k.length=function(){return this.references.length};function S(a){if(0==a.references.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.references[0]}k.v=function(){if(0==this.references.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return this.references[this.references.length-1]};
k.get=function(a){if(0>a||a>=this.references.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.references[a]};k.ja=function(a){a=ac(this.references,a);return 0<=a?this.references[a]:null};k.Ga=function(a){Xd(this,a);return!0};
function Xd(a,b){a.i!=b.i&&(b=new R(Vd(b.references,a.i-b.i)));if(0==a.length())a.references=b.references.slice(0);else if(0!=b.length()&&null!=a.v().endTime&&!(null!=b.v().endTime&&b.v().endTime<a.v().endTime)){if(a.v().endTime<=S(b).startTime)var c=Ud(a.v(),a.v().startTime,S(b).startTime),c=a.references.slice(0,-1).concat([c]);else{var d;for(d=0;d<a.references.length&&!(a.references[d].endTime>=S(b).startTime);++d);a.references[d].startTime<S(b).startTime?(c=Ud(a.references[d],a.references[d].startTime,
S(b).startTime),c=a.references.slice(0,d).concat([c])):(S(a).startTime>S(b).startTime||S(b),c=a.references.slice(0,d))}a.references=c.concat(b.references)}}k.ia=function(a){var b=a-this.i;if(0==b)return 0;this.references=Vd(this.references,b);this.i=a;return b};k.Da=function(){return 0<this.length()?{start:S(this).startTime,end:this.v().endTime}:{start:0,end:0}};function T(a,b,c,d){R.call(this,a);this.g=b;this.u=c;this.f=d;this.h=this.g.b||this.g.a.reduce(function(a,b){return null==b.a?NaN:a+b.a},0)||0;this.a=this.l=this.c=null;Yd(this)}q(T,R);T.prototype.destroy=function(){this.u=this.g=null;R.prototype.destroy.call(this)};T.prototype.ja=function(a){Zd(this,v()/1E3);return R.prototype.ja.call(this,a)};T.prototype.Ga=function(a){if(!(a instanceof T))return!1;Xd(this,a);this.h=Math.max(this.h,a.h);null==this.c?(this.f=a.f,Yd(this)):$d(this);return!0};
function Yd(a){$d(a);if(0!=a.length()){a.length();var b=null!=a.v().endTime?a.v().endTime:a.v().startTime;if(a.g.c>a.f)a.c=b;else{var c=a.f-(a.g.c+a.u.start);0>c?a.c=b:c<Math.max(a.v().startTime,a.v().endTime||0)?(a.v(),a.c=b):a.c=c}a.l=a.v().startTime;a.a=S(a).startTime}}
T.prototype.ia=function(a){a=R.prototype.ia.call(this,a);Math.min.apply(null,this.references.filter(function(a){return null!=a.endTime}).map(function(a){return a.endTime-a.startTime}));null!=this.c&&(this.l+=a,this.a+=a,this.c+=a);return a};T.prototype.Da=function(){return ae(this,v()/1E3)};
function ae(a,b){Zd(a,b);if(null==a.c||null==a.l||null==a.a)return{start:0,end:0};var c=Number.POSITIVE_INFINITY;a.h&&(c=a.h);var d=b-a.f,e=a.c+d;null!=a.g.f&&(e=e-a.a-a.g.f,0<e&&(a.a+=e));a.a=Math.min(a.a,c);d=a.l+d;if(d<a.a)return{start:a.a,end:a.a};d=0<a.length()?null!=a.v().endTime?Math.min(d,a.v().endTime):d:a.a;d=Math.max(d,a.a);d=Math.min(d,c);return{start:a.a,end:d}}
function Zd(a,b){$d(a);if(null!=a.g.f)if(null==a.c)a.length();else{for(var c=a.c+(b-a.f),d=0,e=0;e<a.references.length;++e){var f=null;e<a.references.length-1?f=a.references[e+1].endTime:(f=a.references[e],f=null!=f.endTime?f.endTime+(f.endTime-f.startTime):null);if(null!=f&&f<c-a.g.f)++d;else break}0<d&&a.references.splice(0,d)}}function $d(a){if(a.h){for(var b=0,c=a.references.length-1;0<=c;--c)if(a.references[c].startTime>a.h)++b;else break;0<b&&a.references.splice(-b)}};function be(a,b,c,d,e){var f=1,g=0,h;if(a.c>d)h=null;else{var l=a.i||0,m=a.f||0;h=c.a;h=h.b/h.a;var n=d-(a.c+b.start);0>n?h=null:(m=n-2*h-m,0>m&&(m=0),m=Math.ceil(m/h)*h,n-=h,0>n?h=null:(l=Math.floor(n/h)*h-l,0>l&&(l=0),l=Math.floor(l/h)*h,h={Xa:m/h+1,current:(l>=m?l:m)/h+1}))}h&&(f=h.Xa,g=h.current-h.Xa+1);f=Od(e,c,f,g);if(null==f)throw a=Error("Failed to generate SegmentReferences."),a.type="stream",a;T.call(this,f,a,b,d);this.o=c;this.s=this.b=0<this.length()?a.c+b.start+this.v().endTime:null;
this.j=h?h.current+1:null;this.w=e}q(be,T);be.prototype.destroy=function(){this.w=this.o=null;T.prototype.destroy.call(this)};be.prototype.ja=function(a){var b=v()/1E3;me(this,b);Zd(this,b);return R.prototype.ja.call(this,a)};be.prototype.Ga=function(a){if(null!=this.b||!(a instanceof be)||null==a.b)return!1;this.b=a.b;this.s=a.s;this.j=a.j;this.f=a.f;this.h=a.h;Xd(this,a);me(this,v()/1E3);Yd(this);return!0};
be.prototype.ia=function(a){a=T.prototype.ia.call(this,a);null!=this.b&&(this.b+=a,this.s+=a);return a};be.prototype.Da=function(){var a=v()/1E3;me(this,a);return ae(this,a)};function me(a,b){if(null!=a.b&&null!=a.s&&null!=a.j){var c=a.o.a,c=c.b/c.a,d=Math.floor((a.s+(b-a.f)-a.b)/c);if(0!=d){var e=Od(a.w,a.o,a.j,d);Array.prototype.push.apply(a.references,Vd(e,a.i));a.b+=d*c;a.j+=d}}};function ne(a,b,c,d,e){this.c=a;this.a=b;this.b=c;this.g=d;this.segmentIndex_=null;this.f=e}ne.prototype.destroy=function(){this.f=this.b=this.a=this.c=null;this.segmentIndex_&&(this.segmentIndex_.destroy(),this.segmentIndex_=null)};
ne.prototype.create=function(){if(this.segmentIndex_)return Promise.resolve(this.segmentIndex_);if("dynamic"==this.c.type)try{this.segmentIndex_=new be(this.c,this.a,this.b,this.g,this.f)}catch(a){return Promise.reject(a)}else{var b;b=this.b.a;if(b=Od(this.f,this.b,1,Math.ceil(this.a.a/(b.b/b.a)))){if(0<b.length){var c=b[b.length-1];b[b.length-1]=Ud(c,c.startTime,this.a.a)}b=new R(b)}else b=null;this.segmentIndex_=b;if(!this.segmentIndex_)return b=Error("Failed to generate SegmentReferences"),b.type=
"stream",Promise.reject(b)}return Promise.resolve(this.segmentIndex_)};function oe(a,b,c,d,e){this.b=a;this.a=b;this.f=c;this.segmentIndex_=null;this.g=d;this.c=e}oe.prototype.destroy=function(){this.c=this.f=this.a=this.b=null;this.segmentIndex_&&(this.segmentIndex_.destroy(),this.segmentIndex_=null)};
oe.prototype.create=function(){if(this.segmentIndex_)return Promise.resolve(this.segmentIndex_);var a=this.f.b,b=[];a.c&&(b=Sd(a.c,a.f||1,this.a.a||0));var c=0;a.b&&a.i?c=(a.i-1)*a.b:0<b.length&&(c=b[0].start-(a.g||0));var d=a.a.length;0<b.length&&b.length!=a.a.length&&(d=Math.min(b.length,a.a.length));for(var e=[],f=0;f<d;++f){var g=a.a[f],h=c/a.f,l=null,m=null;a.b?(l=c+a.b,m=l/a.f):0<b.length?(l=b[f].end-(a.g||0),m=l/a.f):(m=h+this.a.a,l=m*a.f);var c=l,l=0,n=null;g.a&&(l=g.a.la,n=g.a.end);e.push(new Qd(h,
m,new G(this.c,g.b,l,n)))}this.segmentIndex_="dynamic"==this.b.type?new T(e,this.b,this.a,this.g):new R(e);return Promise.resolve(this.segmentIndex_)};function pe(a,b,c,d,e){this.a=a;this.b=b;this.c=c;this.g=d;this.segmentIndex_=null;this.f=e}pe.prototype.destroy=function(){this.f=this.c=this.b=this.a=null;this.segmentIndex_&&(this.segmentIndex_.destroy(),this.segmentIndex_=null)};
pe.prototype.create=function(){if(this.segmentIndex_)return Promise.resolve(this.segmentIndex_);for(var a=this.c.a,b=Sd(a.c,a.a||1,this.b.a||0),c=[],d=0;d<b.length;++d){var e=b[d].start,f=e/a.a,g=b[d].end/a.a,e=Pd(this.f,this.c,d+a.j,e);if(!e)return a=Error("Failed to generate media URL."),a.type="dash",Promise.reject(a);var h=(a.i||0)/a.a;c.push(new Qd(f-h,g-h,e))}this.segmentIndex_="dynamic"==this.a.type?new T(c,this.a,this.b,this.g):new R(c);return Promise.resolve(this.segmentIndex_)};function qe(a){this.a=a;this.segmentIndex_=null}qe.prototype.destroy=function(){this.a=null;this.segmentIndex_&&(this.segmentIndex_.destroy(),this.segmentIndex_=null)};qe.prototype.create=function(){if(this.segmentIndex_)return Promise.resolve(this.segmentIndex_);for(var a=[],b=0;b<this.a.length;++b){var c=this.a[b];a.push(new Qd(c.start_time,c.end_time,new G(null,[new H(c.url)],c.start_byte,null)))}this.a=null;this.segmentIndex_=new R(a);return Promise.resolve(this.segmentIndex_)};function re(){this.A=se++;this.id=this.F=this.segmentIndexSource=null;this.c=0;this.height=this.width=this.bandwidth=null;this.b=this.a="";this.f=[];this.J=!1;this.G=!0}var se=0;re.prototype.destroy=function(){this.segmentIndexSource&&(this.segmentIndexSource.destroy(),this.segmentIndexSource=null);this.F&&(this.F.destroy(),this.F=null)};function te(a){var b=a.a||"";a.b&&(b+='; codecs="'+a.b+'"');return b}
function ue(){this.A=ve++;this.id=null;this.contentType=this.lang="";this.b=!1;this.streamInfos=[];this.a=[]}var ve=0;ue.prototype.destroy=function(){for(var a=0;a<this.streamInfos.length;++a)this.streamInfos[a].destroy();this.a=this.streamInfos=null};function we(a){for(var b=[],c=0;c<a.a.length;++c){var d=new xe;d.id=a.A;d.a=a.a[c];d.contentType=a.contentType;d.b=a.streamInfos.length?te(a.streamInfos[0]):"";b.push(d)}return b}
function ye(){this.id=null;this.start=0;this.a=null;this.streamSetInfos=[]}ye.prototype.destroy=function(){for(var a=0;a<this.streamSetInfos.length;++a)this.streamSetInfos[a].destroy();this.streamSetInfos=null};function ze(){this.a=!1;this.g=this.f=this.c=null;this.b=0;this.periodInfos=[]}ze.prototype.destroy=function(){for(var a=0;a<this.periodInfos.length;++a)this.periodInfos[a].destroy();this.periodInfos=null};function xe(){this.id=0;this.a=null;this.b=this.contentType=""};function Ae(a,b,c,d,e){D.call(this,a);this.c=b;this.a=new Vb(c,d,e);this.u=this.segmentIndex_=this.b=null;this.D=!1;this.g=null;this.l=!1;this.i=null;this.o=!1;this.h=new E;this.j=this.f=!1;this.w=0;this.H=15;this.B=!1}q(Ae,D);Ae.prototype.C=function(a){null!=a.initialStreamBufferSize&&(this.w=Number(a.initialStreamBufferSize));null!=a.streamBufferSize&&(this.H=Number(a.streamBufferSize));null!=a.segmentRequestTimeout&&(this.a.o=Number(a.segmentRequestTimeout))};
Ae.prototype.destroy=function(){Be(this);this.h.destroy();this.b=this.h=null;this.a.destroy();this.s=this.c=this.a=null};k=Ae.prototype;k.ma=function(){return this.b};k.ab=function(){return this.segmentIndex_};k.qb=function(a){this.f||a.then(function(){this.f=!0;this.g||Ce(this,0)}.bind(this)).catch(function(){});return this.h};k.Fa=function(){return this.j};
k.qa=function(a,b,c){if(a!=this.b){var d=[a.segmentIndexSource.create(),a.F.create()];Promise.all(d).then(F(this,function(d){if(this.c){var f=this.b;this.b=a;this.segmentIndex_=d[0];this.u=d[1];this.D=!0;this.l||(f?b&&De(this,!0,c):Ce(this,0))}})).catch(F(this,function(a){"aborted"!=a.type&&(this.f?(a=y(a),this.dispatchEvent(a)):this.h.reject(a))}))}};k.ib=function(){return De(this,!1)};
function De(a,b,c){a.b&&!a.l&&(a.l=!0,Be(a),Xb(a.a).then(F(a,function(){var a=this.c.currentTime;if(!b&&0<Yb(this.a,a)&&0<=ac(this.a.b,a))return Promise.resolve();if(c)return dc(this.a,this.c.currentTime+c);this.B=!0;return cc(this.a)})).then(F(a,function(){this.l=!1;Ce(this,0)})).catch(F(a,function(a){this.l=!1;this.f?(a=y(a),this.dispatchEvent(a)):this.h.reject(a)})))}k.jb=function(a){return 0<Yb(this.a,a)&&0<=ac(this.a.b,a)};k.va=function(){};k.Ca=function(){return!0};
k.Kb=function(){if(this.o&&!this.f)this.g=null;else{var a;if(a=this.f&&!this.j)a=1<this.a.c.buffered.length?!0:!1;if(a)De(this,!0);else{this.g=null;a=this.b;var b=this.segmentIndex_,c=this.c.currentTime;Yb(this.a,this.o?c:c+(this.i||0))>=(this.o?Math.max(this.w,this.H):this.w)?(Ee(this),Ce(this,1E3/(Math.abs(this.c.playbackRate)||1))):(b=Fe(this,c,b))?(b=this.a.fetch(b,a.c,this.u),this.u=null,this.D&&(this.D=!1,Ge(this,a)),this.j=!1,b.then(F(this,function(a){null==this.i&&(this.i=a);this.B&&0<Yb(this.a,
c)&&(this.B=!1,this.c.currentTime+=.001);Ce(this,0)})).catch(F(this,function(a){if("aborted"!=a.type){var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.xhr.status)&&this.b&&Ce(this,5E3);a=y(a);this.dispatchEvent(a)}}))):(Ee(this),this.f&&!this.j&&(this.j=!0,He(this)),Ce(this,1E3))}}};function Fe(a,b,c){a=a.a;var d=a.b.length;a=0<d?a.b[d-1]:null;return null!=a?null!=a.endTime?c.ja(a.endTime):null:c.ja(b)||(c.length()?c.v():null)}
function Ee(a){if(!a.o&&null!=a.i){a.o=!0;var b=a.a,c=a.i,d=c-b.u;0!=d&&(b.b=Vd(b.b,d),b.u=c);a.h.resolve(a.i)}}function Ge(a,b){var c;c=b.a.split("/")[0];c=x({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function He(a){var b=x({type:"ended"});a.dispatchEvent(b)}function Ce(a,b){a.g=window.setTimeout(a.Kb.bind(a),b)}function Be(a){null!=a.g&&(window.clearTimeout(a.g),a.g=null)};function Ie(a){this.a=a;this.segmentIndex_=null}Ie.prototype.destroy=function(){this.segmentIndex_&&(this.segmentIndex_.destroy(),this.segmentIndex_=null)};Ie.prototype.create=function(){if(this.segmentIndex_)return Promise.resolve(this.segmentIndex_);var a=new Qd(0,null,this.a);this.segmentIndex_=new R([a]);return Promise.resolve(this.segmentIndex_)};function Je(a,b){D.call(this,a);this.b=b;this.g=!0;this.segmentIndex_=this.f=null;this.c=new E;this.a=null}q(Je,D);Je.prototype.C=function(){};Je.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.s=this.b=this.f=this.segmentIndex_=this.a=this.c=null};k=Je.prototype;k.ma=function(){return this.f};k.ab=function(){return this.segmentIndex_};k.qb=function(){return this.c};k.Fa=function(){return!0};
k.qa=function(a){a.segmentIndexSource.create().then(F(this,function(b){if(this.b){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.f;this.f=a;this.segmentIndex_=b;b=S(b).url.M[0].toString();var d=this.Ca();this.a&&(this.va(!1),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=b;this.va(d);b=x({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c||this.c.resolve(0)}}))};
k.ib=function(){};k.jb=function(){return!0};k.va=function(a){this.g=a;this.a&&(this.a.track.mode=a?"showing":"disabled")};k.Ca=function(){this.a&&(this.g="showing"==this.a.track.mode);return this.g};function Ke(){}
Ke.prototype.parse=function(a,b,c,d){var e=null;try{var f;var g=new $a(b);if(440786851!=bb(g).id)f=null;else{var h=bb(g);if(408125543!=h.id)f=null;else{var l=h.a.byteOffset,m;var n=new $a(h.a);for(b=null;Va(n.a);){var t=bb(n);if(357149030==t.id){b=t;break}}if(b){for(var A=new $a(b.a),n=1E6;Va(A.a);){var O=bb(A);if(2807729==O.id){n=fb(O);break}}m=n/1E9}else m=null;f=m?{Qb:l,Ub:m}:null}}if(f){var J=bb(new $a(a));if(475249515!=J.id)e=null;else{var va=f.Qb,Nb=f.Ub;a=[];var ce=new $a(J.a);for(f=J=-1;Va(ce.a);){var de=
bb(ce);if(187==de.id){var Ha;var ee=new $a(de.a),fe=bb(ee);if(179!=fe.id)Ha=null;else{var Af=fb(fe),ge=bb(ee);if(183!=ge.id)Ha=null;else{for(var he=new $a(ge.a),l=0;Va(he.a);){var ie=bb(he);if(241==ie.id){l=fb(ie);break}}Ha={Wb:Af,Pb:l}}}if(Ha){var je=Nb*Ha.Wb,ke=va+Ha.Pb;if(0<=J){var Sc=new G(d,c,f,ke-1);a.push(new Qd(J,je,Sc))}J=je;f=ke}}}0<=J&&(Sc=new G(d,c,f,null),a.push(new Qd(J,null,Sc)));e=a}}else e=null}catch(le){if(!(le instanceof RangeError))throw le;}return e};function Le(a,b,c,d,e,f,g){this.g=a;this.i=b;this.f=c;this.a=d;this.c=e;this.j=f;this.b=null;this.h=g}Le.prototype.destroy=function(){this.h=this.i=this.g=null;this.a.c();this.a=null;this.c&&(this.c.c(),this.c=null);this.b=null};
Le.prototype.create=function(){if(this.b)return this.b;var a=[this.a.fetch()];"webm"==this.f&&a.push(this.c.fetch());return this.b=Promise.all(a).then(F(this,function(a){var c=a[0];a=a[1]||null;var d=null;"mp4"==this.f?(d=new Wd,d=d.parse(new DataView(c),this.a.oa,this.a.M,this.h)):"webm"==this.f&&(d=new Ke,d=d.parse(new DataView(c),new DataView(a),this.a.M,this.h));if(!d)return c=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),c.type="stream",Promise.reject(c);
var e;"dynamic"==this.g.type?e=new T(d,this.g,this.i,this.j):e=new R(d);return Promise.resolve(e)}))};function Me(a){this.a=a}
function Ne(a,b,c){for(var d=v()/1E3,e=0;e<b.a.length;++e)for(var f=b.a[e],g=0;g<f.b.length;++g){var h=f.b[g];if("text"!=h.contentType)for(var l=0;l<h.a.length;++l){var m=h.a[l],n=0,n=n+(m.g?1:0),n=n+(m.b?1:0),n=n+(m.a?1:0);0==n?(h.a.splice(l,1),--l):1!=n&&(m.g?(m.b=null,m.a=null):m.b&&(m.a=null))}}Oe(b);for(e=0;e<b.a.length;++e)for(f=b.a[e],g=0;g<f.b.length;++g){l=h=f.b[g];m=null;for(n=0;n<l.a.length;++n){var t=l.a[n].f||"";m?t!=m&&(l.a.splice(n,1),--n):m=t}0==h.a.length&&(f.b.splice(g,1),--g)}"dynamic"==
b.type&&null==b.c&&(b.c=d);e=new ze;"dynamic"==b.type&&(e.a=!0,e.c=b.g,e.f=new G(c,b.j||b.url),e.g=b.c);e.b=b.h||5;for(f=0;f<b.a.length;++f){g=b.a[f];if(null==g.start)break;g=Pe(a,b,g,d,c);e.periodInfos.push(g)}return e}
function Oe(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.b=null);b(a.b)&&1==a.a.length&&!b(a.a[0].a)&&(a.a[0].a=a.b);for(var c=0,d=!0,e=0;e<a.a.length;++e){var f=a.a[e-1],g=a.a[e],h=a.a[e+1]||{start:a.b};!b(g.start)&&f&&b(f.start)&&b(f.a)&&(g.start=f.start+f.a);!b(g.a)&&b(h.start)&&(g.a=h.start-g.start);null!=g.start&&null!=g.a?c+=g.a:d=!1}b(a.b)||(e=a.a[a.a.length-1],d?a.b=c:b(e.start)&&b(e.a)?a.b=e.start+e.a:"dynamic"!=a.type&&
(a.b=c))}}function Pe(a,b,c,d,e){var f=new ye;f.id=c.id;f.start=c.start;f.a=c.a;var g=new z;c.b.forEach(function(a){g.push(a.contentType||"",a)});for(var h=wb(g),l=0;l<h.length;++l){var m=new z;g.get(h[l]).forEach(function(a){m.push(a.group,a)});for(var n=wb(m),t=0;t<n.length;++t){var A=new z;m.get(n[t]).forEach(function(a){A.push(a.lang,a)});for(var O=wb(A),J=0;J<O.length;++J){var va=A.get(O[J]),va=Qe(a,b,c,va,d,e);f.streamSetInfos.push(va)}}}return f}
function Qe(a,b,c,d,e,f){ba(d.every(function(a){return a.group==d[0].group&&(a.lang||"")==(d[0].lang||"")&&(a.contentType||"")==(d[0].contentType||"")}));var g=new ue,h=d.filter(function(a){return null!=a.id});h.length==d.length&&(g.id=h.map(function(a){return a.id}).sort().reduce(function(a,b){return a+","+b}));g.lang=d[0].lang||"";g.contentType=d[0].contentType||"";g.b=d.some(function(a){return a.c});for(var h={},l=0;l<d.length;++l)for(var m=d[l],n=0;n<m.a.length;++n){var t=m.a[n],A=Re(a,t),O=g.a.slice(0);
Se(A,O);0==O.length&&0<g.a.length||!(t=Te(b,c,t,e,f))||(g.streamInfos.push(t),g.a=O,h[t.A]=m)}if(g.a.some(function(a){return""==a.a}))return g.streamInfos.forEach(function(a){a.J=!0}),g;a=Ue(d);for(l=0;l<g.streamInfos.length;++l)t=g.streamInfos[l],m=h[t.A],m==a&&(t.J=!0);return g}function Ue(a){for(var b=null,c=null,d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.a.length;++f){var g=e.a[f],g=(g.width||1)*(g.height||1)*(g.bandwidth||1);if(null==b||g<b)b=g,c=e}return c}
function Se(a,b){if(0==b.length)Array.prototype.push.apply(b,a);else for(var c=0;c<b.length;++c){for(var d=!1,e=0;e<a.length;++e){var f=b[c],g=a[e];if(f.a==g.a&&f.h==g.h&&f.withCredentials==g.withCredentials&&f.g==g.g&&f.j==g.j&&f.f==g.f&&f.i==g.i&&db(f.c,g.c)){d=!0;mc(b[c],a[e].b);break}}d||(b.splice(c,1),--c)}}function Re(a,b){var c=[];if(0==b.c.length)c.push(new jc);else if(a.a)for(var d=0;d<b.c.length;++d)c.push.apply(c,Ve(a,b.c[d]));return c}
function Ve(a,b){var c=[];if(2!=a.a.length)return[];var d=a.a(b.c||"",b.f);if(!(d&&d instanceof Array))return[];for(var e=0;e<d.length;++e){var f=kc(d[e]);0==f.b.length&&b.a&&b.a.psshBox&&mc(f,[{initData:b.a.psshBox,initDataType:"cenc"}]);c.push(f)}return c}
function Te(a,b,c,d,e){if(!c.m||0===c.m.length)return null;var f=null,g=1,h=0;if(c.g)f=c.f.split("/")[1],"mp4"!=f&&"webm"!=f?f=null:(g=c.g,"webm"!=f||g.c?g.a||g.b&&g.b.a?(h=g.b,h||(h=new md,h.url=c.m,h.a=g.a?g.a.clone():null),h=We(h,e),g=g.c?We(g.c,e):null,a=new Le(a,b,f,h,g,d,e),b=new Td(g),d=new re,d.segmentIndexSource=a,d.F=b,f=d):f=null:f=null),g=c.g.g,h=c.g.f;else if(c.b)f=c.b,!f.b&&!f.c&&1<f.a.length?f=null:f.b||b.a||f.c||1!=f.a.length?f.c&&0===f.c.a.length?f=null:(f=f.h?We(f.h,e):null,a=new oe(a,
b,c,d,e),b=new Td(f),d=new re,d.segmentIndexSource=a,d.F=b,f=d):f=null,g=c.b.f,h=c.b.g;else if(c.a){a:if(f=c.a,g=0+(f.f?1:0),g+=f.c?1:0,g+=f.b?1:0,0==g?g=!1:(1!=g&&(f.f?(f.c=null,f.b=null):f.c&&(f.b=null)),g=!0),g){g=null;if(f.g&&(g=(f=c.a.g)?Xe(c,f,nd):null,!g)){f=null;break a}f=g?We(g,e):null;g=c.a;g.f?(g=c.f.split("/")[1],"mp4"!=g&&"webm"!=g?a=null:"webm"!=g||f?Pd(e,c,1,0)?(h=(h=c.a.f)?Xe(c,h,md):null)?(h=We(h,e),a=new Le(a,b,g,h,f,d,e)):a=null:a=null:a=null):a=g.h?g.c?new pe(a,b,c,d,e):g.b?"dynamic"!=
a.type&&null==b.a?null:new ne(a,b,c,d,e):null:null;a?(b=new Td(f),d=new re,d.segmentIndexSource=a,d.F=b,f=d):f=null}else f=null;g=c.a.a;h=c.a.i}else"text"==c.f.split("/")[0]&&(f=new re,f.segmentIndexSource=new Ie(new G(e,c.m)));if(!f)return null;f.id=c.id;h&&(f.c=-1*h/g);f.bandwidth=c.bandwidth;f.width=c.width;f.height=c.height;f.a=c.f||"";f.b=c.h||"";for(a=0;a<c.c.length;++a)b=c.c[a],b.b&&f.f.push(b.b);return f}
function Xe(a,b,c){b=Rd(b,a.id,null,a.bandwidth,null);if(!b)return null;c=new c;c.url=Ld(a.m,b);return c}function We(a,b){var c=a.url,d=0,e=null;a.a&&(d=a.a.la,e=a.a.end);return new G(b,c,d,e)};function Ye(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function Ze(a,b){var c=new $e(b);a.streamHistory.push(new af(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}function $e(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.a;this.videoBandwidth=a.bandwidth}
function af(a){this.timestamp=v()/1E3;this.value=a};function bf(a,b){Gb.call(this,"readwrite",b);this.j=a;this.b=0}q(bf,Gb);
function cf(a,b,c,d,e){for(var f=[],g=[],h=0,l=0,m=[],n=b.map(function(a){return a.segmentIndexSource.create()}),n=Promise.all(n),t=b.map(function(a){return a.F.create()}),t=Promise.all(t),n=Promise.all([n,t]).then(function(a){f=a[0];g=a[1];h=f.reduce(function(a,b){return a+b.length()},0)}),t=0;t<b.length;++t)n=n.then(function(a){return df(this,b[a],f[a],g[a],h,l)}.bind(a,t)),n=n.then(function(a,b){l+=f[a].length();m.push(b)}.bind(a,t));return n.then(F(a,function(){return ef(Ob(this))})).then(F(a,
function(a){var b=new E;c=Ra(c);var f={group_id:a,stream_ids:m,session_ids:c,duration:d,key_system:e.a,license_server:e.h,with_credentials:e.withCredentials,distinctive_identifier:e.g,audio_robustness:e.f,video_robustness:e.i},g=Ob(this).put(f);g.onsuccess=function(){b.resolve(a)};g.onerror=function(){b.reject(g.error)};return b}))}
function ff(a,b){return Pb(Ob(a),b).then(F(a,function(a){var d=[],e;for(e in a.stream_ids)d.push(gf(this,a.stream_ids[e]));a=Ob(this);d.push(a.delete(b));return Promise.all(d)}))}function df(a,b,c,d,e,f){var g=[ef(Mb(a)),ef(Kb(a).index("stream"))],g=Promise.all(g).then(F(a,function(a){return{pa:Math.max(a[0],a[1]),ha:new ArrayBuffer(0),Ia:0,references:[],Ba:null,Vb:e,hb:f}})),g=g.then(a.f.bind(a,c));return g=g.then(a.g.bind(a,b,d))}
function ef(a){var b=new E,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}bf.prototype.g=function(a,b,c){var d=new E;a={stream_id:c.pa,mime_type:a.a,codecs:a.b,init_segment:b,references:c.references};var e=Mb(this).put(a);e.onsuccess=function(){d.resolve(c.pa)};e.onerror=function(){d.reject(e.error)};return d};
bf.prototype.f=function(a,b){for(var c=Promise.resolve(),d=0;d<a.length();++d)var e=a.get(d),f=d==a.length()-1,f=this.c.bind(this,e,b,f),c=c.then(this.i.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b)}).catch(F(this,function(a){gf(this,b.pa);return Promise.reject(a)}))};
bf.prototype.c=function(a,b,c,d){var e=new E;0==b.ha.byteLength&&(b.Ba=a);b.ha=hf(b.ha,d);b.hb++;var f=x({type:"progress",detail:b.hb/b.Vb*100,bubbles:!0});if(1048576<=b.ha.byteLength||c){c={stream_id:b.pa,segment_id:b.Ia,content:b.ha};var g=Kb(this).put(c);b.references.push({start_time:b.Ba.startTime,start_byte:b.Ba.url.oa,end_time:a.endTime,url:"idb://"+b.pa+"/"+b.Ia});b.Ia++;b.ha=new ArrayBuffer(0);g.onerror=function(){e.reject(g.error)};g.onsuccess=F(this,function(){this.dispatchEvent(f);e.resolve()})}else this.dispatchEvent(f),
e.resolve();return e};function hf(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}bf.prototype.i=function(a){var b=new $b;b.c=1E3*this.b;return a.url.fetch(b,this.j)};
function gf(a,b){var c=new E,d=Mb(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=Kb(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c};function jf(a,b,c,d,e,f){this.b=new G(null,[new H(a)]);this.a=new $b;this.a.body=b;this.a.method=c;this.a.a=3;this.a.withCredentials=d;this.a.c=1E3*(null!=f?f:0);a=e||{};for(var g in a)this.a.b[g]=a[g]}jf.prototype.send=function(){return this.b.fetch(this.a).then(function(a){return Promise.resolve(new Uint8Array(a))})};function U(a,b,c){D.call(this,a);this.h=b;this.b=c;this.a=this.i=null;this.l=new B;this.c=[];this.f=[];this.o=0;this.g=new E;this.j=null;this.u=0}q(U,D);U.prototype.destroy=function(){this.s=null;for(var a=0;a<this.f.length;++a)this.f[a].close().catch(function(){});this.f=[];this.c=this.a=this.i=null;this.g.destroy();this.g=null;this.l.destroy();this.l=null;this.j&&(window.clearTimeout(this.j),this.j=null);this.h=this.b=null};
U.prototype.initialize=function(){for(var a=new z,b=this.b.$a(),c=0;c<b.length;++c){var d=b[c];d.a.a||d.b&&!kf(d.b)||a.push(d.contentType,d)}for(var c={},d=!1,e=0;e<b.length;++e){var f=b[e];if(f.a.a&&!a.a.hasOwnProperty(f.contentType)){var g=f.a.a,h=c[g];h||(h=f.a,h={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:h.g?"required":"optional",persistentState:h.j||this.b.fa()?"required":"optional",sessionTypes:[this.b.fa()?"persistent-license":"temporary"]},
c[g]=h);if(f.b&&(g=f.contentType+"Capabilities",g in h)){d=!0;h[g]||(h[g]=[]);var l;"audio"==f.contentType?l=f.a.f:"video"==f.contentType&&(l=f.a.i);h[g].push({contentType:f.b,robustness:l})}}}if(!d)if(b.length)this.a=b[0].a;else throw a=Error("No DrmInfo exists!"),a.type="drm",a;if(0==Object.keys(c).length)return this.b.Ja(a),this.g.resolve(),Promise.resolve();l=new E;c=lf(this,c,l);c=c.then(this.B.bind(this,b,a));l.reject(null);return c};
function mf(a,b){null==a.j&&(a.j=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.g.reject(a)}.bind(a),b));return a.g}function nf(a){return Promise.all(a.f.map(function(a){return a.remove()}))}
function lf(a,b,c){for(var d in b)c=c.catch(function(a,b){return navigator.requestMediaKeySystemAccess(a,[b])}.bind(null,d,b[d]));a.b.fa()&&(c=c.catch(function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.");}));return c}
U.prototype.B=function(a,b,c){if(!this.h)return of();for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.a.hasOwnProperty(h)){var l=e[h+"Capabilities"];if(l){for(var l=l[0],m=[],n={},t=0;t<a.length;++t){var A=a[t],O=l?A.b==l.contentType:A.contentType==h;A.a.a!=d||!O||A.id in n||(m.push(A),n[A.id]=!0,this.a=this.a?lc(this.a,A.a):A.a)}b.set(h,m)}}}this.b.Ja(b);return c.createMediaKeys().then(function(a){this.i=a}.bind(this))};
function pf(a){return a.h?a.i?a.h.setMediaKeys(a.i).then(F(a,function(){return this.h?this.a.c?this.i.setServerCertificate(this.a.c):Promise.resolve():of()})).then(F(a,function(){if(!this.h)return of();if(0<this.b.ua().length)qf(this);else{for(var a=0;a<this.a.b.length;++a){var c=this.a.b[a];this.w({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.a.b.length&&C(this.l,this.h,"encrypted",this.w.bind(this))}})):Promise.resolve():of()}
function of(){var a=Error("EmeManager destroyed");a.type="destroy";return Promise.reject(a)}
U.prototype.w=function(a){for(var b=new Uint8Array(a.initData),c=0;c<this.c.length;++c)if(db(b,this.c[c].data))return;try{var d=rf(this)}catch(e){b=y(e);this.dispatchEvent(b);this.g.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.c.push({data:b,Ka:d});a.catch(F(this,function(a){if(this.h){for(var b=0;b<this.c.length;++b)if(this.c[b].Ka==d){this.c.splice(b,1);break}b=y(a);this.dispatchEvent(b);this.g.reject(a)}}));this.f.push(d)};
function qf(a){for(var b=a.b.ua(),c=0;c<b.length;++c){var d=rf(a),e=d.load(b[c]);a.f.push(d);e.then(F(a,function(){this.o++;this.o>=this.f.length&&this.g.resolve()})).catch(F(a,function(a){a=y(a);this.dispatchEvent(a)}))}}
function rf(a){var b=null;if(a.b.fa())try{b=a.i.createSession("persistent-license")}catch(c){throw Error("Persistent licenses are not supported by this key system or platform.");}else b=a.i.createSession();C(a.l,b,"message",a.D.bind(a));C(a.l,b,"keystatuseschange",a.C.bind(a));return b}U.prototype.D=function(a){sf(this,a.target,this.a,a.message)};
U.prototype.C=function(a){a=a.target;var b={};a.keyStatuses.forEach(function(a,c){if("string"==typeof a){var f=a;a=c;c=f}if("com.microsoft.playready"==this.a.a&&16==a.byteLength){var f=new DataView(a),g=f.getUint32(0,!0),h=f.getUint16(4,!0),l=f.getUint16(6,!0);f.setUint32(0,g,!1);f.setUint16(4,h,!1);f.setUint16(6,l,!1)}f=ic(new Uint8Array(a));b[f]=c}.bind(this));if(a.expiration<Date.now()){for(var c=0;c<this.c.length;++c)if(this.c[c].Ka==a){this.c.splice(c,1);break}a.close();this.f.splice(this.f.indexOf(a),
1)}this.b.bb(b)};function sf(a,b,c,d){d=tf(c,d);(new jf(d.url,d.body,d.method,c.withCredentials,d.headers,a.u)).send().then(F(a,function(a){c.s&&(a=c.s(a));return b.update(a)})).then(F(a,function(){var a=x({type:"sessionReady",detail:b});this.dispatchEvent(a);this.o++;this.o>=this.f.length&&this.g.resolve()})).catch(F(a,function(a){a.Ka=b;a=y(a);this.dispatchEvent(a)}))}
function tf(a,b){var c={url:a.h,body:b.slice(0),method:"POST",headers:{}};if("com.microsoft.playready"===a.a){for(var d=String.fromCharCode.apply(null,new Uint16Array(c.body)),d=(new DOMParser).parseFromString(d,"application/xml"),e=d.getElementsByTagName("name"),f=d.getElementsByTagName("value"),g=0;g<e.length;g++)c.headers[e[g].childNodes[0].nodeValue]=f[g].childNodes[0].nodeValue;c.body=window.atob(d.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue)}if(!a.l)return c;a.l(c);c.url=sb(c,
"url");if(null==c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer||"string"==typeof c.body||null==c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method=sb(c,"method");if("GET"!=c.method&&"POST"!=c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers=tb(c,"headers",Object);if(null==c.headers)throw Error("'headers' cannot be null.");return c};function V(a){D.call(this,null);this.a=a;this.b=null;this.f=new B;this.j=this.i=null;this.B=0;this.u=null;this.h=!1;this.g=new Ye;this.c={enableAdaptation:!0,streamBufferSize:15,liveStreamEndTimeout:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new ja};this.l=1;this.C=null}q(V,D);p("shaka.player.Player",V);V.version="v1.6.5-hola-1-3-g5904308-dirty";
V.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!window.Uint8Array};function kf(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}V.isTypeSupported=kf;
V.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b));for(b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+oa(a)+" }",0)};V.prototype.destroy=function(){return this.o().then(F(this,function(){this.f.destroy();this.a=this.f=null})).catch(function(){})};V.prototype.destroy=V.prototype.destroy;
V.prototype.o=function(){if(!this.b)return Promise.resolve();this.h&&uf(this);this.a.pause();xb(this.f);vf(this);wf(this);this.i&&(this.i.destroy(),this.i=null);this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.h=!1;this.g=new Ye;return a};V.prototype.unload=V.prototype.o;V.prototype.P=function(){return this.b};V.prototype.getVideoSource=V.prototype.P;
V.prototype.I=function(a){var b=this.o();this.a.autoplay&&(da("load"),C(this.f,this.a,"timeupdate",this.wb.bind(this)));a.R(this.c);a.ob(this.C);this.C=null;b=b.then(F(this,function(){return a.W()}));b.catch(F(this,function(b){a.destroy();return Promise.reject(b)}));return b.then(F(this,function(){if(!this.a)return xf();this.b=a;C(this.f,this.b,"seekrangechanged",this.Fb.bind(this));this.i=new U(this,this.a,this.b);return this.i.initialize()})).then(F(this,function(){if(!this.a)return xf();C(this.f,
this.a,"error",this.Rb.bind(this));C(this.f,this.a,"playing",this.Db.bind(this));C(this.f,this.a,"pause",this.Cb.bind(this));return this.b.kb(this,this.a)})).then(F(this,function(){return this.a?pf(this.i):xf()})).then(F(this,function(){if(!this.a)return xf();yf(this)})).catch(F(this,function(a){if(!this.a)return xf();if("destroy"!=a.type){var b=y(a);this.dispatchEvent(b)}return this.o().then(function(){return Promise.reject(a)})}))};V.prototype.load=V.prototype.I;
function xf(){var a=Error("Player destroyed");a.type="destroy";return Promise.reject(a)}k=V.prototype;k.wb=function(){ga("load");this.g.playbackLatency=ha("load")/1E3;this.f.ra(this.a,"timeupdate")};k.Rb=function(){if(this.a.error){var a=this.a.error.code;a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(zf[a]||"Unknown playback error."),a.type="playback",a=y(a),this.dispatchEvent(a))}};
k.Db=function(){da("playing");!this.j&&0>this.l&&(this.a.playbackRate=0,this.w(this.a.currentTime,Date.now(),this.l));this.h&&uf(this)};k.Cb=function(){ga("playing");var a=ha("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3}wf(this)};k.Fb=function(a){this.B=a.start};
k.pb=function(){if(!this.a.paused){ga("playing");var a=ha("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3;da("playing")}}a=this.g;b=this.a;b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.g};V.prototype.getStats=V.prototype.pb;V.prototype.da=function(){return this.b?this.b.ka():[]};V.prototype.getVideoTracks=V.prototype.da;V.prototype.Y=function(){return this.b?this.b.na():[]};
V.prototype.getAudioTracks=V.prototype.Y;V.prototype.ca=function(){return this.b?this.b.Na():[]};V.prototype.getTextTracks=V.prototype.ca;V.prototype.selectVideoTrack=function(a,b){return this.b?this.b.selectVideoTrack(a,void 0==b?!0:b):!1};V.prototype.selectVideoTrack=V.prototype.selectVideoTrack;V.prototype.ea=function(a,b,c){return this.b?this.b.mb(a,void 0==b?!0:b,c):!1};V.prototype.selectAudioTrack=V.prototype.ea;V.prototype.N=function(a){return this.b?this.b.nb(a,!1):!1};
V.prototype.selectTextTrack=V.prototype.N;V.prototype.X=function(a){this.b&&this.b.Ma(a)};V.prototype.enableTextTrack=V.prototype.X;V.prototype.S=function(a){wf(this);0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.w(this.a.currentTime,Date.now(),a));this.l=a};V.prototype.setPlaybackRate=V.prototype.S;V.prototype.H=function(){return this.l};V.prototype.getPlaybackRate=V.prototype.H;V.prototype.U=function(a){this.C=a};V.prototype.setPlaybackStartTime=V.prototype.U;
V.prototype.D=function(){return this.b?this.b.lb():!1};V.prototype.isLive=V.prototype.D;
V.prototype.T=function(a){if(a){var b=pb(a,"enableAdaptation");null!=b&&(this.c.enableAdaptation=b);b=rb(a,"streamBufferSize");null!=b&&(this.c.streamBufferSize=b);b=rb(a,"liveStreamEndTimeout");null!=b&&(this.c.liveStreamEndTimeout=b);b=rb(a,"licenseRequestTimeout");null!=b&&(this.c.licenseRequestTimeout=b);b=rb(a,"mpdRequestTimeout");null!=b&&(this.c.mpdRequestTimeout=b);b=rb(a,"segmentRequestTimeout");null!=b&&(this.c.segmentRequestTimeout=b);b=sb(a,"preferredLanguage");null!=b&&(this.c.preferredLanguage=
b);b=tb(a,"restrictions",ja);null!=b&&(this.c.restrictions=b.clone());a=pb(a,"disableCacheBustingEvenThoughItMayAffectBandwidthEstimation");null!=a&&(Fd=!a);this.b&&this.b.R(this.c)}};V.prototype.configure=V.prototype.T;V.prototype.Z=function(){return this.c};V.prototype.getConfiguration=V.prototype.Z;function wf(a){a.j&&(window.clearTimeout(a.j),a.j=null)}function yf(a){vf(a);a.u=window.setTimeout(a.R.bind(a),100)}function vf(a){a.u&&(window.clearTimeout(a.u),a.u=null)}
V.prototype.w=function(a,b,c){this.j=null;var d=(Date.now()-b)/1E3*c;this.a.currentTime<this.B+(this.D()?1:.05)?this.a.pause():(d=Math.max(this.B,a+d),this.a.currentTime=d,this.j=window.setTimeout(this.w.bind(this,a,b,c),250))};function uf(a){ga("buffering");var b=a.g;b.bufferingTime+=ha("buffering")/1E3;a.h=!1;a.dispatchEvent(x({type:"bufferingEnd"}))}
V.prototype.R=function(){yf(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0),c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;if(this.h){if(c=this.b.Za(),b||a>c)uf(this),this.a.play()}else!this.a.paused&&!b&&.5>a&&(this.h=!0,this.a.pause(),this.g.bufferingHistory.push(v()/1E3),da("buffering"),this.dispatchEvent(x({type:"bufferingStart"})))}};
var zf={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function Bf(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.streamSetInfos.length;++d){for(var e=c.streamSetInfos[d],f=e,g=0;g<f.streamInfos.length;++g)kf(te(f.streamInfos[g]))||(f.streamInfos.splice(g,1),--g);0==e.streamInfos.length&&(c.streamSetInfos.splice(d,1),--d)}}function Cf(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.streamSetInfos.length;++d)c.streamSetInfos[d].streamInfos.sort(Df)}
function Df(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function Ef(a){this.a=a}Ef.prototype.destroy=function(){this.a.destroy();this.a=null};Ef.prototype.update=function(a){var b=Ff(a),c=Ff(this.a);return Promise.all([b,c]).then(F(this,function(b){var c=b[0];b=b[1];var f=this.a.periodInfos;Bf(f);Cf(f);a.c=this.a.c;a.f=this.a.f?this.a.f.clone():null;a.b=this.a.b;f=[];Gf(a,this.a,c,b,f);c=a.periodInfos;Bf(c);Cf(c);return Promise.resolve(f)}))};
function Ff(a){function b(a,b){return a.concat(b)}var c=a.periodInfos.map(function(a){return a.streamSetInfos}).reduce(b,[]).map(function(a){return a.streamInfos}).reduce(b,[]);a=c.map(function(a){return a.segmentIndexSource.create()});return Promise.all(a).then(function(a){for(var b={},f=0;f<c.length;++f)b[c[f].A]=a[f];return Promise.resolve(b)})}
function Gf(a,b,c,d,e){var f=new z;a.periodInfos.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new z;b.periodInfos.forEach(function(a,b){g.push(a.id||""+b,a)});a=wb(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&(Hf(l[0],h[0],c,d,e),l[0].a=h[0].a)}}
function Hf(a,b,c,d,e){var f=new z;a.streamSetInfos.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new z;b.streamSetInfos.forEach(function(a,b){g.push(a.id||""+b,a)});a=wb(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&If(l[0],h[0],c,d,e)}}
function If(a,b,c,d,e){var f=new z;a.streamInfos.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new z;b.streamInfos.forEach(function(a,b){g.push(a.id||""+b,a)});b={};for(var h=wb(f),l=0;l<h.length;++l){var m=h[l];b[m]=m;var n=f.get(m);1<n.length||((m=g.get(m))&&0!=m.length?1==m.length&&(Jf(n[0],m[0],c,d),n[0].F=m[0].F,m[0].F=null,n[0].c=m[0].c):(e.push(n[0]),a.streamInfos.splice(a.streamInfos.indexOf(n[0]),1)))}h=wb(g);for(l=0;l<h.length;++l)m=h[l],b[m]||(b[m]=m,m=g.get(m),a.streamInfos.push(m[0]))}
function Jf(a,b,c,d){a=c[a.A];b=d[b.A];a.length();a.Ga(b)&&a.length()};function W(){this.a=this.b=null;this.f=new B;this.c=Number.POSITIVE_INFINITY;this.i=!0;this.g=!1}p("shaka.media.SimpleAbrManager",W);W.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null};W.prototype.initialize=function(a,b){this.b||this.a||(this.b=a,this.a=b)};
W.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4E3,C(this.f,this.b,"bandwidth",this.s.bind(this)),C(this.f,this.a,"adaptation",this.j.bind(this)),C(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)};W.prototype.enable=function(a){this.i=a};W.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var a=Kf(this);return a?a.id:null};W.prototype.selectVideoTrack=function(a,b,c){this.g&&this.a.selectVideoTrack(a.id,b,c)};
W.prototype.s=function(){Date.now()<this.c||this.h()};W.prototype.h=function(){if(this.i){var a=Kf(this);if(a){if(a.active){this.c=Date.now()+3E3;return}this.selectVideoTrack(a,!1)}this.c=Number.POSITIVE_INFINITY}};W.prototype.j=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+3E4)};
function Kf(a){var b=a.a.ka();if(0==b.length)return null;b.sort(sa);var c;a:{c=a.a.na();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.b.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function Lf(a,b,c){D.call(this,null);this.f=a;this.c=b;this.b=kc(c);this.a=null}q(Lf,D);p("shaka.player.HttpVideoSource",Lf);Lf.prototype.R=function(){};Lf.prototype.destroy=function(){this.a&&(this.a.parentElement.removeChild(this.a),this.a=null);this.s=this.b=null};k=Lf.prototype;k.kb=function(a,b){this.s=a;var c=b.mediaKeys;b.src=this.f;c=b.setMediaKeys(c);this.c&&(this.a=document.createElement("track"),this.a.src=this.c,b.appendChild(this.a),this.a.track.mode="showing");return c};k.W=function(){return Promise.resolve()};
k.ka=function(){return[]};k.na=function(){return[]};k.Na=function(){return[]};k.Za=function(){return 5};k.$a=function(){var a=new xe;a.a=this.b;return[a]};k.Ja=function(){};Lf.prototype.selectVideoTrack=function(){return!1};k=Lf.prototype;k.mb=function(){return!1};k.nb=function(){return!1};k.Ma=function(a){this.a&&(this.a.track.mode=a?"showing":"disabled")};k.ob=function(){};k.ua=function(){return[]};k.fa=function(){return!1};k.lb=function(){return!1};
k.bb=function(a){for(var b in a){var c=a[b],d=gb[c]||null;if(d){var e=Bb(b),d=Error("Key "+e+" is not usable. "+d);d.type="drm";d.code=c;c=y(d);this.dispatchEvent(c)}}};function X(a,b,c){D.call(this,null);this.a=a;this.Y=b;this.i=new B;this.g=new MediaSource;this.f=null;this.ca=0;this.b=new z;this.D=c;this.D.initialize(b,this);this.P=!1;this.H="en";this.ea=!1;this.S=null;this.w=new E;this.h=new ja;this.B=null;this.Ua=1;this.c={};this.da=new E;this.Sa=0;this.Ta=15;this.u=null;this.Qa=this.Ra=!1;this.o={};this.Z=this.X=this.T=null;this.C={}}q(X,D);p("shaka.player.StreamVideoSource",X);
X.prototype.R=function(a){null!=a.streamBufferSize&&(this.C.streamBufferSize=a.streamBufferSize);null!=a.segmentRequestTimeout&&(this.C.segmentRequestTimeout=a.segmentRequestTimeout);Mf(this);null!=a.enableAdaptation&&this.D.enable(Boolean(a.enableAdaptation));null!=a.mpdRequestTimeout&&(this.ca=Number(a.mpdRequestTimeout));null!=a.liveStreamEndTimeout&&(this.Ta=Number(a.liveStreamEndTimeout));null!=a.preferredLanguage&&(this.H=kb(String(a.preferredLanguage)));null!=a.restrictions&&(this.h=a.restrictions,
this.P&&Nf(this))};X.prototype.destroy=function(){this.w.destroy();this.da.destroy();this.da=this.w=null;this.X&&(window.clearTimeout(this.X),this.X=null);this.T&&(window.clearTimeout(this.T),this.T=null);this.o=null;this.i.destroy();this.i=null;ob(this.c).forEach(function(a){a.destroy()});this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);this.D.destroy();this.s=this.h=this.S=this.f=this.g=this.Y=this.D=null};k=X.prototype;
k.kb=function(a,b){if(!this.P){var c=Error("Cannot call attach() right now.");c.type="app";return Promise.reject(c)}this.s=a;this.f=b;this.S=a.pb();C(this.i,this.g,"sourceopen",this.yb.bind(this));C(this.i,this.Y,"bandwidth",this.Sb.bind(this));this.a.a&&(C(this.i,a,"bufferingStart",this.vb.bind(this)),C(this.i,a,"bufferingEnd",this.ub.bind(this)));c=this.f.mediaKeys;this.f.src=window.URL.createObjectURL(this.g);c=this.f.setMediaKeys(c);return Promise.all([this.w,c])};
k.W=function(){if(this.P){var a=Error("Cannot call load() right now.");a.type="app";return Promise.reject(a)}if(!this.a||0==this.a.periodInfos.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);a=this.a.periodInfos;Bf(a);Cf(a);if(0==this.a.periodInfos.length||0==this.a.periodInfos[0].streamSetInfos.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.P=!0;
this.C.initialStreamBufferSize=this.a.b;Mf(this);Nf(this);return Promise.resolve()};
k.fb=function(a){var b=Date.now(),c=this.T=null,d=this.a.f;(a?this.cb():this.eb(d)).then(F(this,function(a){c=new Ef(a);return c.update(this.a)})).then(F(this,function(a){c.destroy();c=null;for(var d=0;d<a.length;++d)Of(this,a[d]);this.C.initialStreamBufferSize=this.a.b;Mf(this);Nf(this);0==Object.keys(this.c).length?Pf(this):Qf(this,(Date.now()-b)/1E3)})).catch(F(this,function(a){c&&(c.destroy(),c=null);"aborted"!=a.type&&(a=y(a),this.dispatchEvent(a),this.a&&Qf(this,0))}))};k.eb=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};
k.cb=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};function Qf(a,b){if(null!=a.a.c){var c=Math.max(a.a.c,3),c=Math.max(c-b,0);a.T=window.setTimeout(a.fb.bind(a,!1),1E3*c)}}
function Of(a,b){var c=b.a.split("/")[0],d=a.c[c];if(d&&d.ma()==b){var e=a.b.get(b.a.split("/")[0]).map(function(a){return a.streamInfos}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return a.J&&a.G});if(0==e.length){c=Error("All usable streams have been removed from the manifest.");c.type="app";c=y(c);a.dispatchEvent(c);return}a.o[c].Oa==b&&delete a.o[c];d.qa(e[0],!0);b.destroy()}b.destroy()}
k.ka=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var a=this.c.video,a=(a=a?a.ma():null)?a.A:0,b=[],c=this.b.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.streamInfos.length;++f){var g=e.streamInfos[f];if(g.J&&g.G){var h=g.A,g=new ra(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};X.prototype.getVideoTracks=X.prototype.ka;
X.prototype.na=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var a=this.c.audio,a=(a=a?a.ma():null)?a.A:0,b=[],c=this.b.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.streamInfos.length;++g){var h=e.streamInfos[g];if(h.J&&h.G){var l=h.A,h=new ia(l,h.bandwidth,f);l==a&&(h.active=!0);b.push(h)}}return b};X.prototype.getAudioTracks=X.prototype.na;
X.prototype.Na=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var a=this.c.text,b=a?a.ma():null,b=b?b.A:0,c=[],d=this.b.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.streamInfos.length;++h){var l=f.streamInfos[h].A,m=new qa(l,g);l==b&&(m.active=!0,m.enabled=a.Ca());c.push(m)}return c};X.prototype.getTextTracks=X.prototype.Na;X.prototype.Za=function(){return Number(this.C.initialStreamBufferSize)};
X.prototype.$a=function(){var a;if(this.P){a=this.a.periodInfos[0];for(var b=[],c=0;c<a.streamSetInfos.length;++c)b.push.apply(b,we(a.streamSetInfos[c]));a=b}else a=[];return a};
X.prototype.Ja=function(a){if(this.P){for(var b={},c=this.a.periodInfos[0],d=0;d<c.streamSetInfos.length;++d){var e=c.streamSetInfos[d];b[e.A]=e}this.b.a={};c=wb(a);for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.b.push(e,b[g])}else if("audio"==e)for(var g=f[0].b.split(";")[0],h=0;h<f.length;++h){var l=f[h];l.b.split(";")[0]==g&&this.b.push(e,b[l.id])}else for(h=0;h<f.length;++h)g=f[h].id,this.b.push(e,b[g])}this.ea=!0;if(a=this.b.get("audio"))Rf(this,a),this.b.set("audio",
a),a=a[0].lang||this.H,jb(2,this.H,a)&&(this.ea=!1);if(a=this.b.get("text"))Rf(this,a),this.b.set("text",a),a=a[0].lang||this.H,jb(2,this.H,a)||(this.ea=!1)}};X.prototype.selectVideoTrack=function(a,b,c){return Sf(this,"video",a,b,c)};k=X.prototype;k.mb=function(a,b,c){return Sf(this,"audio",a,b,c)};k.nb=function(a,b){return Sf(this,"text",a,b)};k.Ma=function(a){var b=this.c.text;b&&b.va(a)};k.ob=function(a){this.Z=a};
function Nf(a){if(a.h){for(var b=!1,c=0;c<a.a.periodInfos.length;++c)for(var d=a.a.periodInfos[c],e=0;e<d.streamSetInfos.length;++e){var f=d.streamSetInfos[e];if("video"==f.contentType)for(var g=0;g<f.streamInfos.length;++g){var h=f.streamInfos[g],l=h.G;h.G=!0;a.h.maxWidth&&h.width>a.h.maxWidth&&(h.G=!1);a.h.maxHeight&&h.height>a.h.maxHeight&&(h.G=!1);a.h.minHeight&&h.height<a.h.minHeight&&(h.G=!1);a.h.maxBandwidth&&h.bandwidth>a.h.maxBandwidth&&(h.G=!1);a.h.minBandwidth&&h.bandwidth<a.h.minBandwidth&&
(h.G=!1);l!=h.G&&(b=!0)}}0!=ub(a.b).length&&b&&(Tf(a),0<a.ka().length||(b=Error("The application has restricted all video tracks!"),b.type="app",b=y(b),a.dispatchEvent(b)))}}k.ua=function(){return[]};k.fa=function(){return!1};k.lb=function(){return this.a?this.a.a:!1};
k.bb=function(a){for(var b,c=!1,d=new z,e=ub(this.b),f=0;f<e.length;++f)for(var g=e[f],h=0;h<g.streamInfos.length;++h){var l=g.streamInfos[h];l.f.forEach(function(a){d.push(a,l)})}for(b in a)if(e=gb[a[b]]||null,g=d.get(b))for(f=0;f<g.length;++f)l=g[f],h=l.J,l.J=!e,h!=l.J&&(c=!0);else Bb(b);c&&(Tf(this),b=this.na(),a=this.ka(),b=this.b.a.hasOwnProperty("audio")&&0==b.length,a=this.b.a.hasOwnProperty("video")&&0==a.length,b||a)&&(a=Error("The key system has restricted all "+(b&&a?"audio and video tracks.":
b?"audio tracks.":"video tracks.")),a.type="drm",a=y(a),this.dispatchEvent(a))};function Tf(a){var b=x({type:"trackschanged",bubbles:!0});a.dispatchEvent(b)}
function Sf(a,b,c,d,e){if(!a.b.a.hasOwnProperty(b)||!a.c[b])return!1;for(var f=a.b.get(b),g=0;g<f.length;++g)for(var h=f[g],l=0;l<h.streamInfos.length;++l){var m=h.streamInfos[l];if(m.A==c){if(!m.J||!m.G)return!1;if("text"!=b&&!a.Qa)return c=a.o[b],a.o[b]={Oa:m,Va:null!=c&&c.Va||d,Wa:null!=c&&c.Wa||e},!0;Ze(a.S,m);a.c[b].qa(m,d,e);return!0}}return!1}
function Rf(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(jb(c,a.H,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.b){b.splice(d,1);b.splice(0,0,e);break}}k.yb=function(){this.i.ra(this.g,"sourceopen");Pf(this).then(F(this,function(){this.w&&this.w.resolve()})).catch(F(this,function(a){this.w&&this.w.reject(a)}))};
function Pf(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.b.a.hasOwnProperty(e)&&b.push(a.b.get(e)[0])}for(var f=Uf(a,b),d=0;d<c.length;++d)if(e=c[d],a.b.a.hasOwnProperty(e)&&!f[e])return a=Error("Unable to select an initial "+e+" stream: all "+e+" streams have been restricted (by the application or by the key system)."),a.type="stream",Promise.reject(a);b=ob(f).map(function(a){return a.segmentIndexSource.create()});return Promise.all(b).then(F(a,function(a){if(!a.every(function(a){return a.length()}))return a=
Error("Some streams are not available."),a.type="stream",Promise.reject(a);a=Vf(this,a);if(!a)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!Wf(this,f))return a=Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a);this.D.start();Xf(this,f,a);return Promise.resolve()})).catch(F(a,function(a){if("aborted"!=a.type)return Object.keys(this.c),this.a.a?(v()<this.a.g?(a=Math.max(this.a.g-Date.now()/1E3,3),this.T=window.setTimeout(this.fb.bind(this,
!0),1E3*a)):Qf(this,0),Promise.resolve()):Promise.reject(a)}))}
function Uf(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=null;if("video"==e.contentType){var g=a.D.getInitialVideoTrackId();if(null==g)continue;f=e.streamInfos.filter(function(a){return a.A==g});if(0==f.length)continue;f=f[0]}else if("audio"==e.contentType){f=e.streamInfos.filter(function(a){return a.J&&a.G});if(0==f.length)continue;f=e.streamInfos[Math.floor(f.length/2)]}else 0<e.streamInfos.length&&(f=e.streamInfos[0]);c[e.contentType]=f}return c}
function Wf(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new Je(a,a.f):Yf(a,e);if(!e)return ob(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.c=c;return!0}function Yf(a,b){var c=new Ae(a,a.f,a.g,te(b),a.Y);c.C(a.C);return c}
function Xf(a,b,c){a.Ua=a.f.playbackRate;a.f.playbackRate=0;Zf(a,c);var d;a.Z&&a.Z<=c.end&&a.Z>=c.start?d=a.Z:a.a.a?(d=c.end,a.Ra=!0):d=c.start;C(a.i,a.f,"seeking",a.Gb.bind(a));a.f.currentTime!=d&&(a.f.currentTime=d,a.B=d);$f(a,c.start,c.end);c=[];for(var e in a.c){d=a.c[e];c.push(d.qb(a.da));C(a.i,d,"ended",a.Hb.bind(a));var f=b[e];Ze(a.S,f);d.qa(f,!1)}Promise.all(c).then(a.tb.bind(a)).catch(F(a,function(a){"destroy"!=a.type&&(a=y(a),this.dispatchEvent(a))}));a.Ma(a.ea)}
k.tb=function(a){ba(a&&a.length==Object.keys(this.c).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d<a.length;++d)var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a=ag(this);for(d=0;d<a.length;++d)a[d].ia(c);bg(this,a,c);d=ub(this.b).map(function(a){return a.streamInfos}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.segmentIndexSource.create()];a.F&&b.push(a.F.create());return Promise.all(b)});Promise.all(d).then(F(this,function(a){for(var b=0;b<a.length;++b)a[b][0].ia(c);
this.Qa=!0;for(var d in this.o)a=this.o[d],b=this.c[d],Ze(this.S,a.Oa),b.qa(a.Oa,a.Va,a.Wa);this.o={}})).catch(F(this,function(a){"aborted"!=a.type&&(a=y(a),this.dispatchEvent(a))}))};function bg(a,b,c){if(b=Vf(a,b))Zf(a,b),$f(a,b.start,b.end);0!=c&&(c=a.f.currentTime+c,a.f.currentTime=c,a.B=c);a.Ra&&b&&(a.f.currentTime=b.end);a.f.playbackRate=a.Ua;a.a.a&&null!=a.a.c&&Qf(a,0);cg(a);a.da.resolve()}
function Zf(a,b){if(a.a.a)isNaN(a.g.duration)&&(a.g.duration=b.end+2592E3);else if(isNaN(a.g.duration)||b.end>a.g.duration){a.g.duration=b.end;for(var c=0;c<a.g.sourceBuffers.length;++c)a.g.sourceBuffers[c].appendWindowEnd=b.end}}k.Jb=function(){this.X=null;cg(this);var a=Vf(this,ag(this));a&&(this.a.a&&this.Sa!=a.v&&(this.Sa=a.v,null!=this.u&&(window.clearTimeout(this.u),this.u=null)),$f(this,a.start,a.end),this.f.paused||dg(this,this.f.currentTime,a.start,a.end))};
function $f(a,b,c){b=x({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b)}k.Gb=function(){var a=this.f.currentTime;if(null!=this.B){if(a>=this.B-.01&&a<=this.B+.01){this.B=null;return}this.B=null}var b=Vf(this,ag(this));if(b){var c=b.end;(b=dg(this,a,b.start,c))||(a<=c+.01?b=!1:(this.f.currentTime=c,b=!0));if(!b)for(var d in this.c)this.c[d].ib()}};
function dg(a,b,c,d){if(b>=c-.01)return!1;b=0;if(a.a.a){b=.5;for(var e in a.c)if(!a.c[e].jb(c+b)){b=a.a.b;break}}a.f.currentTime=Math.min(c+b,d);return!0}k.Hb=function(){if(!this.a.a){for(var a in this.c)if(!this.c[a].Fa())return;this.Ya()}};k.vb=function(){ob(this.c).every(function(a){return a.Fa()})&&(this.u=window.setTimeout(this.Ya.bind(this),1E3*this.Ta))};k.ub=function(){null!=this.u&&(window.clearTimeout(this.u),this.u=null)};
k.Sb=function(){var a=this.S,b=this.Y.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new af(b))};k.Ya=function(){this.u=null;this.g.endOfStream()};function ag(a){return ob(a.c).map(function(a){return a.ab()}).filter(function(a){return null!=a})}
function Vf(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,f=0;f<b.length;++f){var g=b[f].Da(),c=Math.max(c,g.start);null!=g.end&&(d=Math.min(d,g.end));b[f].length()&&(e=Math.min(e,b[f].v().endTime))}if(d==Number.POSITIVE_INFINITY)if(d=a.a.periodInfos[0],d.a)d=(d.start||0)+d.a;else return null;a.a.a&&(d=Math.max(d-a.a.b,c));return c>d?null:{start:c,end:d,v:e}}function cg(a){a.a.a&&(a.X=window.setTimeout(a.Jb.bind(a),1E3))}function Mf(a){for(var b in a.c)a.c[b].C(a.C)};function Y(a,b,c,d){c||(c=new Ab);d||(d=new W);X.call(this,null,c,d);this.ta=a;this.l=null;this.I=b;this.N=[];this.U=[];this.sa=[];this.j=null}q(Y,X);p("shaka.player.DashVideoSource",Y);Y.prototype.xa=function(){return this.ta};Y.prototype.getUrl=Y.prototype.xa;Y.prototype.za=function(){return this.a};Y.prototype.getManifestInfo=Y.prototype.za;Y.prototype.rb=function(a,b,c){this.N.push(a);this.U.push(b||"");this.sa.push(c||"")};Y.prototype.addExternalCaptions=Y.prototype.rb;
Y.prototype.sb=function(a){this.j=a};Y.prototype.setNetworkCallback=Y.prototype.sb;Y.prototype.destroy=function(){this.l=this.j=this.I=null;X.prototype.destroy.call(this)};
Y.prototype.W=function(){var a=new G(this.j,[new H(this.ta)]);return(new Nd(a,this.ca)).send().then(F(this,function(a){this.l=a;for(var c=0;c<this.N.length;c++){var d=a,e=this.N[c],f=this.U[c],g=this.sa[c];if(0!==d.a.length){var h=new cd;h.contentType="text";h.lang=f||"en";h.c=!0;f=new fd;f.bandwidth=0;f.f=g||"text/vtt";f.m=[new H(e)];h.a.push(f);d.a[0].b.push(h);yd(d.a[0])}}this.a=Ne(new Me(this.I),a,this.j);return X.prototype.W.call(this)}))};
Y.prototype.eb=function(a){return(new Nd(a,this.ca)).send().then(F(this,function(a){this.l=a;a=Ne(new Me(this.I),a,this.j);return Promise.resolve(a)}))};Y.prototype.cb=function(){var a=Ne(new Me(this.I),this.l,this.j);return Promise.resolve(a)};function Z(a,b,c){b||(b=new Ab);c||(c=new W);X.call(this,null,b,c);this.N=a;this.I=[];this.timeoutMs=3E4;this.l={};this.j=this.U=null}q(Z,X);p("shaka.player.OfflineVideoSource",Z);Z.prototype.R=function(a){null!=a.licenseRequestTimeout&&(this.l.licenseRequestTimeout=a.licenseRequestTimeout);null!=a.segmentRequestTimeout&&(this.l.segmentRequestTimeout=a.segmentRequestTimeout);X.prototype.R.call(this,a)};
p("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var a=new Qb,b=Hb(a).then(function(){return Rb(a)});b.then(function(){Jb(a)}).catch(function(){Jb(a)});return b});
Z.prototype.xa=function(a,b,c,d){var e,f=null,g={},h=[];a=new G(this.U,[new H(a)]);return(new Nd(a,this.ca)).send().then(F(this,function(a){this.a=Ne(new Me(c),a,this.U);if(this.a.a)return a=Error("Unable to store live streams offline."),a.type="app",Promise.reject(a);this.R({preferredLanguage:b});return X.prototype.W.call(this)})).then(F(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.g);e=new U(null,a,this);null!=this.l.licenseRequestTimeout&&(e.u=Number(this.l.licenseRequestTimeout));
C(this.i,e,"sessionReady",this.sa.bind(this));C(this.i,e,"error",function(a){f=a});return e.initialize()})).then(F(this,function(){for(var a=ub(this.b),b=0;b<a.length;++b)for(var c=a[b],e=0;e<c.streamInfos.length;++e){var f=c.streamInfos[e];g[f.A]=f}return d()})).then(F(this,function(a){for(var b=0;b<a.length;++b){var c=a[b],d=g[c];if(d)h.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}var e=["audio","video"];h=h.filter(function(a){return 0>e.indexOf(a.a.split("/")[0])?!1:
!0});a=h.map(function(a){return a.F.create()});return Promise.all(a)})).then(F(this,function(a){for(var b=h,c=[],d=0;d<b.length;++d)try{c[d]=this.g.addSourceBuffer(te(b[d]))}catch(e){}if(b.length!=c.length)a=Error("Error initializing streams."),a.type="storage",a=Promise.reject(a);else{for(d=0;d<a.length;++d)(b=a[d])&&c[d].appendBuffer(b);a=Promise.resolve()}return a})).then(F(this,function(){return mf(e,this.timeoutMs)})).then(F(this,function(){return f?Promise.reject(f):eg(this,h,e.a,this.a.periodInfos[0].a)})).then(F(this,
function(a){this.N=a;return f?(fg(this),Promise.reject(f)):Promise.resolve(a)}))};p("shaka.player.OfflineVideoSource.prototype.store",Z.prototype.xa);Z.prototype.za=function(a){this.U=a};Z.prototype.setNetworkCallback=Z.prototype.za;Z.prototype.sa=function(a){this.I.push(a.detail.sessionId)};
function eg(a,b,c,d){var e=new bf(a.Y,a);null!=a.l.segmentRequestTimeout&&(e.b=Number(a.l.segmentRequestTimeout));return Hb(e).then(F(a,function(){return cf(e,b,this.I,d,c)})).then(function(a){Jb(e);return Promise.resolve(a)}).catch(function(a){Jb(e);return Promise.reject(a)})}
Z.prototype.W=function(){var a=new Qb,b,c;return Hb(a).then(F(this,function(){return Sb(a,this.N)})).then(F(this,function(d){var e=[];this.I=d.session_ids;b=d.duration;c={keySystem:d.key_system,distinctiveIdentifierRequired:d.distinctive_identifier,persistentStorageRequired:!0,audioRobustness:d.audio_robustness,videoRobustness:d.video_robustness,withCredentials:d.with_credentials,licenseServerUrl:d.license_server};for(var f=0;f<d.stream_ids.length;++f)e.push(Tb(a,d.stream_ids[f]));return Promise.all(e)})).then(F(this,
function(a){var e=b,f=c,g=new ze;g.b=5;for(var h=new ye,l=0;l<a.length;++l){var m=a[l],n=new re,t=new qe(m.references),A=new Td(null,m.init_segment);n.segmentIndexSource=t;n.F=A;n.a=m.mime_type;n.b=m.codecs;n.J=!0;this.j&&(null!=this.j.licenseServerUrl&&(f.licenseServerUrl=this.j.licenseServerUrl),null!=this.j.withCredentials&&(f.withCredentials=this.j.withCredentials),f.licensePostProcessor=this.j.licensePostProcessor,f.licensePreProcessor=this.j.licensePreProcessor,f.serverCertificate=this.j.serverCertificate);
m=kc(f);t=new ue;t.streamInfos.push(n);t.a.push(m);t.contentType=n.a.split("/")[0];h.streamSetInfos.push(t);h.a=e}g.periodInfos.push(h);this.a=g;return X.prototype.W.call(this)})).then(function(){Jb(a);return Promise.resolve()}).catch(function(b){Jb(a);return Promise.reject(b)})};
Z.prototype.ta=function(a,b){a&&(this.j={licenseServerUrl:a.licenseServerUrl,withCredentials:a.withCredentials,serverCertificate:a.serverCertificate,licensePreProcessor:a.licensePreProcessor,licensePostProcessor:a.licensePostProcessor});var c=null;return gg(this).catch(function(a){return b?(c=a,Promise.resolve()):Promise.reject(a)}).then(F(this,function(){return fg(this)})).then(function(){return Promise.resolve(c)})};Z.prototype.deleteGroup=Z.prototype.ta;Z.prototype.ua=function(){return this.I};
Z.prototype.fa=function(){return!0};function fg(a){var b=new bf(null,null);return Hb(b).then(F(a,function(){return ff(b,this.N)})).then(function(){Jb(b);return Promise.resolve()}).catch(function(a){Jb(b);return Promise.reject(a)})}
function gg(a){var b=document.createElement("video");b.src=window.URL.createObjectURL(a.g);var c=new U(null,b,a);null!=a.l.licenseRequestTimeout&&(c.u=Number(a.l.licenseRequestTimeout));return a.W().then(function(){return c.initialize()}).then(F(a,function(){return mf(c,this.timeoutMs)})).then(function(){return nf(c)}).then(F(a,function(){c.destroy();this.destroy();return Promise.resolve()})).catch(F(a,function(a){c.destroy();this.destroy();return Promise.reject(a)}))};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined" && define.amd)define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

//# sourceMappingURL=shaka-player.compiled.debug.map
