(function(){var g={};
(function(window){var k,aa=this;function p(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function q(a,b){function c(){}c.prototype=b.prototype;a.Zb=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Xb=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};/*

 Copyright 2015 Google Inc.

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
*/
function ba(){};function ca(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}ca("error");ca("warn");ca("info");ca("log");ca("debug");function da(a){ea[a]={la:fa(),end:NaN}}function ga(a){if(a=ea[a])a.end=fa()}function ha(a){return(a=ea[a])&&a.end?a.end-a.la:NaN}var fa=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,ea={};function ia(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}p("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function ja(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.minHeight=this.maxHeight=null}ja.prototype.clone=function(){var a=new ja;a.maxHeight=this.maxHeight;a.minHeight=this.minHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function r(){this.fontSize="100%";this.fontColor=ka;this.fontOpacity=la;this.backgroundColor=ma;this.backgroundOpacity=la;this.fontEdge=na}p("shaka.player.TextStyle",r);r.prototype.a=function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b=JSON.parse(a)}catch(c){return}if(b&&"object"==typeof b){var a=b,d;for(d in a)d in this&&(this[d]=a[d])}}};r.prototype.load=r.prototype.a;r.prototype.b=function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))};
r.prototype.store=r.prototype.b;function oa(a){var b=[];b.push("font-size: "+a.fontSize);b.push("color: "+pa(a.fontColor,a.fontOpacity));b.push("background-color: "+pa(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d<a.fontEdge.length;++d){var e=a.fontEdge[d].slice(3,6);c.push(pa(a.fontEdge[d].slice(0,3),a.fontOpacity)+" "+e.join("px ")+"px")}b.push("text-shadow: "+c.join(","));return b.join("; ")}function pa(a,b){return"rgba("+a.concat(b).join(",")+")"}var ka=[255,255,255],ma=[0,0,0];
r.StandardColors={WHITE:ka,BLACK:ma,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var la=1;r.StandardOpacities={OPAQUE:la,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var na=[];
r.EdgeStyles={NONE:na,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function qa(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}p("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function ra(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function sa(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}p("shaka.player.VideoTrack.compare",sa);function ta(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=ua)}p("shaka.polyfill.CustomEvent.install",ta);function ua(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function wa(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
xa);document.addEventListener("webkitfullscreenerror",xa);document.addEventListener("mozfullscreenchange",xa);document.addEventListener("mozfullscreenerror",xa);document.addEventListener("MSFullscreenChange",xa);document.addEventListener("MSFullscreenError",xa)}p("shaka.polyfill.Fullscreen.install",wa);function xa(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function ya(){return Promise.reject(Error("The key system specified is not supported."))}function za(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Aa(){throw new TypeError("Illegal constructor.");}Aa.prototype.createSession=function(){};Aa.prototype.setServerCertificate=function(){};function Ba(){throw new TypeError("Illegal constructor.");}Ba.prototype.getConfiguration=function(){};Ba.prototype.createMediaKeys=function(){};function u(a){this.c=[];this.b=[];this.$=Ca;if(a)try{a(this.U.bind(this),this.a.bind(this))}catch(b){this.a(b)}}var Ca=0;function Da(){window.Promise||(window.Promise=u,window.Promise.resolve=Ea,window.Promise.reject=Fa,window.Promise.all=Ga,window.Promise.race=Ia,window.setImmediate?(Ja=function(a){return window.setImmediate(a)},Ka=function(a){return window.clearImmediate(a)}):(Ja=function(a){return window.setTimeout(a,0)},Ka=function(a){return window.clearTimeout(a)}))}
p("shaka.polyfill.Promise.install",Da);function Ea(a){var b=new u;b.U(a);return b}function Fa(a){var b=new u;b.a(a);return b}function Ga(a){function b(a,b,c){a.$==Ca&&(e[b]=c,d++,d==e.length&&a.U(e))}var c=new u;if(!a.length)return c.U([]),c;for(var d=0,e=Array(a.length),f=c.a.bind(c),g=0;g<a.length;++g)a[g]&&a[g].then?a[g].then(b.bind(null,c,g),f):b(c,g,a[g]);return c}function Ia(a){for(var b=new u,c=b.U.bind(b),d=b.a.bind(b),e=0;e<a.length;++e)a[e]&&a[e].then?a[e].then(c,d):c(a[e]);return b}
u.prototype.then=function(a,b){var c=new u;switch(this.$){case 1:La(this,c,a);break;case 2:La(this,c,b);break;case Ca:this.c.push({Ha:c,Aa:a}),this.b.push({Ha:c,Aa:b})}return c};u.prototype.then=u.prototype.then;u.prototype.catch=function(a){return this.then(void 0,a)};u.prototype["catch"]=u.prototype.catch;u.prototype.U=function(a){if(this.$==Ca){this.wa=a;this.$=1;for(a=0;a<this.c.length;++a)La(this,this.c[a].Ha,this.c[a].Aa);this.c=[];this.b=[]}};
u.prototype.a=function(a){if(this.$==Ca){this.wa=a;this.$=2;for(a=0;a<this.b.length;++a)La(this,this.b[a].Ha,this.b[a].Aa);this.c=[];this.b=[]}};function La(a,b,c){Ma.push(function(){if(c&&"function"==typeof c){try{var a=c(this.wa)}catch(e){b.a(e);return}a instanceof u?a==b?b.a(new TypeError("Chaining cycle detected")):a.then(b.U.bind(b),b.a.bind(b)):b.U(a)}else 1==this.$?b.U(this.wa):b.a(this.wa)}.bind(a));null==Na&&(Na=Ja(Oa))}
function Oa(){for(;Ma.length;){null!=Na&&(Ka(Na),Na=null);var a=Ma;Ma=[];for(var b=0;b<a.length;++b)a[b]()}}function Ja(){return 0}function Ka(){}var Na=null,Ma=[];function Pa(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=Qa)}p("shaka.polyfill.VideoPlaybackQuality.install",Pa);function Qa(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}};function Ra(a,b){for(var c=[],d=0;d<a.length;++d){for(var e=!1,f=0;f<c.length&&!(e=b?b(a[d],c[f]):a[d]===c[f]);++f);e||c.push(a[d])}return c};function v(){return Date.now()+Sa}var Sa=0;function Ta(a){this.b=a;this.c=0==Ua;this.a=0}var Ua=1;function Va(a){return a.a<a.b.byteLength}function Wa(a){var b=a.b.getUint8(a.a);a.a+=1;return b}function w(a){var b=a.b.getUint32(a.a,a.c);a.a+=4;return b}function Xa(a){var b,c;a.c?(b=a.b.getUint32(a.a,!0),c=a.b.getUint32(a.a+4,!0)):(c=a.b.getUint32(a.a,!1),b=a.b.getUint32(a.a+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.a+=8;return c*Math.pow(2,32)+b}
function Ya(a){if(a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a+=16;return b}function Za(a,b){if(a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b};function $a(a){this.b=a;this.a=new Ta(a);ab||(ab=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var ab;
function bb(a){var b;b=cb(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=cb(a);a:{for(d=0;d<ab.length;d++)if(db(c,ab[d])){d=!0;break a}d=!1}if(d)c=a.b.byteLength-a.a.a;else{if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d}c=a.a.a+c<=a.b.byteLength?c:a.b.byteLength-a.a.a;d=new DataView(a.b.buffer,
a.b.byteOffset+a.a.a,c);Za(a.a,c);return new eb(b,d)}function cb(a){var b=Wa(a.a),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=Wa(a.a);return d}function eb(a,b){this.id=a;this.a=b}
function fb(a){if(8<a.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.a.byteLength&&a.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.a.byteLength;c++)var d=a.a.getUint8(c),b=256*b+d;return b};var gb={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function hb(a){this.c=Math.exp(Math.log(.5)/a);this.a=this.b=0}hb.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b;this.a+=a};function ib(a){return a.b/(1-Math.pow(a.c,a.a))};function x(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function y(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function jb(a,b){var c=window.hola_cdn&&window.hola_cdn.api;if(c&&c[a])return c[a].apply(c,Array.prototype.slice.call(arguments,1))};function kb(a,b,c){lb(b);lb(c);return c==b||a>=mb&&c==b.split("-")[0]||a>=nb&&c.split("-")[0]==b.split("-")[0]?!0:!1}var mb=1,nb=2;function lb(a){a=a.toLowerCase().split("-");var b=ob[a[0]];b&&(a[0]=b);return a.join("-")}
var ob={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function pb(a){return Object.keys(a).map(function(b){return a[b]})}function qb(a,b){return rb(a,b,"boolean")}function sb(a,b){var c=rb(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function tb(a,b){return rb(a,b,"string")}
function rb(a,b,c){a=a[b];if(null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}function ub(a,b,c){a=a[b];if(null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a};function z(){this.a={}}z.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]};z.prototype.set=function(a,b){this.a[a]=b};z.prototype.get=function(a){return(a=this.a[a])?a.slice():null};function vb(a){var b=[],c;for(c in a.a)b.push.apply(b,a.a[c]);return b}function wb(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function xb(a){var b=[],c;for(c in a.a)b.push(c);return b};function B(){this.a=new z}B.prototype.destroy=function(){yb(this);this.a=null};function C(a,b,c,d){b=new zb(b,c,d);a.a.push(c,b)}B.prototype.ra=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.ra(),wb(this.a,b,e))}};function yb(a){for(var b=vb(a.a),c=0;c<b.length;++c)b[c].ra();a.a.a={}}function zb(a,b,c){this.target=a;this.type=b;this.a=c;this.target.addEventListener(b,c,!1)}
zb.prototype.ra=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};function D(a){this.xa=new z;this.l=a}p("shaka.util.FakeEventTarget",D);D.prototype.addEventListener=function(a,b,c){c||this.xa.push(a,b)};D.prototype.removeEventListener=function(a,b,c){c||wb(this.xa,a,b)};
D.prototype.dispatchEvent=function(a){a.hasOwnProperty("srcElement")||(delete a.srcElement,Object.defineProperty(a,"srcElement",{get:function(){return null}}));if(a.hasOwnProperty("target"))a.target=this;else{delete a.target;var b=this;Object.defineProperty(a,"target",{get:function(){return b},set:function(a){b=a}})}if(a.hasOwnProperty("currentTarget"))a.currentTarget=null;else{delete a.currentTarget;var c=null;Object.defineProperty(a,"currentTarget",{get:function(){return c},set:function(a){c=a}})}return Ab(this,
a)};function Ab(a,b){b.currentTarget=a;for(var c=a.xa.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.l&&b.bubbles&&Ab(a.l,b);return b.defaultPrevented};function Bb(){D.call(this,null);this.a=new hb(3);this.c=new hb(10);this.b=0}q(Bb,D);p("shaka.util.EWMABandwidthEstimator",Bb);Bb.prototype.sample=function(a,b){if(!(65536>b)){a=Math.max(a,50);var c=8E3*b/a,d=a/1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(x({type:"bandwidth"}));this.b=Date.now()}};Bb.prototype.getBandwidth=function(){return.5>this.a.a?5E5:Math.min(ib(this.a),ib(this.c))};Bb.prototype.getDataAge=function(){return(Date.now()-this.b)/1E3};
Bb.prototype.supportsCaching=function(){return!1};function E(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;c.destroy=E.prototype.destroy;return c}E.prototype.destroy=function(){this.catch(function(){});var a=Error("Destroyed!");a.type="destroy";this.reject(a)};function Cb(a){return a.split("").reduce(function(a,c,d){return a+(d&&0==d%4?" "+c:c)})};function Db(){this.g=new E;this.f=!1;this.a=null;this.b=[];this.c=null}function Eb(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}Db.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0;this.b.unshift(function(){});Fb(this,void 0)};Db.prototype.end=function(){this.b.splice(1)};
function Fb(a,b){var c=a.b[0](b),d;c?(d=c[0],a.c=c[1]):(d=Promise.resolve(),a.c=null);d.then(F(a,function(a){this.a?(this.b=[],this.c=null,Gb(this)):(this.b.shift(),this.b.length?Fb(this,a):(this.g.resolve(a),this.c=null))})).catch(F(a,function(a){this.b=[];this.c=null;this.a?Gb(this):this.g.reject(a)}))}function Gb(a){var b=Error("Task aborted.");b.type="aborted";a.g.reject(b);window.setTimeout(function(){this.a.resolve();this.a=null}.bind(a),5)};function F(a,b){return b.bind(a)};function Hb(a,b){D.call(this,b);this.a=null;this.h=a}q(Hb,D);
function Ib(a){if(!window.indexedDB)return a=Error("Persistant storage requires IndexedDB support."),a.type="storage",Promise.reject(a);if(a.a)return a=Error("A database connection is already open."),a.type="storage",Promise.reject(a);var b=new E,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=F(a,function(a){this.a=a.target.result;Jb(this,"group_store",{keyPath:"group_id"});Jb(this,"stream_index_store",{keyPath:"stream_id"});a=Jb(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",
["stream_id","segment_id"],{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=F(a,function(a){this.a=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function Kb(a){a.a&&(a.a.close(),a.a=null)}function Jb(a,b,c){a.a.objectStoreNames.contains(b)&&a.a.deleteObjectStore(b);return a.a.createObjectStore(b,c)}function Lb(a){return Nb(a,"content_store")}function Ob(a){return Nb(a,"stream_index_store")}function Pb(a){return Nb(a,"group_store")}
function Nb(a,b){return a.a.transaction([b],a.h).objectStore(b)}function Qb(a,b){var c=new E,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c};function Rb(){Hb.call(this,"readonly",null)}q(Rb,Hb);function Sb(a){var b=new E,c=[],d=Pb(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function Tb(a,b){return Qb(Pb(a),b).then(F(a,function(a){a.session_ids=Ra(a.session_ids);return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):Ub(this,a.stream_ids[0]).then(function(b){a.duration=b.duration;a.key_system=b.key_system;a.license_server=b.license_server;a.with_credentials=b.with_credentials;a.distinctive_identifier=b.distinctive_identifier;a.audio_robustness=b.audio_robustness;a.video_robustness=b.video_robustness;return Promise.resolve(a)})}))}
function Ub(a,b){return Qb(Ob(a),b)}function Vb(a,b,c){return Qb(Lb(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})};function Wb(a,b,c){MediaSource.isTypeSupported(b);b=a.addSourceBuffer(b);this.i=a;this.c=b;this.m=c;this.l=new B;this.g=null;this.b=[];this.u=0;this.f=this.a=null;this.o=0;C(this.l,this.c,"updateend",this.w.bind(this))}var Xb=1/60;Wb.prototype.destroy=function(){Yb(this).catch(function(){});this.f&&this.f.destroy();this.a=this.f=null;this.g&&(Kb(this.g),this.g=null);this.b=null;this.l.destroy();this.i=this.c=this.l=null};
function Zb(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-Xb,f=c.end(d)+Xb;if(b>=e&&b<=f)return c.end(d)-b}return 0}
Wb.prototype.fetch=function(a,b,c){if(this.a)return b=Error("Cannot fetch ("+this.j+"): previous operation not complete."),b.type="stream",Promise.reject(b);this.a=new Db;b!=this.c.timestampOffset&&(this.c.timestampOffset=b);"idb"!=a.url.M[0].L||this.g||(this.g=new Rb,Eb(this.a,function(){return[Ib(this.g)]}.bind(this)));c&&Eb(this.a,function(){return[$b(this,c),this.h.bind(this)]}.bind(this));Eb(this.a,function(){var b=a.endTime?a.endTime-a.startTime:1,c=new ac;c.a=3;c.h=1E3*b;c.c=1E3*this.o;c.i=
this.g;return[a.url.fetch(c,this.m),G.prototype.c.bind(a.url)]}.bind(this));Eb(this.a,F(this,function(a){this.m.getBandwidth();return[$b(this,a),this.h.bind(this)]}));var d=0==this.c.buffered.length&&0==this.b.length,e=null;Eb(this.a,function(){if(0==this.c.buffered.length){var b=Error("Failed to buffer segment ("+this.j+").");b.type="stream";return[Promise.reject(b)]}d&&(b=a.startTime,e=this.c.buffered.start(0)-b);b=bc(this.b,a.startTime);0<=b?this.b.splice(b+1,0,a):this.b.push(a)}.bind(this));return cc(this).then(function(){return Promise.resolve(e)}.bind(this))};
function dc(a){if(a.a)return a=Error("Cannot clear ("+a.j+"): previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new Db;Eb(a.a,function(){var a;a:if(0==this.c.buffered.length)a=Promise.resolve();else{try{this.c.remove(0,this.i.duration)}catch(c){a=Promise.reject(c);break a}this.b=[];a=this.f=new E}return[a,this.h.bind(this)]}.bind(a));return cc(a)}
function ec(a,b){if(a.a){var c=Error("Cannot clearAfter ("+a.j+"): previous operation not complete.");c.type="stream";return Promise.reject(c)}a.a=new Db;Eb(a.a,function(){return[fc(this,b),this.h.bind(this)]}.bind(a));return cc(a)}function Yb(a){a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new E,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve();return a}function cc(a){a.a.start();return a.a.g.then(F(a,function(){this.a=null})).catch(F(a,function(a){this.a=null;return Promise.reject(a)}))}
function $b(a,b){try{a.c.appendBuffer(b)}catch(c){return Promise.reject(c)}a.f=new E;return a.f}function fc(a,b){if(0==a.c.buffered.length)return Promise.resolve();var c=bc(a.b,b);if(-1==c||c==a.b.length-1)return Promise.resolve();try{a.c.remove(a.b[c+1].startTime,a.i.duration)}catch(d){return Promise.reject(d)}a.b=a.b.slice(0,c+1);a.f=new E;return a.f}Wb.prototype.h=function(){this.f&&"open"==this.i.readyState&&this.c.abort()};Wb.prototype.w=function(){this.f&&(this.f.resolve(),this.f=null)};function gc(a){return String.fromCharCode.apply(null,a)}p("shaka.util.Uint8ArrayUtils.toString",gc);function hc(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}p("shaka.util.Uint8ArrayUtils.fromString",hc);p("shaka.util.Uint8ArrayUtils.toBase64",function(a,b){var c=void 0==b?!0:b,d=window.btoa(gc(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")});function ic(a){return hc(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
p("shaka.util.Uint8ArrayUtils.fromBase64",ic);p("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function jc(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}p("shaka.util.Uint8ArrayUtils.toHex",jc);function db(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function kc(){this.h=this.a="";this.i=!1;this.o=this.m=null;this.j=this.g=!1;this.l=this.f="";this.c=null;this.b=[]}
function lc(a){var b=new kc;if(!a)return b;var c=tb(a,"keySystem");if(null!=c)b.a=c;else throw Error("'keySystem' cannot be null.");var d=tb(a,"licenseServerUrl");if(null!=d)b.h=d;else if(c)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");c=qb(a,"withCredentials");null!=c&&(b.i=c);c=ub(a,"licensePostProcessor",Function);null!=c&&(b.m=c);c=ub(a,"licensePreProcessor",Function);null!=c&&(b.o=c);c=qb(a,"distinctiveIdentifierRequired");null!=c&&(b.g=c);c=qb(a,
"persistentStateRequired");null!=c&&(b.j=c);c=tb(a,"audioRobustness");null!=c&&(b.f=c);c=tb(a,"videoRobustness");null!=c&&(b.l=c);c=ub(a,"serverCertificate",Uint8Array);null!=c&&(b.c=c);if(c=ub(a,"initData",Object)){a=ub(c,"initData",Uint8Array);if(null==a)throw Error("'initData.initData' cannot be null.");c=tb(c,"initDataType");if(null==c)throw Error("'initData.initDataType' cannot be null.");b.b.push({initData:new Uint8Array(a.buffer),initDataType:c})}return b}
function mc(a,b){var c=new kc;c.a=a.a;c.h=a.h;c.i=a.i;c.m=a.m;c.o=a.o;c.g=a.g;c.j=a.j;c.f=a.f;c.l=a.l;c.c=a.c?new Uint8Array(a.c.buffer):null;nc(c,a.b);nc(c,b.b);return c}function nc(a,b){var c=a.b.concat(b.map(function(a){return{initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType}}));a.b=Ra(c,oc)}function oc(a,b){return a.initDataType==b.initDataType&&db(a.initData,b.initData)};function pc(a,b){try{var c=new qc(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function rc(a){var b=this.mediaKeys;b&&b!=a&&sc(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&sc(a,this);return Promise.resolve()}
function qc(a,b){this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},l=!1;if(g.audioCapabilities)for(var m=0;m<g.audioCapabilities.length;++m){var n=g.audioCapabilities[m];
n.contentType&&(l=!0,e.canPlayType(n.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(n),d=!0))}if(g.videoCapabilities)for(m=0;m<g.videoCapabilities.length;++m)n=g.videoCapabilities[m],n.contentType&&(l=!0,e.canPlayType(n.contentType,this.a)&&(h.videoCapabilities.push(n),d=!0));l||(d=e.canPlayType("video/mp4",this.a)||e.canPlayType("video/webm",this.a));"required"==g.persistentState&&(c?(h.persistentState="required",h.sessionTypes=["persistent-license"]):d=!1);if(d){this.b=h;return}}c=
"Unsupported keySystem";if("org.w3.clearkey"==a||"com.widevine.alpha"==a)c="None of the requested configurations were supported.";c=Error(c);c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}qc.prototype.createMediaKeys=function(){var a=new tc(this.a);return Promise.resolve(a)};qc.prototype.getConfiguration=function(){return this.b};function tc(a){this.g=a;this.b=null;this.a=new B;this.c=[];this.f={}}
function sc(a,b){a.b=b;yb(a.a);b&&(C(a.a,b,"webkitneedkey",a.Ob.bind(a)),C(a.a,b,"webkitkeymessage",a.Nb.bind(a)),C(a.a,b,"webkitkeyadded",a.Lb.bind(a)),C(a.a,b,"webkitkeyerror",a.Mb.bind(a)))}k=tc.prototype;k.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.b||document.createElement("video");a.src||(a.src="about:blank");b=new uc(a,this.g,b);this.c.push(b);return b};
k.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};k.Ob=function(a){a=x({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a)};k.Nb=function(a){var b=vc(this,a.sessionId);b&&(a=x({type:"message",messageType:void 0==b.keyStatuses.Ea()?"licenserequest":"licenserenewal",message:a.message}),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a))};
k.Lb=function(a){if(a=vc(this,a.sessionId))wc(a,"usable"),a.a&&a.a.resolve(),a.a=null};
k.Mb=function(a){var b=vc(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode=a.errorCode;c.errorCode.systemCode=a.systemCode;!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?wc(b,"output-restricted"):1==c?wc(b,"expired"):wc(b,"internal-error"))}};
function vc(a,b){var c=a.f[b];return c?c:(c=a.c.shift())?(c.sessionId=b,a.f[b]=c):null}function uc(a,b,c){D.call(this,null);this.f=a;this.h=!1;this.a=this.b=null;this.c=b;this.g=c;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new xc}q(uc,D);
function yc(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var d;try{if("persistent-license"==a.g)if(c)d=hc("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=hc("PERSISTENT|"+gc(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.b=new E;try{a.f.webkitGenerateKeyRequest(a.c,d)}catch(g){if("InvalidStateError"!=g.name)return a.b=null,Promise.reject(g);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,d)}catch(a){this.b.reject(a),
this.b=null}}.bind(a),10)}return a.b}k=uc.prototype;k.Pa=function(a,b){if(this.a)this.a.then(this.Pa.bind(this,a,b)).catch(this.Pa.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=gc(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=ic(d.keys[0].k),d=ic(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}};
function wc(a,b){a.keyStatuses.La(b);var c=x({type:"keystatuseschange"});a.dispatchEvent(c)}k.generateRequest=function(a,b){return yc(this,b,null)};k.load=function(a){return"persistent-license"==this.g?yc(this,null,a):Promise.reject(Error("Not a persistent session."))};k.update=function(a){var b=new E;this.Pa(b,a);return b};
k.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}this.closed.resolve();return this.closed};k.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function xc(){this.size=0;this.a=void 0}var zc;k=xc.prototype;k.La=function(a){this.size=void 0==a?0:1;this.a=a};k.Ea=function(){return this.a};
k.forEach=function(a){this.a&&a(zc,this.a)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=zc;return this.a&&db(new Uint8Array(a),new Uint8Array(b))?!0:!1};function Ac(a){this.systemIds=[];this.cencKeyIds=[];this.a=[];a=new Ta(new DataView(a.buffer));try{for(;Va(a);){var b=a.a,c=w(a),d=w(a);1==c?c=Xa(a):0==c&&(c=a.b.byteLength-b);if(1886614376!=d)Za(a,c-(a.a-b));else{var e=Wa(a);if(1<e)Za(a,c-(a.a-b));else{Za(a,3);var f=jc(Ya(a)),g=[];if(0<e)for(var h=w(a),l=0;l<h;++l){var m=jc(Ya(a));g.push(m)}var n=w(a);Za(a,n);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);this.a.push({start:b,end:a.a-1});a.a!=b+c&&Za(a,c-(a.a-b))}}}}catch(t){}}
;function Bc(a,b){try{var c=new Cc(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}
function Cc(a,b){this.keySystem=a;for(var c=!1,d=0;d<b.length;++d){var e=b[d],f={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"]},g=!1;if(e.audioCapabilities)for(var h=0;h<e.audioCapabilities.length;++h){var l=e.audioCapabilities[h];if(l.contentType){var g=!0,m=l.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,m)&&(f.audioCapabilities.push(l),c=!0)}}if(e.videoCapabilities)for(h=
0;h<e.videoCapabilities.length;++h)l=e.videoCapabilities[h],l.contentType&&(g=!0,m=l.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,m)&&(f.videoCapabilities.push(l),c=!0));g||(c=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required"==e.persistentState&&(f.persistentState="required",f.sessionTypes=["persistent-license"]);if(c){this.a=f;return}}c=Error("Unsupported keySystem");c.name="NotSupportedError";c.code=DOMException.NOT_SUPPORTED_ERR;throw c;}
Cc.prototype.createMediaKeys=function(){var a=new Dc(this.keySystem);return Promise.resolve(a)};Cc.prototype.getConfiguration=function(){return this.a};function Ec(a){var b=this.mediaKeys;b&&b!=a&&Fc(b,null);delete this.mediaKeys;return(this.mediaKeys=a)?Fc(a,this):Promise.resolve()}function Dc(a){this.a=new MSMediaKeys(a);this.b=new B}Dc.prototype.createSession=function(a){if("temporary"!=(a||"temporary"))throw new TypeError("Session type "+a+" is unsupported on this platform.");return new Gc(this.a)};
Dc.prototype.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};function Fc(a,b){function c(){b.msSetMediaKeys(d.a);b.removeEventListener("loadedmetadata",c)}yb(a.b);if(!b)return Promise.resolve();C(a.b,b,"msneedkey",Hc);var d=a;try{return 1<=b.readyState?b.msSetMediaKeys(a.a):b.addEventListener("loadedmetadata",c),Promise.resolve()}catch(e){return Promise.reject(e)}}
function Gc(a){D.call(this,null);this.c=null;this.g=a;this.b=this.a=null;this.f=new B;this.sessionId="";this.expiration=NaN;this.closed=new E;this.keyStatuses=new Ic}q(Gc,D);k=Gc.prototype;k.generateRequest=function(a,b){this.a=new E;try{this.c=this.g.createSession("video/mp4",new Uint8Array(b),null),C(this.f,this.c,"mskeymessage",this.Bb.bind(this)),C(this.f,this.c,"mskeyadded",this.zb.bind(this)),C(this.f,this.c,"mskeyerror",this.Ab.bind(this)),Jc(this,"status-pending")}catch(c){this.a.reject(c)}return this.a};
k.load=function(){return Promise.reject(Error("MediaKeySession.load not yet supported"))};k.update=function(a){this.b=new E;try{this.c.update(new Uint8Array(a))}catch(b){this.b.reject(b)}return this.b};k.close=function(){try{this.c.close(),this.closed.resolve(),yb(this.f)}catch(a){this.closed.reject(a)}return this.closed};k.remove=function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))};
function Hc(a){var b=a.initData;if(b){var c=new Ac(b);if(1>=c.a.length)a=b;else{var d=[];for(a=0;a<c.a.length;a++)d.push(b.subarray(c.a[a].start,c.a[a].end+1));b=Ra(d,Kc);for(a=c=0;a<b.length;a++)c+=b[a].length;c=new Uint8Array(c);for(a=d=0;a<b.length;a++)c.set(b[a],d),d+=b[a].length;a=c}}else a=b;a=x({type:"encrypted",initDataType:"cenc",initData:a});this.dispatchEvent(a)}function Kc(a,b){return db(a,b)}
k.Bb=function(a){this.a&&(this.a.resolve(),this.a=null);a=x({type:"message",messageType:void 0==this.keyStatuses.Ea()?"licenserequest":"licenserenewal",message:a.message.buffer});this.dispatchEvent(a)};k.zb=function(){this.a?(this.a.resolve(),this.a=null):this.b&&(Jc(this,"usable"),this.b.resolve(),this.b=null)};
k.Ab=function(){var a=Error("EME v20140218 key error");a.errorCode=this.c.error;if(null!=this.a)this.a.reject(a),this.a=null;else if(null!=this.b)this.b.reject(a),this.b=null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Jc(this,"output-not-allowed");default:Jc(this,"internal-error")}};function Jc(a,b){a.keyStatuses.La(b);var c=x({type:"keystatuseschange"});a.dispatchEvent(c)}function Ic(){this.size=0;this.a=void 0}var Lc;
k=Ic.prototype;k.La=function(a){this.size=void 0==a?0:1;this.a=a};k.Ea=function(){return this.a};k.forEach=function(a){this.a&&a(Lc,this.a)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=Lc;return this.a&&db(new Uint8Array(a),new Uint8Array(b))?!0:!1};function Mc(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(zc=(new Uint8Array([0])).buffer,Navigator.prototype.requestMediaKeySystemAccess=pc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=rc,window.MediaKeys=tc,window.MediaKeySystemAccess=qc):window.MSMediaKeys?(Lc=(new Uint8Array([0])).buffer,delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Ec,window.MediaKeys=Dc,window.MediaKeySystemAccess=Cc,Navigator.prototype.requestMediaKeySystemAccess=Bc):(Navigator.prototype.requestMediaKeySystemAccess=ya,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=za,window.MediaKeys=Aa,window.MediaKeySystemAccess=Ba))}p("shaka.polyfill.MediaKeys.install",Mc);p("shaka.polyfill.installAll",function(){ta();wa();Pa();Da();Mc()});var Nc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function H(a){var b;a instanceof H?(Oc(this,a.L),this.aa=a.aa,this.O=a.O,Pc(this,a.ga),this.K=a.K,Qc(this,a.a.clone()),this.Z=a.Z):a&&(b=String(a).match(Nc))?(Oc(this,b[1]||"",!0),this.aa=Rc(b[2]||""),this.O=Rc(b[3]||"",!0),Pc(this,b[4]),this.K=Rc(b[5]||"",!0),Qc(this,b[6]||"",!0),this.Z=Rc(b[7]||"")):this.a=new Sc(null)}k=H.prototype;k.L="";k.aa="";k.O="";k.ga=null;k.K="";k.Z="";
k.toString=function(){var a=[],b=this.L;b&&a.push(Uc(b,Vc,!0),":");if(b=this.O){a.push("//");var c=this.aa;c&&a.push(Uc(c,Vc,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.ga;null!=b&&a.push(":",String(b))}if(b=this.K)this.O&&"/"!=b.charAt(0)&&a.push("/"),a.push(Uc(b,"/"==b.charAt(0)?Wc:Xc,!0));(b=this.a.toString())&&a.push("?",b);(b=this.Z)&&a.push("#",Uc(b,Yc));return a.join("")};
k.resolve=function(a){var b=this.clone();"data"===b.L&&(b=new H);var c=!!a.L;c?Oc(b,a.L):c=!!a.aa;c?b.aa=a.aa:c=!!a.O;c?b.O=a.O:c=null!=a.ga;var d=a.K;if(c)Pc(b,a.ga);else if(c=!!a.K){if("/"!=d.charAt(0))if(this.O&&!this.K)d="/"+d;else{var e=b.K.lastIndexOf("/");-1!=e&&(d=b.K.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||
1==f.length&&""!=f[0])&&f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.K=d:c=""!==a.a.toString();c?Qc(b,a.a.clone()):c=!!a.Z;c&&(b.Z=a.Z);return b};k.clone=function(){return new H(this)};function Oc(a,b,c){a.L=c?Rc(b,!0):b;a.L&&(a.L=a.L.replace(/:$/,""))}function Pc(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.ga=b}else a.ga=null}function Qc(a,b,c){b instanceof Sc?a.a=b:(c||(b=Uc(b,Zc)),a.a=new Sc(b))}
function Rc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function Uc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,$c),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function $c(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Vc=/[#\/\?@]/g,Xc=/[\#\?:]/g,Wc=/[\#\?]/g,Zc=/[\#\?@]/g,Yc=/#/g;function Sc(a){this.b=a||null}Sc.prototype.a=null;Sc.prototype.c=null;
function ad(a,b,c){if(!a.a&&(a.a={},a.c=0,a.b))for(var d=a.b.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];g=decodeURIComponent(g.replace(/\+/g," "));h=h||"";ad(a,g,decodeURIComponent(h.replace(/\+/g," ")))}a.b=null;(d=a.a.hasOwnProperty(b)&&a.a[b])||(a.a[b]=d=[]);d.push(c);a.c++}
Sc.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var a=[],b;for(b in this.a)for(var c=encodeURIComponent(b),d=this.a[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.b=a.join("&")};Sc.prototype.clone=function(){var a=new Sc;a.b=this.b;if(this.a){var b={},c;for(c in this.a)b[c]=this.a[c].concat();a.a=b;a.c=this.c}return a};function bd(){this.id=this.url=null;this.type="static";this.b=this.l=this.s=this.fb=null;this.h=5;this.f=this.c=this.g=null;this.i=1;this.a=[]}function cd(){this.g=this.f=this.c=this.s=this.a=this.start=this.id=null;this.b=[]}function dd(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.group=this.id=null;this.c=!1;this.h=this.g=this.f=this.s=null;this.l=[];this.a=[]}function ed(){this.value=null}function fd(){this.contentType=this.lang=this.id=null}
function gd(){this.a=this.b=this.g=this.s=this.h=this.f=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.c=[]}function hd(){this.b=this.a=this.c=this.f=null}function id(){this.parsedPssh=this.psshBox=null}function jd(){this.url=null}function kd(){this.url=null}function ld(){this.s=null;this.g=1;this.c=this.b=this.a=this.f=null}ld.prototype.clone=function(){var a=new ld;a.s=md(this.s);a.g=this.g;a.f=this.f;a.a=I(this.a);a.b=I(this.b);a.c=I(this.c);return a};
function nd(){this.a=this.url=null}nd.prototype.clone=function(){var a=new nd;a.url=md(this.url);a.a=I(this.a);return a};function od(){this.a=this.url=null}od.prototype.clone=function(){var a=new od;a.url=md(this.url);a.a=I(this.a);return a};function pd(){this.s=null;this.f=1;this.b=this.g=null;this.i=1;this.h=null;this.a=[];this.c=null}pd.prototype.clone=function(){var a=new pd;a.s=md(this.s);a.f=this.f;a.g=this.g;a.b=this.b;a.i=this.i;a.h=I(this.h);a.a=md(this.a)||[];a.c=I(this.c);return a};
function qd(){this.a=this.b=null}qd.prototype.clone=function(){var a=new qd;a.b=md(this.b);a.a=I(this.a);return a};function rd(){this.a=1;this.b=this.i=null;this.l=1;this.c=this.g=this.f=this.h=null}rd.prototype.clone=function(){var a=new rd;a.a=this.a;a.i=this.i;a.b=this.b;a.l=this.l;a.h=this.h;a.f=this.f;a.g=this.g;a.c=I(this.c);return a};function sd(){this.a=[]}sd.prototype.clone=function(){var a=new sd;a.a=md(this.a)||[];return a};function td(){this.b=this.a=this.startTime=null}
td.prototype.clone=function(){var a=new td;a.startTime=this.startTime;a.a=this.a;a.b=this.b;return a};function ud(a,b){this.la=a;this.end=b}ud.prototype.clone=function(){return new ud(this.la,this.end)};bd.TAG_NAME="MPD";cd.TAG_NAME="Period";dd.TAG_NAME="AdaptationSet";ed.TAG_NAME="Role";fd.TAG_NAME="ContentComponent";gd.TAG_NAME="Representation";hd.TAG_NAME="ContentProtection";id.TAG_NAME="cenc:pssh";jd.TAG_NAME="BaseURL";kd.TAG_NAME="Location";ld.TAG_NAME="SegmentBase";nd.TAG_NAME="RepresentationIndex";
od.TAG_NAME="Initialization";pd.TAG_NAME="SegmentList";qd.TAG_NAME="SegmentURL";rd.TAG_NAME="SegmentTemplate";sd.TAG_NAME="SegmentTimeline";td.TAG_NAME="S";
bd.prototype.parse=function(a,b){this.url=a.fb;this.id=K(b,"id",L);this.type=K(b,"type",L)||"static";this.b=K(b,"mediaPresentationDuration",vd);this.h=K(b,"minBufferTime",vd,this.h);this.g=K(b,"minimumUpdatePeriod",vd,this.g);this.c=K(b,"availabilityStartTime",wd,this.c);this.f=K(b,"timeShiftBufferDepth",vd,this.f);this.i=K(b,"suggestedPresentationDelay",vd,this.i);var c=a.s,d=M(this,b,jd);this.s=xd(c,d);if(d=N(this,b,kd))this.l=yd(c,d.url);this.a=M(this,b,cd)};
cd.prototype.parse=function(a,b){this.id=K(b,"id",L);this.start=K(b,"start",vd);this.a=K(b,"duration",vd);var c=M(this,b,jd);this.s=xd(a.s,c);this.c=N(this,b,ld);this.f=N(this,b,pd);this.g=N(this,b,rd);this.b=M(this,b,dd);zd(this)};function zd(a){for(var b=[],c=0;c<a.b.length;++c){var d=a.b[c];null!=d.group&&(b[d.group]=!0)}for(c=0;c<a.b.length;++c)if(d=a.b[c],null==d.group){for(var e=1;1==b[e];)++e;b[e]=!0;d.group=e}}
dd.prototype.parse=function(a,b){var c=N(this,b,fd)||{},d=N(this,b,ed);this.id=K(b,"id",L);this.group=K(b,"group",P);this.lang=K(b,"lang",L,c.lang);this.contentType=K(b,"contentType",L,c.contentType);this.width=K(b,"width",Q);this.height=K(b,"height",Q);this.b=K(b,"mimeType",L);this.i=K(b,"codecs",L);this.c=d&&"main"==d.value;this.lang&&(this.lang=lb(this.lang));c=M(this,b,jd);this.s=xd(a.s,c);this.l=M(this,b,hd);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.f=a.c?Ad(this,
b,a.c):N(this,b,ld);this.g=a.f?Ad(this,b,a.f):N(this,b,pd);this.h=a.g?Ad(this,b,a.g):N(this,b,rd);this.a=M(this,b,gd);!this.b&&this.a.length&&(this.b=this.a[0].f,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))};ed.prototype.parse=function(a,b){this.value=K(b,"value",L)};fd.prototype.parse=function(a,b){this.id=K(b,"id",L);this.lang=K(b,"lang",L);this.contentType=K(b,"contentType",L);this.lang&&(this.lang=lb(this.lang))};
gd.prototype.parse=function(a,b){this.id=K(b,"id",L);this.bandwidth=K(b,"bandwidth",Q);this.width=K(b,"width",Q,a.width);this.height=K(b,"height",Q,a.height);this.f=K(b,"mimeType",L,a.b);this.h=K(b,"codecs",L,a.i);this.lang=a.lang;var c=M(this,b,jd);this.s=xd(a.s,c);this.c=M(this,b,hd);this.g=a.f?Ad(this,b,a.f):N(this,b,ld);this.b=a.g?Ad(this,b,a.g):N(this,b,pd);this.a=a.h?Ad(this,b,a.h):N(this,b,rd);this.c=this.c.concat(a.l)};
hd.prototype.parse=function(a,b){this.f=b;this.c=K(b,"schemeIdUri",L);var c=K(b,"cenc:default_KID",L);c&&(this.b=c.replace(/[-]/g,""));this.a=N(this,b,id)};id.prototype.parse=function(a,b){var c=Bd(b);if(c){this.psshBox=ic(c);try{this.parsedPssh=new Ac(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};jd.prototype.parse=function(a,b){this.url=Bd(b)};kd.prototype.parse=function(a,b){this.url=Bd(b)};
ld.prototype.parse=function(a,b){this.s=a.s||this.s;this.g=K(b,"timescale",Q,this.g);this.f=K(b,"presentationTimeOffset",P,this.f);this.a=K(b,"indexRange",Cd,this.a);this.b=N(this,b,nd)||this.b;this.c=N(this,b,od)||this.c};nd.prototype.parse=function(a,b){var c=K(b,"sourceURL",L);this.url=yd(a.s,c);this.a=K(b,"range",Cd,I(a.a))};od.prototype.parse=function(a,b){var c=K(b,"sourceURL",L);this.url=yd(a.s,c);this.a=K(b,"range",Cd)};
pd.prototype.parse=function(a,b){this.s=a.s||this.s;this.f=K(b,"timescale",Q,this.f);this.g=K(b,"presentationTimeOffset",P,this.g);this.b=K(b,"duration",Q,this.b);var c=K(b,"startNumber",Q);null!=c&&(this.i=c);this.h=N(this,b,od)||this.h;this.a=(c=M(this,b,qd))&&0<c.length?c:this.a;this.c=N(this,b,sd)||this.c};qd.prototype.parse=function(a,b){var c=K(b,"media",L);this.b=yd(a.s,c);this.a=K(b,"mediaRange",Cd)};
rd.prototype.parse=function(a,b){this.a=K(b,"timescale",Q,this.a);this.i=K(b,"presentationTimeOffset",P,this.i);this.b=K(b,"duration",Q,this.b);var c=K(b,"startNumber",P);null!=c&&(this.l=c);this.h=K(b,"media",L,this.h);this.f=K(b,"index",L,this.f);this.g=K(b,"initialization",L,this.g);this.c=N(this,b,sd)||this.c};sd.prototype.parse=function(a,b){this.a=M(this,b,td)};td.prototype.parse=function(a,b){this.startTime=K(b,"t",P);this.a=K(b,"d",P);this.b=K(b,"r",Dd)};
function xd(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new H(e)):(e=yd(a.slice(0,1),e),c.push(e[0]))}return c}function yd(a,b){if(!b)return a;var c=new H(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function Ad(a,b,c){var d=I(c);(b=Ed(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function N(a,b,c){var d=null;if(b=Ed(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}
function Ed(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function M(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function Bd(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function md(a){return a?a.map(function(a){return a.clone()}):null}function I(a){return a?a.clone():null}
function K(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function wd(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function vd(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=P(b[1]);c&&(a+=31536E3*c);(c=P(b[2]))&&(a+=2592E3*c);(c=P(b[3]))&&(a+=86400*c);(c=P(b[4]))&&(a+=3600*c);(c=P(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function Cd(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=P(b[1]);if(null==a)return null;b=P(b[2]);return null==b?null:new ud(a,b)}function Dd(a){a=window.parseInt(a,10);return isNaN(a)?null:a}function Q(a){a=window.parseInt(a,10);return 0<a?a:null}function P(a){a=window.parseInt(a,10);return 0<=a?a:null}function L(a){return a};function Fd(a,b){this.url=a;this.b=b||new ac;this.g=this.i=this.h=0;this.a=null;this.c=new E;this.f=null}function ac(){this.body=null;this.a=1;this.h=1E3;this.c=0;this.method="GET";this.f="arraybuffer";this.b={};this.g=this.l=!1;this.i=null}var Gd=!0;function Hd(a){Id(a);a.b.body=null;a.c.destroy();a.c=null;a.f=null}function Id(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null);a.a=null}k=Fd.prototype;
k.pb=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.b.f&&(b=hc(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.c;b.resolve(a);Hd(this);return b}if(0==this.url.lastIndexOf("idb:",0))return Jd(this);this.h++;this.i=Date.now();this.g||
(this.g=this.b.h);this.a=jb("new_http_request",{url:this.url});this.a||(this.a=new XMLHttpRequest);a=this.url;Gd&&(this.f&&!this.f.supportsCaching()||this.b.g)&&(a=new H(a),ad(a.a,"_",Date.now()),a=a.toString());this.a.open(this.b.method,a,!0);this.a.responseType=this.b.f;this.a.timeout=this.b.c;this.a.withCredentials=this.b.l;this.a.onload=this.xb.bind(this);this.b.g&&(this.a.onreadystatechange=this.Eb.bind(this));this.a.onerror=this.Tb.bind(this);this.a.ontimeout=this.Ib.bind(this);for(b in this.b.b)this.a.setRequestHeader(b,
this.b.b[b]);this.a.send(this.b.body);return this.c};function Jd(a){var b=a.url.split("/");return Vb(a.b.i,parseInt(b[2],10),parseInt(b[3],10)).then(F(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.c;a.resolve(b);Hd(this);return a})).catch(F(a,function(a){Hd(this);return Promise.reject(a)}))}function Kd(a,b,c){b=Error(b);b.type=c;b.status=a.a.status;b.url=a.url;b.method=a.b.method;b.body=a.b.body;b.xhr=a.a;return b}
k.xb=function(a){this.f&&this.f.sample(Date.now()-this.i,a.loaded);200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),Hd(this)):this.h<this.b.a?Ld(this):(a=Kd(this,"HTTP error.","net"),this.c.reject(a),Hd(this))};k.Eb=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a&&(Sa=a-Date.now())}};k.Tb=function(){var a=Kd(this,"Network failure.","net");this.c.reject(a);Hd(this)};
k.Ib=function(){if(this.h<this.b.a)Ld(this);else{var a=Kd(this,"Request timed out.","net");this.c.reject(a);Hd(this)}};function Ld(a){Id(a);window.setTimeout(a.pb.bind(a),a.g*(1+.5*(2*Math.random()-1)));a.g*=2};function G(a,b,c,d){this.M=b;this.oa=c||0;this.g=null!=d?d:null;this.b=this.a=null;this.h=a;this.f=null}function Md(a,b){return a&&0!==a.length?a.map(function(a){return a.resolve(b)}):[b]}G.prototype.fetch=function(a,b){if(this.a)return this.a;var c=a||new ac;if(this.oa||this.g)c.b.Range="bytes="+(this.oa+"-"+(null!=this.g?this.g:""));return this.a=Nd(this,0,c,b)};
G.prototype.c=function(){if(this.b){this.a=null;var a=this.b;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){a.a.abort();var b=Kd(a,"Request aborted.","aborted");a.c.reject(b);Hd(a)}this.f=this.b=null}};
function Nd(a,b,c,d){var e=a.M[b].toString();a.h&&(e=a.h(e,c.b)||e);a.b=new Fd(e,c);d&&(a.b.f=d);e=a.b.pb().then(F(a,function(a){this.f=this.b=this.a=null;this.f=a.a?new H(a.a):this.M[b];return Promise.resolve(a.response)}));return e=e.catch(F(a,function(a){if(this.a&&b+1<this.M.length)return this.a=Nd(this,b+1,c,d);this.a=this.b=null;return Promise.reject(a)}))}G.prototype.clone=function(){return new G(this.h,this.M.map(function(a){return a.clone()}),this.oa,this.g)};G.prototype.toString=function(){return this.M[0].toString()};function Od(a,b){this.a=new ac;this.a.f="text";this.a.a=3;this.a.c=1E3*(null!=b?b:0);this.a.g=!0;this.b=a}function Pd(a){var b=a.b;return b.fetch(a.a).then(function(a){var d;d=b.M;var e=[b.f];d=(a=(new DOMParser).parseFromString(a,"text/xml"))?N({fb:d,s:e},a,bd):null;if(d)return Promise.resolve(d);d=Error("MPD parse failure.");d.type="dash";return Promise.reject(d)})};function Qd(a,b,c,d){for(var e=b.a,f=[],g=0;g<d;++g){var h=g+c,l=(h-1)*e.b,m=l/e.a,n=(l+e.b)/e.a,h=Rd(a,b,e.l+h-1,l);if(!h)return null;f.push(new Sd(m,n,h))}return f}function Rd(a,b,c,d){if(!b.a)return null;var e=b.a.h;if(!e)return b.s?new G(a,b.s,0,null):null;c=Td(e,b.id,c,b.bandwidth,d);if(!c)return null;b=Md(b.s,c);return new G(a,b,0,null)}
function Td(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new H(a)}catch(g){if(g instanceof URIError)return null;throw g;}}
function Ud(a,b,c){var d=0;b*=c;a=a.a;c=[];for(var e=0;e<a.length&&a[e].a;++e){var f=a[e].startTime,f=null!=f?f:d,g=a[e].b||0;0>g&&(g=a[e].a,g=e+1===a.length?Math.ceil((a[0].startTime+b-f)/g)-1:Math.ceil((a[e+1].startTime-f)/g)-1);0<c.length&&f!=d&&(c[c.length-1].end=f);for(var h=0;h<=g;++h)d=f+a[e].a,c.push({start:f,end:d}),f=d}return c};function Vd(a,b){this.a=a;this.b=b||null}Vd.prototype.destroy=function(){this.a&&(this.a.c(),this.a=null);this.b=null};Vd.prototype.create=function(){return this.a?this.a.fetch():Promise.resolve(this.b)};function Sd(a,b,c){this.startTime=a;this.endTime=b;this.url=c}function Wd(a,b,c){return new Sd(b,c,a.url)}function bc(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.startTime&&(null==d.endTime||b<d.endTime))return c}return-1}function Xd(a,b){return a.map(function(a){return Wd(a,a.startTime+b,null!=a.endTime?a.endTime+b:null)})};function Yd(){}
Yd.prototype.parse=function(a,b,c,d){var e=null;try{a:{var f=[],g=new Ta(a),h=w(g);if(1936286840!=w(g))e=null;else{1==h&&(h=Xa(g));var l=Wa(g);Za(g,3);Za(g,4);var m=w(g);if(0==m)e=null;else{var n,t;0==l?(n=w(g),t=w(g)):(n=Xa(g),t=Xa(g));Za(g,2);var A=g.b.getUint16(g.a,g.c);g.a+=2;a=n;b=b+h+t;for(h=0;h<A;h++){var O=w(g);t=(O&2147483648)>>>31;var l=O&2147483647,J=w(g);w(g);if(1==t){e=null;break a}var va=new G(d,c,b,b+l-1);f.push(new Sd(a/m,(a+J)/m,va));a+=J;b+=l}e=f}}}}catch(Mb){if(!(Mb instanceof RangeError))throw Mb;
}return e};function R(a){this.references=a;this.i=0}R.prototype.destroy=function(){this.references=null};k=R.prototype;k.length=function(){return this.references.length};function S(a){if(0==a.references.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.references[0]}k.v=function(){if(0==this.references.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return this.references[this.references.length-1]};
k.get=function(a){if(0>a||a>=this.references.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.references[a]};k.ja=function(a){a=bc(this.references,a);return 0<=a?this.references[a]:null};k.Ga=function(a){Zd(this,a);return!0};
function Zd(a,b){a.i!=b.i&&(b=new R(Xd(b.references,a.i-b.i)));if(0==a.length())a.references=b.references.slice(0);else if(0!=b.length()&&null!=a.v().endTime&&!(null!=b.v().endTime&&b.v().endTime<a.v().endTime)){if(a.v().endTime<=S(b).startTime)var c=Wd(a.v(),a.v().startTime,S(b).startTime),c=a.references.slice(0,-1).concat([c]);else{var d;for(d=0;d<a.references.length&&!(a.references[d].endTime>=S(b).startTime);++d);a.references[d].startTime<S(b).startTime?(c=Wd(a.references[d],a.references[d].startTime,
S(b).startTime),c=a.references.slice(0,d).concat([c])):(S(a).startTime>S(b).startTime||S(b),c=a.references.slice(0,d))}a.references=c.concat(b.references)}}k.ia=function(a){var b=a-this.i;if(0==b)return 0;this.references=Xd(this.references,b);this.i=a;return b};k.Da=function(){return 0<this.length()?{start:S(this).startTime,end:this.v().endTime}:{start:0,end:0}};function T(a,b,c,d){R.call(this,a);this.g=b;this.u=c;this.f=d;this.h=this.g.b||this.g.a.reduce(function(a,b){return null==b.a?NaN:a+b.a},0)||0;this.a=this.m=this.c=null;$d(this)}q(T,R);T.prototype.destroy=function(){this.u=this.g=null;R.prototype.destroy.call(this)};T.prototype.ja=function(a){ae(this,v()/1E3);return R.prototype.ja.call(this,a)};T.prototype.Ga=function(a){if(!(a instanceof T))return!1;Zd(this,a);this.h=Math.max(this.h,a.h);null==this.c?(this.f=a.f,$d(this)):be(this);return!0};
function $d(a){be(a);if(0!=a.length()){a.length();var b=null!=a.v().endTime?a.v().endTime:a.v().startTime;if(a.g.c>a.f)a.c=b;else{var c=a.f-(a.g.c+a.u.start);0>c?a.c=b:c<Math.max(a.v().startTime,a.v().endTime||0)?(a.v(),a.c=b):a.c=c}a.m=a.v().startTime;a.a=S(a).startTime}}
T.prototype.ia=function(a){a=R.prototype.ia.call(this,a);Math.min.apply(null,this.references.filter(function(a){return null!=a.endTime}).map(function(a){return a.endTime-a.startTime}));null!=this.c&&(this.m+=a,this.a+=a,this.c+=a);return a};T.prototype.Da=function(){return ce(this,v()/1E3)};
function ce(a,b){ae(a,b);if(null==a.c||null==a.m||null==a.a)return{start:0,end:0};var c=Number.POSITIVE_INFINITY;a.h&&(c=a.h);var d=b-a.f,e=a.c+d;null!=a.g.f&&(e=e-a.a-a.g.f,0<e&&(a.a+=e));a.a=Math.min(a.a,c);d=a.m+d;if(d<a.a)return{start:a.a,end:a.a};d=0<a.length()?null!=a.v().endTime?Math.min(d,a.v().endTime):d:a.a;d=Math.max(d,a.a);d=Math.min(d,c);return{start:a.a,end:d}}
function ae(a,b){be(a);if(null!=a.g.f)if(null==a.c)a.length();else{for(var c=a.c+(b-a.f),d=0,e=0;e<a.references.length;++e){var f=null;e<a.references.length-1?f=a.references[e+1].endTime:(f=a.references[e],f=null!=f.endTime?f.endTime+(f.endTime-f.startTime):null);if(null!=f&&f<c-a.g.f)++d;else break}0<d&&a.references.splice(0,d)}}function be(a){if(a.h){for(var b=0,c=a.references.length-1;0<=c;--c)if(a.references[c].startTime>a.h)++b;else break;0<b&&a.references.splice(-b)}};function de(a,b,c,d,e){var f=1,g=0,h;if(a.c>d)h=null;else{var l=a.i||0,m=a.f||0;h=c.a;h=h.b/h.a;var n=d-(a.c+b.start);0>n?h=null:(m=n-2*h-m,0>m&&(m=0),m=Math.ceil(m/h)*h,n-=h,0>n?h=null:(l=Math.floor(n/h)*h-l,0>l&&(l=0),l=Math.floor(l/h)*h,h={Wa:m/h+1,current:(l>=m?l:m)/h+1}))}h&&(f=h.Wa,g=h.current-h.Wa+1);f=Qd(e,c,f,g);if(null==f)throw a=Error("Failed to generate SegmentReferences."),a.type="stream",a;T.call(this,f,a,b,d);this.o=c;this.j=this.b=0<this.length()?a.c+b.start+this.v().endTime:null;
this.l=h?h.current+1:null;this.w=e}q(de,T);de.prototype.destroy=function(){this.w=this.o=null;T.prototype.destroy.call(this)};de.prototype.ja=function(a){var b=v()/1E3;oe(this,b);ae(this,b);return R.prototype.ja.call(this,a)};de.prototype.Ga=function(a){if(null!=this.b||!(a instanceof de)||null==a.b)return!1;this.b=a.b;this.j=a.j;this.l=a.l;this.f=a.f;this.h=a.h;Zd(this,a);oe(this,v()/1E3);$d(this);return!0};
de.prototype.ia=function(a){a=T.prototype.ia.call(this,a);null!=this.b&&(this.b+=a,this.j+=a);return a};de.prototype.Da=function(){var a=v()/1E3;oe(this,a);return ce(this,a)};function oe(a,b){if(null!=a.b&&null!=a.j&&null!=a.l){var c=a.o.a,c=c.b/c.a,d=Math.floor((a.j+(b-a.f)-a.b)/c);if(0!=d){var e=Qd(a.w,a.o,a.l,d);Array.prototype.push.apply(a.references,Xd(e,a.i));a.b+=d*c;a.l+=d}}};function pe(a,b,c,d,e){this.c=a;this.a=b;this.b=c;this.g=d;this.segmentIndex_=null;this.f=e}pe.prototype.destroy=function(){this.f=this.b=this.a=this.c=null;this.segmentIndex_&&(this.segmentIndex_.destroy(),this.segmentIndex_=null)};
pe.prototype.create=function(){if(this.segmentIndex_)return Promise.resolve(this.segmentIndex_);if("dynamic"==this.c.type)try{this.segmentIndex_=new de(this.c,this.a,this.b,this.g,this.f)}catch(a){return Promise.reject(a)}else{var b;b=this.b.a;if(b=Qd(this.f,this.b,1,Math.ceil(this.a.a/(b.b/b.a)))){if(0<b.length){var c=b[b.length-1];b[b.length-1]=Wd(c,c.startTime,this.a.a)}b=new R(b)}else b=null;this.segmentIndex_=b;if(!this.segmentIndex_)return b=Error("Failed to generate SegmentReferences"),b.type=
"stream",Promise.reject(b)}return Promise.resolve(this.segmentIndex_)};function qe(a,b,c,d,e){this.b=a;this.a=b;this.f=c;this.segmentIndex_=null;this.g=d;this.c=e}qe.prototype.destroy=function(){this.c=this.f=this.a=this.b=null;this.segmentIndex_&&(this.segmentIndex_.destroy(),this.segmentIndex_=null)};
qe.prototype.create=function(){if(this.segmentIndex_)return Promise.resolve(this.segmentIndex_);var a=this.f.b,b=[];a.c&&(b=Ud(a.c,a.f||1,this.a.a||0));var c=0;a.b&&a.i?c=(a.i-1)*a.b:0<b.length&&(c=b[0].start-(a.g||0));var d=a.a.length;0<b.length&&b.length!=a.a.length&&(d=Math.min(b.length,a.a.length));for(var e=[],f=0;f<d;++f){var g=a.a[f],h=c/a.f,l=null,m=null;a.b?(l=c+a.b,m=l/a.f):0<b.length?(l=b[f].end-(a.g||0),m=l/a.f):(m=h+this.a.a,l=m*a.f);var c=l,l=0,n=null;g.a&&(l=g.a.la,n=g.a.end);e.push(new Sd(h,
m,new G(this.c,g.b,l,n)))}this.segmentIndex_="dynamic"==this.b.type?new T(e,this.b,this.a,this.g):new R(e);return Promise.resolve(this.segmentIndex_)};function re(a,b,c,d,e){this.a=a;this.b=b;this.c=c;this.g=d;this.segmentIndex_=null;this.f=e}re.prototype.destroy=function(){this.f=this.c=this.b=this.a=null;this.segmentIndex_&&(this.segmentIndex_.destroy(),this.segmentIndex_=null)};
re.prototype.create=function(){if(this.segmentIndex_)return Promise.resolve(this.segmentIndex_);for(var a=this.c.a,b=Ud(a.c,a.a||1,this.b.a||0),c=[],d=0;d<b.length;++d){var e=b[d].start,f=e/a.a,g=b[d].end/a.a,e=Rd(this.f,this.c,d+a.l,e);if(!e)return a=Error("Failed to generate media URL."),a.type="dash",Promise.reject(a);var h=(a.i||0)/a.a;c.push(new Sd(f-h,g-h,e))}this.segmentIndex_="dynamic"==this.a.type?new T(c,this.a,this.b,this.g):new R(c);return Promise.resolve(this.segmentIndex_)};function se(a){this.a=a;this.segmentIndex_=null}se.prototype.destroy=function(){this.a=null;this.segmentIndex_&&(this.segmentIndex_.destroy(),this.segmentIndex_=null)};se.prototype.create=function(){if(this.segmentIndex_)return Promise.resolve(this.segmentIndex_);for(var a=[],b=0;b<this.a.length;++b){var c=this.a[b];a.push(new Sd(c.start_time,c.end_time,new G(null,[new H(c.url)],c.start_byte,null)))}this.a=null;this.segmentIndex_=new R(a);return Promise.resolve(this.segmentIndex_)};function te(){this.A=ue++;this.id=this.F=this.segmentIndexSource=null;this.c=0;this.height=this.width=this.bandwidth=null;this.b=this.a="";this.f=[];this.J=!1;this.G=!0}var ue=0;te.prototype.destroy=function(){this.segmentIndexSource&&(this.segmentIndexSource.destroy(),this.segmentIndexSource=null);this.F&&(this.F.destroy(),this.F=null)};function ve(a){var b=a.a||"";a.b&&(b+='; codecs="'+a.b+'"');return b}
function we(){this.A=xe++;this.id=null;this.contentType=this.lang="";this.b=!1;this.streamInfos=[];this.a=[]}var xe=0;we.prototype.destroy=function(){for(var a=0;a<this.streamInfos.length;++a)this.streamInfos[a].destroy();this.a=this.streamInfos=null};function ye(a){for(var b=[],c=0;c<a.a.length;++c){var d=new ze;d.id=a.A;d.a=a.a[c];d.contentType=a.contentType;d.b=a.streamInfos.length?ve(a.streamInfos[0]):"";b.push(d)}return b}
function Ae(){this.id=null;this.start=0;this.a=null;this.streamSetInfos=[]}Ae.prototype.destroy=function(){for(var a=0;a<this.streamSetInfos.length;++a)this.streamSetInfos[a].destroy();this.streamSetInfos=null};function Be(){this.a=!1;this.g=this.f=this.c=null;this.b=0;this.periodInfos=[]}Be.prototype.destroy=function(){for(var a=0;a<this.periodInfos.length;++a)this.periodInfos[a].destroy();this.periodInfos=null};function ze(){this.id=0;this.a=null;this.b=this.contentType=""};function Ce(a,b,c,d,e){D.call(this,a);this.c=b;this.a=new Wb(c,d,e);this.u=this.segmentIndex_=this.b=null;this.D=!1;this.g=null;this.m=!1;this.i=null;this.o=!1;this.h=new E;this.j=this.f=!1;this.w=0;this.H=15;this.B=!1}q(Ce,D);Ce.prototype.C=function(a){null!=a.initialStreamBufferSize&&(this.w=Number(a.initialStreamBufferSize));null!=a.streamBufferSize&&(this.H=Number(a.streamBufferSize));null!=a.segmentRequestTimeout&&(this.a.o=Number(a.segmentRequestTimeout))};
Ce.prototype.destroy=function(){De(this);this.h.destroy();this.b=this.h=null;this.a.destroy();this.l=this.c=this.a=null};k=Ce.prototype;k.ma=function(){return this.b};k.$a=function(){return this.segmentIndex_};k.qb=function(a){this.f||a.then(function(){this.f=!0;this.g||Ee(this,0)}.bind(this)).catch(function(){});return this.h};k.Fa=function(){return this.j};
k.qa=function(a,b,c){if(a!=this.b){var d=[a.segmentIndexSource.create(),a.F.create()];Promise.all(d).then(F(this,function(d){if(this.c){var f=this.b;this.b=a;this.segmentIndex_=d[0];this.u=d[1];this.D=!0;this.m||(f?b&&Fe(this,!0,c):Ee(this,0))}})).catch(F(this,function(a){"aborted"!=a.type&&(this.f?(a=y(a),this.dispatchEvent(a)):this.h.reject(a))}))}};k.hb=function(){return Fe(this,!1)};
function Fe(a,b,c){a.b&&!a.m&&(a.m=!0,De(a),Yb(a.a).then(F(a,function(){var a=this.c.currentTime;if(!b&&0<Zb(this.a,a)&&0<=bc(this.a.b,a))return Promise.resolve();if(c)return ec(this.a,this.c.currentTime+c);this.B=!0;return dc(this.a)})).then(F(a,function(){this.m=!1;Ee(this,0)})).catch(F(a,function(a){this.m=!1;this.f?(a=y(a),this.dispatchEvent(a)):this.h.reject(a)})))}k.ib=function(a){return 0<Zb(this.a,a)&&0<=bc(this.a.b,a)};k.va=function(){};k.Ca=function(){return!0};
k.Kb=function(){if(this.o&&!this.f)this.g=null;else{var a;if(a=this.f&&!this.j)a=1<this.a.c.buffered.length?!0:!1;if(a)Fe(this,!0);else{this.g=null;a=this.b;var b=this.segmentIndex_,c=this.c.currentTime;Zb(this.a,this.o?c:c+(this.i||0))>=(this.o?Math.max(this.w,this.H):this.w)?(Ge(this),Ee(this,1E3/(Math.abs(this.c.playbackRate)||1))):(b=He(this,c,b))?(b=this.a.fetch(b,a.c,this.u),this.u=null,this.D&&(this.D=!1,Ie(this,a)),this.j=!1,b.then(F(this,function(a){null==this.i&&(this.i=a);this.B&&0<Zb(this.a,
c)&&(this.B=!1,this.c.currentTime+=.001);Ee(this,0)})).catch(F(this,function(a){if("aborted"!=a.type){var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.xhr.status)&&this.b&&Ee(this,5E3);a=y(a);this.dispatchEvent(a)}}))):(Ge(this),this.f&&!this.j&&(this.j=!0,Je(this)),Ee(this,1E3))}}};function He(a,b,c){a=a.a;var d=a.b.length;a=0<d?a.b[d-1]:null;return null!=a?null!=a.endTime?c.ja(a.endTime):null:c.ja(b)||(c.length()?c.v():null)}
function Ge(a){if(!a.o&&null!=a.i){a.o=!0;var b=a.a,c=a.i,d=c-b.u;0!=d&&(b.b=Xd(b.b,d),b.u=c);a.h.resolve(a.i)}}function Ie(a,b){var c;c=b.a.split("/")[0];c=x({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function Je(a){var b=x({type:"ended"});a.dispatchEvent(b)}function Ee(a,b){a.g=window.setTimeout(a.Kb.bind(a),b)}function De(a){null!=a.g&&(window.clearTimeout(a.g),a.g=null)};function Ke(a){this.a=a;this.segmentIndex_=null}Ke.prototype.destroy=function(){this.segmentIndex_&&(this.segmentIndex_.destroy(),this.segmentIndex_=null)};Ke.prototype.create=function(){if(this.segmentIndex_)return Promise.resolve(this.segmentIndex_);var a=new Sd(0,null,this.a);this.segmentIndex_=new R([a]);return Promise.resolve(this.segmentIndex_)};function Le(a,b){D.call(this,a);this.b=b;this.g=!0;this.segmentIndex_=this.f=null;this.c=new E;this.a=null}q(Le,D);Le.prototype.C=function(){};Le.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.c.destroy();this.l=this.b=this.f=this.segmentIndex_=this.a=this.c=null};k=Le.prototype;k.ma=function(){return this.f};k.$a=function(){return this.segmentIndex_};k.qb=function(){return this.c};k.Fa=function(){return!0};
k.qa=function(a){a.segmentIndexSource.create().then(F(this,function(b){if(this.b){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.f;this.f=a;this.segmentIndex_=b;b=S(b).url.M[0].toString();var d=this.Ca();this.a&&(this.va(!1),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=b;this.va(d);b=x({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c||this.c.resolve(0)}}))};
k.hb=function(){};k.ib=function(){return!0};k.va=function(a){this.g=a;this.a&&(this.a.track.mode=a?"showing":"disabled")};k.Ca=function(){this.a&&(this.g="showing"==this.a.track.mode);return this.g};function Me(){}
Me.prototype.parse=function(a,b,c,d){var e=null;try{var f;var g=new $a(b);if(440786851!=bb(g).id)f=null;else{var h=bb(g);if(408125543!=h.id)f=null;else{var l=h.a.byteOffset,m;var n=new $a(h.a);for(b=null;Va(n.a);){var t=bb(n);if(357149030==t.id){b=t;break}}if(b){for(var A=new $a(b.a),n=1E6;Va(A.a);){var O=bb(A);if(2807729==O.id){n=fb(O);break}}m=n/1E9}else m=null;f=m?{Qb:l,Ub:m}:null}}if(f){var J=bb(new $a(a));if(475249515!=J.id)e=null;else{var va=f.Qb,Mb=f.Ub;a=[];var ee=new $a(J.a);for(f=J=-1;Va(ee.a);){var fe=
bb(ee);if(187==fe.id){var Ha;var ge=new $a(fe.a),he=bb(ge);if(179!=he.id)Ha=null;else{var Bf=fb(he),ie=bb(ge);if(183!=ie.id)Ha=null;else{for(var je=new $a(ie.a),l=0;Va(je.a);){var ke=bb(je);if(241==ke.id){l=fb(ke);break}}Ha={Wb:Bf,Pb:l}}}if(Ha){var le=Mb*Ha.Wb,me=va+Ha.Pb;if(0<=J){var Tc=new G(d,c,f,me-1);a.push(new Sd(J,le,Tc))}J=le;f=me}}}0<=J&&(Tc=new G(d,c,f,null),a.push(new Sd(J,null,Tc)));e=a}}else e=null}catch(ne){if(!(ne instanceof RangeError))throw ne;}return e};function Ne(a,b,c,d,e,f,g){this.g=a;this.i=b;this.f=c;this.a=d;this.c=e;this.l=f;this.b=null;this.h=g}Ne.prototype.destroy=function(){this.h=this.i=this.g=null;this.a.c();this.a=null;this.c&&(this.c.c(),this.c=null);this.b=null};
Ne.prototype.create=function(){if(this.b)return this.b;var a=[this.a.fetch()];"webm"==this.f&&a.push(this.c.fetch());return this.b=Promise.all(a).then(F(this,function(a){var c=a[0];a=a[1]||null;var d=null;"mp4"==this.f?(d=new Yd,d=d.parse(new DataView(c),this.a.oa,this.a.M,this.h)):"webm"==this.f&&(d=new Me,d=d.parse(new DataView(c),new DataView(a),this.a.M,this.h));if(!d)return c=Error("Failed to parse SegmentReferences from "+this.a.toString()+" (or one of its fallbacks)."),c.type="stream",Promise.reject(c);
var e;"dynamic"==this.g.type?e=new T(d,this.g,this.i,this.l):e=new R(d);return Promise.resolve(e)}))};function Oe(a){this.a=a}
function Pe(a,b,c){for(var d=v()/1E3,e=0;e<b.a.length;++e)for(var f=b.a[e],g=0;g<f.b.length;++g){var h=f.b[g];if("text"!=h.contentType)for(var l=0;l<h.a.length;++l){var m=h.a[l],n=0,n=n+(m.g?1:0),n=n+(m.b?1:0),n=n+(m.a?1:0);0==n?(h.a.splice(l,1),--l):1!=n&&(m.g?(m.b=null,m.a=null):m.b&&(m.a=null))}}Qe(b);for(e=0;e<b.a.length;++e)for(f=b.a[e],g=0;g<f.b.length;++g){l=h=f.b[g];m=null;for(n=0;n<l.a.length;++n){var t=l.a[n].f||"";m?t!=m&&(l.a.splice(n,1),--n):m=t}0==h.a.length&&(f.b.splice(g,1),--g)}"dynamic"==
b.type&&null==b.c&&(b.c=d);e=new Be;"dynamic"==b.type&&(e.a=!0,e.c=b.g,e.f=new G(c,b.l||b.url),e.g=b.c);e.b=b.h||5;for(f=0;f<b.a.length;++f){g=b.a[f];if(null==g.start)break;g=Re(a,b,g,d,c);e.periodInfos.push(g)}return e}
function Qe(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.b=null);b(a.b)&&1==a.a.length&&!b(a.a[0].a)&&(a.a[0].a=a.b);for(var c=0,d=!0,e=0;e<a.a.length;++e){var f=a.a[e-1],g=a.a[e],h=a.a[e+1]||{start:a.b};!b(g.start)&&f&&b(f.start)&&b(f.a)&&(g.start=f.start+f.a);!b(g.a)&&b(h.start)&&(g.a=h.start-g.start);null!=g.start&&null!=g.a?c+=g.a:d=!1}b(a.b)||(e=a.a[a.a.length-1],d?a.b=c:b(e.start)&&b(e.a)?a.b=e.start+e.a:"dynamic"!=a.type&&
(a.b=c))}}function Re(a,b,c,d,e){var f=new Ae;f.id=c.id;f.start=c.start;f.a=c.a;var g=new z;c.b.forEach(function(a){g.push(a.contentType||"",a)});for(var h=xb(g),l=0;l<h.length;++l){var m=new z;g.get(h[l]).forEach(function(a){m.push(a.group,a)});for(var n=xb(m),t=0;t<n.length;++t){var A=new z;m.get(n[t]).forEach(function(a){A.push(a.lang,a)});for(var O=xb(A),J=0;J<O.length;++J){var va=A.get(O[J]),va=Se(a,b,c,va,d,e);f.streamSetInfos.push(va)}}}return f}
function Se(a,b,c,d,e,f){ba(d.every(function(a){return a.group==d[0].group&&(a.lang||"")==(d[0].lang||"")&&(a.contentType||"")==(d[0].contentType||"")}));var g=new we,h=d.filter(function(a){return null!=a.id});h.length==d.length&&(g.id=h.map(function(a){return a.id}).sort().reduce(function(a,b){return a+","+b}));g.lang=d[0].lang||"";g.contentType=d[0].contentType||"";g.b=d.some(function(a){return a.c});for(var h={},l=0;l<d.length;++l)for(var m=d[l],n=0;n<m.a.length;++n){var t=m.a[n],A=Te(a,t),O=g.a.slice(0);
Ue(A,O);0==O.length&&0<g.a.length||!(t=Ve(b,c,t,e,f))||(g.streamInfos.push(t),g.a=O,h[t.A]=m)}if(g.a.some(function(a){return""==a.a}))return g.streamInfos.forEach(function(a){a.J=!0}),g;a=We(d);for(l=0;l<g.streamInfos.length;++l)t=g.streamInfos[l],m=h[t.A],m==a&&(t.J=!0);return g}function We(a){for(var b=null,c=null,d=0;d<a.length;++d)for(var e=a[d],f=0;f<e.a.length;++f){var g=e.a[f],g=(g.width||1)*(g.height||1)*(g.bandwidth||1);if(null==b||g<b)b=g,c=e}return c}
function Ue(a,b){if(0==b.length)Array.prototype.push.apply(b,a);else for(var c=0;c<b.length;++c){for(var d=!1,e=0;e<a.length;++e){var f=b[c],g=a[e];if(f.a==g.a&&f.h==g.h&&f.i==g.i&&f.g==g.g&&f.j==g.j&&f.f==g.f&&f.l==g.l&&db(f.c,g.c)){d=!0;nc(b[c],a[e].b);break}}d||(b.splice(c,1),--c)}}function Te(a,b){var c=[];if(0==b.c.length)c.push(new kc);else if(a.a)for(var d=0;d<b.c.length;++d)c.push.apply(c,Xe(a,b.c[d]));return c}
function Xe(a,b){var c=[];if(2!=a.a.length)return[];var d=a.a(b.c||"",b.f);if(!(d&&d instanceof Array))return[];for(var e=0;e<d.length;++e){var f=lc(d[e]);0==f.b.length&&b.a&&b.a.psshBox&&nc(f,[{initData:b.a.psshBox,initDataType:"cenc"}]);c.push(f)}return c}
function Ve(a,b,c,d,e){if(!c.s||0===c.s.length)return null;var f=null,g=1,h=0;if(c.g)f=c.f.split("/")[1],"mp4"!=f&&"webm"!=f?f=null:(g=c.g,"webm"!=f||g.c?g.a||g.b&&g.b.a?(h=g.b,h||(h=new nd,h.url=c.s,h.a=g.a?g.a.clone():null),h=Ye(h,e),g=g.c?Ye(g.c,e):null,a=new Ne(a,b,f,h,g,d,e),b=new Vd(g),d=new te,d.segmentIndexSource=a,d.F=b,f=d):f=null:f=null),g=c.g.g,h=c.g.f;else if(c.b)f=c.b,!f.b&&!f.c&&1<f.a.length?f=null:f.b||b.a||f.c||1!=f.a.length?f.c&&0===f.c.a.length?f=null:(f=f.h?Ye(f.h,e):null,a=new qe(a,
b,c,d,e),b=new Vd(f),d=new te,d.segmentIndexSource=a,d.F=b,f=d):f=null,g=c.b.f,h=c.b.g;else if(c.a){a:if(f=c.a,g=0+(f.f?1:0),g+=f.c?1:0,g+=f.b?1:0,0==g?g=!1:(1!=g&&(f.f?(f.c=null,f.b=null):f.c&&(f.b=null)),g=!0),g){g=null;if(f.g&&(g=(f=c.a.g)?Ze(c,f,od):null,!g)){f=null;break a}f=g?Ye(g,e):null;g=c.a;g.f?(g=c.f.split("/")[1],"mp4"!=g&&"webm"!=g?a=null:"webm"!=g||f?Rd(e,c,1,0)?(h=(h=c.a.f)?Ze(c,h,nd):null)?(h=Ye(h,e),a=new Ne(a,b,g,h,f,d,e)):a=null:a=null:a=null):a=g.h?g.c?new re(a,b,c,d,e):g.b?"dynamic"!=
a.type&&null==b.a?null:new pe(a,b,c,d,e):null:null;a?(b=new Vd(f),d=new te,d.segmentIndexSource=a,d.F=b,f=d):f=null}else f=null;g=c.a.a;h=c.a.i}else"text"==c.f.split("/")[0]&&(f=new te,f.segmentIndexSource=new Ke(new G(e,c.s)));if(!f)return null;f.id=c.id;h&&(f.c=-1*h/g);f.bandwidth=c.bandwidth;f.width=c.width;f.height=c.height;f.a=c.f||"";f.b=c.h||"";for(a=0;a<c.c.length;++a)b=c.c[a],b.b&&f.f.push(b.b);return f}
function Ze(a,b,c){b=Td(b,a.id,null,a.bandwidth,null);if(!b)return null;c=new c;c.url=Md(a.s,b);return c}function Ye(a,b){var c=a.url,d=0,e=null;a.a&&(d=a.a.la,e=a.a.end);return new G(b,c,d,e)};function $e(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function af(a,b){var c=new bf(b);a.streamHistory.push(new cf(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}function bf(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.a;this.videoBandwidth=a.bandwidth}
function cf(a){this.timestamp=v()/1E3;this.value=a};function df(a,b){Hb.call(this,"readwrite",b);this.j=a;this.b=0}q(df,Hb);
function ef(a,b,c,d,e){for(var f=[],g=[],h=0,l=0,m=[],n=b.map(function(a){return a.segmentIndexSource.create()}),n=Promise.all(n),t=b.map(function(a){return a.F.create()}),t=Promise.all(t),n=Promise.all([n,t]).then(function(a){f=a[0];g=a[1];h=f.reduce(function(a,b){return a+b.length()},0)}),t=0;t<b.length;++t)n=n.then(function(a){return ff(this,b[a],f[a],g[a],h,l)}.bind(a,t)),n=n.then(function(a,b){l+=f[a].length();m.push(b)}.bind(a,t));return n.then(F(a,function(){return gf(Pb(this))})).then(F(a,
function(a){var b=new E;c=Ra(c);var f={group_id:a,stream_ids:m,session_ids:c,duration:d,key_system:e.a,license_server:e.h,with_credentials:e.i,distinctive_identifier:e.g,audio_robustness:e.f,video_robustness:e.l},g=Pb(this).put(f);g.onsuccess=function(){b.resolve(a)};g.onerror=function(){b.reject(g.error)};return b}))}function hf(a,b){return Qb(Pb(a),b).then(F(a,function(a){var d=[],e;for(e in a.stream_ids)d.push(jf(this,a.stream_ids[e]));a=Pb(this);d.push(a.delete(b));return Promise.all(d)}))}
function ff(a,b,c,d,e,f){var g=[gf(Ob(a)),gf(Lb(a).index("stream"))],g=Promise.all(g).then(F(a,function(a){return{pa:Math.max(a[0],a[1]),ha:new ArrayBuffer(0),Ia:0,references:[],Ba:null,Vb:e,gb:f}})),g=g.then(a.f.bind(a,c));return g=g.then(a.g.bind(a,b,d))}function gf(a){var b=new E,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}
df.prototype.g=function(a,b,c){var d=new E;a={stream_id:c.pa,mime_type:a.a,codecs:a.b,init_segment:b,references:c.references};var e=Ob(this).put(a);e.onsuccess=function(){d.resolve(c.pa)};e.onerror=function(){d.reject(e.error)};return d};
df.prototype.f=function(a,b){for(var c=Promise.resolve(),d=0;d<a.length();++d)var e=a.get(d),f=d==a.length()-1,f=this.c.bind(this,e,b,f),c=c.then(this.i.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b)}).catch(F(this,function(a){jf(this,b.pa);return Promise.reject(a)}))};
df.prototype.c=function(a,b,c,d){var e=new E;0==b.ha.byteLength&&(b.Ba=a);b.ha=kf(b.ha,d);b.gb++;var f=x({type:"progress",detail:b.gb/b.Vb*100,bubbles:!0});if(1048576<=b.ha.byteLength||c){c={stream_id:b.pa,segment_id:b.Ia,content:b.ha};var g=Lb(this).put(c);b.references.push({start_time:b.Ba.startTime,start_byte:b.Ba.url.oa,end_time:a.endTime,url:"idb://"+b.pa+"/"+b.Ia});b.Ia++;b.ha=new ArrayBuffer(0);g.onerror=function(){e.reject(g.error)};g.onsuccess=F(this,function(){this.dispatchEvent(f);e.resolve()})}else this.dispatchEvent(f),
e.resolve();return e};function kf(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}df.prototype.i=function(a){var b=new ac;b.c=1E3*this.b;return a.url.fetch(b,this.j)};
function jf(a,b){var c=new E,d=Ob(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=Lb(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c};function lf(a,b,c,d,e,f){this.b=new G(null,[new H(a)]);this.a=new ac;this.a.body=b;this.a.method=c;this.a.a=3;this.a.l=d;this.a.c=1E3*(null!=f?f:0);a=e||{};for(var g in a)this.a.b[g]=a[g]}function mf(a){return a.b.fetch(a.a).then(function(a){return Promise.resolve(new Uint8Array(a))})};function U(a,b,c){D.call(this,a);this.h=b;this.b=c;this.a=this.i=null;this.m=new B;this.c=[];this.f=[];this.o=0;this.g=new E;this.j=null;this.u=0}q(U,D);U.prototype.destroy=function(){this.l=null;for(var a=0;a<this.f.length;++a)this.f[a].close().catch(function(){});this.f=[];this.c=this.a=this.i=null;this.g.destroy();this.g=null;this.m.destroy();this.m=null;this.j&&(window.clearTimeout(this.j),this.j=null);this.h=this.b=null};
U.prototype.initialize=function(){for(var a=new z,b=this.b.Za(),c=0;c<b.length;++c){var d=b[c];d.a.a||d.b&&!nf(d.b)||a.push(d.contentType,d)}for(var c={},d=!1,e=0;e<b.length;++e){var f=b[e];if(f.a.a&&!a.a.hasOwnProperty(f.contentType)){var g=f.a.a,h=c[g];h||(h=f.a,h={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:h.g?"required":"optional",persistentState:h.j||this.b.fa()?"required":"optional",sessionTypes:[this.b.fa()?"persistent-license":"temporary"]},
c[g]=h);if(f.b&&(g=f.contentType+"Capabilities",g in h)){d=!0;h[g]||(h[g]=[]);var l;"audio"==f.contentType?l=f.a.f:"video"==f.contentType&&(l=f.a.l);h[g].push({contentType:f.b,robustness:l})}}}if(!d)if(b.length)this.a=b[0].a;else throw a=Error("No DrmInfo exists!"),a.type="drm",a;if(0==Object.keys(c).length)return this.b.Ja(a),this.g.resolve(),Promise.resolve();l=new E;c=of(this,c,l);c=c.then(this.B.bind(this,b,a));l.reject(null);return c};
function pf(a,b){null==a.j&&(a.j=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.g.reject(a)}.bind(a),b));return a.g}function qf(a){return Promise.all(a.f.map(function(a){return a.remove()}))}
function of(a,b,c){for(var d in b)c=c.catch(function(a,b){return navigator.requestMediaKeySystemAccess(a,[b])}.bind(null,d,b[d]));a.b.fa()&&(c=c.catch(function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.");}));return c}
U.prototype.B=function(a,b,c){if(!this.h)return rf();for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.a.hasOwnProperty(h)){var l=e[h+"Capabilities"];if(l){for(var l=l[0],m=[],n={},t=0;t<a.length;++t){var A=a[t],O=l?A.b==l.contentType:A.contentType==h;A.a.a!=d||!O||A.id in n||(m.push(A),n[A.id]=!0,this.a=this.a?mc(this.a,A.a):A.a)}b.set(h,m)}}}this.b.Ja(b);return c.createMediaKeys().then(function(a){this.i=a}.bind(this))};
function sf(a){return a.h?a.i?a.h.setMediaKeys(a.i).then(F(a,function(){return this.h?this.a.c?this.i.setServerCertificate(this.a.c):Promise.resolve():rf()})).then(F(a,function(){if(!this.h)return rf();if(0<this.b.ua().length)tf(this);else{for(var a=0;a<this.a.b.length;++a){var c=this.a.b[a];this.w({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.a.b.length&&C(this.m,this.h,"encrypted",this.w.bind(this))}})):Promise.resolve():rf()}
function rf(){var a=Error("EmeManager destroyed");a.type="destroy";return Promise.reject(a)}
U.prototype.w=function(a){for(var b=new Uint8Array(a.initData),c=0;c<this.c.length;++c)if(db(b,this.c[c].data))return;try{var d=uf(this)}catch(e){b=y(e);this.dispatchEvent(b);this.g.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.c.push({data:b,Ka:d});a.catch(F(this,function(a){if(this.h){for(var b=0;b<this.c.length;++b)if(this.c[b].Ka==d){this.c.splice(b,1);break}b=y(a);this.dispatchEvent(b);this.g.reject(a)}}));this.f.push(d)};
function tf(a){for(var b=a.b.ua(),c=0;c<b.length;++c){var d=uf(a),e=d.load(b[c]);a.f.push(d);e.then(F(a,function(){this.o++;this.o>=this.f.length&&this.g.resolve()})).catch(F(a,function(a){a=y(a);this.dispatchEvent(a)}))}}
function uf(a){var b=null;if(a.b.fa())try{b=a.i.createSession("persistent-license")}catch(c){throw Error("Persistent licenses are not supported by this key system or platform.");}else b=a.i.createSession();C(a.m,b,"message",a.D.bind(a));C(a.m,b,"keystatuseschange",a.C.bind(a));return b}U.prototype.D=function(a){vf(this,a.target,this.a,a.message)};
U.prototype.C=function(a){a=a.target;var b={};a.keyStatuses.forEach(function(a,c){if("string"==typeof a){var f=a;a=c;c=f}if("com.microsoft.playready"==this.a.a&&16==a.byteLength){var f=new DataView(a),g=f.getUint32(0,!0),h=f.getUint16(4,!0),l=f.getUint16(6,!0);f.setUint32(0,g,!1);f.setUint16(4,h,!1);f.setUint16(6,l,!1)}f=jc(new Uint8Array(a));b[f]=c}.bind(this));if(a.expiration<Date.now()){for(var c=0;c<this.c.length;++c)if(this.c[c].Ka==a){this.c.splice(c,1);break}a.close();this.f.splice(this.f.indexOf(a),
1)}this.b.ab(b)};function vf(a,b,c,d){d=wf(c,d);mf(new lf(d.url,d.body,d.method,c.i,d.headers,a.u)).then(F(a,function(a){c.m&&(a=c.m(a));return b.update(a)})).then(F(a,function(){var a=x({type:"sessionReady",detail:b});this.dispatchEvent(a);this.o++;this.o>=this.f.length&&this.g.resolve()})).catch(F(a,function(a){a.Ka=b;a=y(a);this.dispatchEvent(a)}))}
function wf(a,b){var c={url:a.h,body:b.slice(0),method:"POST",headers:{}};if("com.microsoft.playready"===a.a){for(var d=String.fromCharCode.apply(null,new Uint16Array(c.body)),d=(new DOMParser).parseFromString(d,"application/xml"),e=d.getElementsByTagName("name"),f=d.getElementsByTagName("value"),g=0;g<e.length;g++)c.headers[e[g].childNodes[0].nodeValue]=f[g].childNodes[0].nodeValue;c.body=window.atob(d.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue)}if(!a.o)return c;a.o(c);c.url=tb(c,
"url");if(null==c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer||"string"==typeof c.body||null==c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method=tb(c,"method");if("GET"!=c.method&&"POST"!=c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers=ub(c,"headers",Object);if(null==c.headers)throw Error("'headers' cannot be null.");return c};function V(a){D.call(this,null);this.a=a;this.b=null;this.f=new B;this.j=this.i=null;this.B=0;this.u=null;this.h=!1;this.g=new $e;this.c={enableAdaptation:!0,streamBufferSize:15,liveStreamEndTimeout:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new ja};this.m=1;this.C=null}q(V,D);p("shaka.player.Player",V);V.version="v1.6.5-hola-2-4-gb56db77-dirty";
V.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!window.Uint8Array};function nf(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}V.isTypeSupported=nf;
V.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b));for(b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+oa(a)+" }",0)};V.prototype.destroy=function(){return this.o().then(F(this,function(){this.f.destroy();this.a=this.f=null})).catch(function(){})};V.prototype.destroy=V.prototype.destroy;
V.prototype.o=function(){if(!this.b)return Promise.resolve();this.h&&xf(this);this.a.pause();yb(this.f);yf(this);zf(this);this.i&&(this.i.destroy(),this.i=null);this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.h=!1;this.g=new $e;return a};V.prototype.unload=V.prototype.o;V.prototype.P=function(){return this.a};V.prototype.getVideo=V.prototype.P;V.prototype.R=function(){return this.b};V.prototype.getVideoSource=V.prototype.R;
V.prototype.N=function(a){var b=this.o();this.a.autoplay&&(da("load"),C(this.f,this.a,"timeupdate",this.wb.bind(this)));a.P(this.c);a.nb(this.C);this.C=null;b=b.then(F(this,function(){return a.V()}));b.catch(F(this,function(b){a.destroy();return Promise.reject(b)}));return b.then(F(this,function(){if(!this.a)return Af();this.b=a;C(this.f,this.b,"seekrangechanged",this.Fb.bind(this));this.i=new U(this,this.a,this.b);return this.i.initialize()})).then(F(this,function(){if(!this.a)return Af();C(this.f,
this.a,"error",this.Rb.bind(this));C(this.f,this.a,"playing",this.Db.bind(this));C(this.f,this.a,"pause",this.Cb.bind(this));var a=this.b.jb(this,this.a);jb("shaka_message",{id:"attach",Yb:this,video:this.a});return a})).then(F(this,function(){return this.a?sf(this.i):Af()})).then(F(this,function(){if(!this.a)return Af();Cf(this)})).catch(F(this,function(a){if(!this.a)return Af();if("destroy"!=a.type){var b=y(a);this.dispatchEvent(b)}return this.o().then(function(){return Promise.reject(a)})}))};
V.prototype.load=V.prototype.N;function Af(){var a=Error("Player destroyed");a.type="destroy";return Promise.reject(a)}k=V.prototype;k.wb=function(){ga("load");this.g.playbackLatency=ha("load")/1E3;this.f.ra(this.a,"timeupdate")};k.Rb=function(){if(this.a.error){var a=this.a.error.code;a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(Df[a]||"Unknown playback error."),a.type="playback",a=y(a),this.dispatchEvent(a))}};
k.Db=function(){da("playing");!this.j&&0>this.m&&(this.a.playbackRate=0,this.w(this.a.currentTime,Date.now(),this.m));this.h&&xf(this)};k.Cb=function(){ga("playing");var a=ha("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3}zf(this)};k.Fb=function(a){this.B=a.start};
k.ob=function(){if(!this.a.paused){ga("playing");var a=ha("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3;da("playing")}}a=this.g;b=this.a;b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.g};V.prototype.getStats=V.prototype.ob;V.prototype.da=function(){return this.b?this.b.ka():[]};V.prototype.getVideoTracks=V.prototype.da;V.prototype.ba=function(){return this.b?this.b.na():[]};
V.prototype.getAudioTracks=V.prototype.ba;V.prototype.I=function(){return this.b?this.b.Na():[]};V.prototype.getTextTracks=V.prototype.I;V.prototype.selectVideoTrack=function(a,b){return this.b?this.b.selectVideoTrack(a,void 0==b?!0:b):!1};V.prototype.selectVideoTrack=V.prototype.selectVideoTrack;V.prototype.T=function(a,b,c){return this.b?this.b.lb(a,void 0==b?!0:b,c):!1};V.prototype.selectAudioTrack=V.prototype.T;V.prototype.sa=function(a){return this.b?this.b.mb(a,!1):!1};
V.prototype.selectTextTrack=V.prototype.sa;V.prototype.Y=function(a){this.b&&this.b.Ma(a)};V.prototype.enableTextTrack=V.prototype.Y;V.prototype.W=function(a){zf(this);0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.w(this.a.currentTime,Date.now(),a));this.m=a};V.prototype.setPlaybackRate=V.prototype.W;V.prototype.H=function(){return this.m};V.prototype.getPlaybackRate=V.prototype.H;V.prototype.ea=function(a){this.C=a};V.prototype.setPlaybackStartTime=V.prototype.ea;
V.prototype.D=function(){return this.b?this.b.kb():!1};V.prototype.isLive=V.prototype.D;
V.prototype.X=function(a){if(a){var b=qb(a,"enableAdaptation");null!=b&&(this.c.enableAdaptation=b);b=sb(a,"streamBufferSize");null!=b&&(this.c.streamBufferSize=b);b=sb(a,"liveStreamEndTimeout");null!=b&&(this.c.liveStreamEndTimeout=b);b=sb(a,"licenseRequestTimeout");null!=b&&(this.c.licenseRequestTimeout=b);b=sb(a,"mpdRequestTimeout");null!=b&&(this.c.mpdRequestTimeout=b);b=sb(a,"segmentRequestTimeout");null!=b&&(this.c.segmentRequestTimeout=b);b=tb(a,"preferredLanguage");null!=b&&(this.c.preferredLanguage=
b);b=ub(a,"restrictions",ja);null!=b&&(this.c.restrictions=b.clone());a=qb(a,"disableCacheBustingEvenThoughItMayAffectBandwidthEstimation");null!=a&&(Gd=!a);this.b&&this.b.P(this.c)}};V.prototype.configure=V.prototype.X;V.prototype.ca=function(){return this.c};V.prototype.getConfiguration=V.prototype.ca;function zf(a){a.j&&(window.clearTimeout(a.j),a.j=null)}function Cf(a){yf(a);a.u=window.setTimeout(a.S.bind(a),100)}function yf(a){a.u&&(window.clearTimeout(a.u),a.u=null)}
V.prototype.w=function(a,b,c){this.j=null;var d=(Date.now()-b)/1E3*c;this.a.currentTime<this.B+(this.D()?1:.05)?this.a.pause():(d=Math.max(this.B,a+d),this.a.currentTime=d,this.j=window.setTimeout(this.w.bind(this,a,b,c),250))};function xf(a){ga("buffering");var b=a.g;b.bufferingTime+=ha("buffering")/1E3;a.h=!1;a.dispatchEvent(x({type:"bufferingEnd"}))}
V.prototype.S=function(){Cf(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0),c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;if(this.h){if(c=this.b.Ya(),b||a>c)xf(this),this.a.play()}else!this.a.paused&&!b&&.5>a&&(this.h=!0,this.a.pause(),this.g.bufferingHistory.push(v()/1E3),da("buffering"),this.dispatchEvent(x({type:"bufferingStart"})))}};
var Df={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function Ef(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.streamSetInfos.length;++d){for(var e=c.streamSetInfos[d],f=e,g=0;g<f.streamInfos.length;++g)nf(ve(f.streamInfos[g]))||(f.streamInfos.splice(g,1),--g);0==e.streamInfos.length&&(c.streamSetInfos.splice(d,1),--d)}}function Ff(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.streamSetInfos.length;++d)c.streamSetInfos[d].streamInfos.sort(Gf)}
function Gf(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function Hf(a){this.a=a}Hf.prototype.destroy=function(){this.a.destroy();this.a=null};Hf.prototype.update=function(a){var b=If(a),c=If(this.a);return Promise.all([b,c]).then(F(this,function(b){var c=b[0];b=b[1];var f=this.a.periodInfos;Ef(f);Ff(f);a.c=this.a.c;a.f=this.a.f?this.a.f.clone():null;a.b=this.a.b;f=[];Jf(a,this.a,c,b,f);c=a.periodInfos;Ef(c);Ff(c);return Promise.resolve(f)}))};
function If(a){function b(a,b){return a.concat(b)}var c=a.periodInfos.map(function(a){return a.streamSetInfos}).reduce(b,[]).map(function(a){return a.streamInfos}).reduce(b,[]);a=c.map(function(a){return a.segmentIndexSource.create()});return Promise.all(a).then(function(a){for(var b={},f=0;f<c.length;++f)b[c[f].A]=a[f];return Promise.resolve(b)})}
function Jf(a,b,c,d,e){var f=new z;a.periodInfos.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new z;b.periodInfos.forEach(function(a,b){g.push(a.id||""+b,a)});a=xb(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&(Kf(l[0],h[0],c,d,e),l[0].a=h[0].a)}}
function Kf(a,b,c,d,e){var f=new z;a.streamSetInfos.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new z;b.streamSetInfos.forEach(function(a,b){g.push(a.id||""+b,a)});a=xb(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&Lf(l[0],h[0],c,d,e)}}
function Lf(a,b,c,d,e){var f=new z;a.streamInfos.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new z;b.streamInfos.forEach(function(a,b){g.push(a.id||""+b,a)});b={};for(var h=xb(f),l=0;l<h.length;++l){var m=h[l];b[m]=m;var n=f.get(m);1<n.length||((m=g.get(m))&&0!=m.length?1==m.length&&(Mf(n[0],m[0],c,d),n[0].F=m[0].F,m[0].F=null,n[0].c=m[0].c):(e.push(n[0]),a.streamInfos.splice(a.streamInfos.indexOf(n[0]),1)))}h=xb(g);for(l=0;l<h.length;++l)m=h[l],b[m]||(b[m]=m,m=g.get(m),a.streamInfos.push(m[0]))}
function Mf(a,b,c,d){a=c[a.A];b=d[b.A];a.length();a.Ga(b)&&a.length()};function W(){this.a=this.b=null;this.f=new B;this.c=Number.POSITIVE_INFINITY;this.i=!0;this.g=!1}p("shaka.media.SimpleAbrManager",W);W.prototype.destroy=function(){this.f.destroy();this.a=this.b=this.f=null};W.prototype.initialize=function(a,b){this.b||this.a||(this.b=a,this.a=b)};
W.prototype.start=function(){this.b&&this.a&&!this.g&&(this.c=Date.now()+4E3,C(this.f,this.b,"bandwidth",this.j.bind(this)),C(this.f,this.a,"adaptation",this.l.bind(this)),C(this.f,this.a,"trackschanged",this.h.bind(this)),this.g=!0)};W.prototype.enable=function(a){this.i=a};W.prototype.getInitialVideoTrackId=function(){if(!this.b||!this.a)return null;var a=Nf(this);return a?a.id:null};W.prototype.selectVideoTrack=function(a,b,c){this.g&&this.a.selectVideoTrack(a.id,b,c)};
W.prototype.j=function(){Date.now()<this.c||this.h()};W.prototype.h=function(){if(this.i){var a=Nf(this);if(a){if(a.active){this.c=Date.now()+3E3;return}this.selectVideoTrack(a,!1)}this.c=Number.POSITIVE_INFINITY}};W.prototype.l=function(){this.c==Number.POSITIVE_INFINITY&&(this.c=Date.now()+3E4)};
function Nf(a){var b=a.a.ka();if(0==b.length)return null;b.sort(sa);var c;a:{c=a.a.na();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.b.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function Of(a,b,c){D.call(this,null);this.f=a;this.c=b;this.b=lc(c);this.a=null}q(Of,D);p("shaka.player.HttpVideoSource",Of);Of.prototype.P=function(){};Of.prototype.destroy=function(){this.a&&(this.a.parentElement.removeChild(this.a),this.a=null);this.l=this.b=null};k=Of.prototype;k.jb=function(a,b){this.l=a;var c=b.mediaKeys;b.src=this.f;c=b.setMediaKeys(c);this.c&&(this.a=document.createElement("track"),this.a.src=this.c,b.appendChild(this.a),this.a.track.mode="showing");return c};k.V=function(){return Promise.resolve()};
k.ka=function(){return[]};k.na=function(){return[]};k.Na=function(){return[]};k.Ya=function(){return 5};k.Za=function(){var a=new ze;a.a=this.b;return[a]};k.Ja=function(){};Of.prototype.selectVideoTrack=function(){return!1};k=Of.prototype;k.lb=function(){return!1};k.mb=function(){return!1};k.Ma=function(a){this.a&&(this.a.track.mode=a?"showing":"disabled")};k.nb=function(){};k.ua=function(){return[]};k.fa=function(){return!1};k.kb=function(){return!1};
k.ab=function(a){for(var b in a){var c=a[b],d=gb[c]||null;if(d){var e=Cb(b),d=Error("Key "+e+" is not usable. "+d);d.type="drm";d.code=c;c=y(d);this.dispatchEvent(c)}}};function X(a,b,c){D.call(this,null);this.a=a;this.X=b;this.h=new B;this.f=new MediaSource;this.video=null;this.ba=0;this.b=new z;this.C=c;this.C.initialize(b,this);this.H=!1;this.D="en";this.da=!1;this.R=null;this.u=new E;this.g=new ja;this.w=null;this.Ta=1;this.c={};this.ca=new E;this.Ra=0;this.Sa=15;this.o=null;this.sa=this.Qa=!1;this.m={};this.Y=this.W=this.S=null;this.B={}}q(X,D);p("shaka.player.StreamVideoSource",X);
X.prototype.P=function(a){null!=a.streamBufferSize&&(this.B.streamBufferSize=a.streamBufferSize);null!=a.segmentRequestTimeout&&(this.B.segmentRequestTimeout=a.segmentRequestTimeout);Pf(this);null!=a.enableAdaptation&&this.C.enable(Boolean(a.enableAdaptation));null!=a.mpdRequestTimeout&&(this.ba=Number(a.mpdRequestTimeout));null!=a.liveStreamEndTimeout&&(this.Sa=Number(a.liveStreamEndTimeout));null!=a.preferredLanguage&&(this.D=lb(String(a.preferredLanguage)));null!=a.restrictions&&(this.g=a.restrictions,
this.H&&Qf(this))};X.prototype.destroy=function(){this.u.destroy();this.ca.destroy();this.ca=this.u=null;this.W&&(window.clearTimeout(this.W),this.W=null);this.S&&(window.clearTimeout(this.S),this.S=null);this.m=null;this.h.destroy();this.h=null;pb(this.c).forEach(function(a){a.destroy()});this.b=this.c=null;this.a&&(this.a.destroy(),this.a=null);this.C.destroy();this.f=this.X=this.C=null;this.video&&(delete this.video.shaka,this.video=null);this.l=this.g=this.R=null};k=X.prototype;
k.jb=function(a,b){if(!this.H){var c=Error("Cannot call attach() right now.");c.type="app";return Promise.reject(c)}this.l=a;this.video=b;this.video.shaka=a;this.R=a.ob();C(this.h,this.f,"sourceopen",this.yb.bind(this));C(this.h,this.X,"bandwidth",this.Sb.bind(this));this.a.a&&(C(this.h,a,"bufferingStart",this.vb.bind(this)),C(this.h,a,"bufferingEnd",this.ub.bind(this)));c=this.video.mediaKeys;this.video.src=window.URL.createObjectURL(this.f);c=this.video.setMediaKeys(c);return Promise.all([this.u,
c])};
k.V=function(){if(this.H){var a=Error("Cannot call load() right now.");a.type="app";return Promise.reject(a)}if(!this.a||0==this.a.periodInfos.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);a=this.a.periodInfos;Ef(a);Ff(a);if(0==this.a.periodInfos.length||0==this.a.periodInfos[0].streamSetInfos.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.H=!0;
this.B.initialStreamBufferSize=this.a.b;Pf(this);Qf(this);return Promise.resolve()};
k.eb=function(a){var b=Date.now(),c=this.S=null,d=this.a.f;(a?this.bb():this.cb(d)).then(F(this,function(a){c=new Hf(a);return c.update(this.a)})).then(F(this,function(a){c.destroy();c=null;for(var d=0;d<a.length;++d)Rf(this,a[d]);this.B.initialStreamBufferSize=this.a.b;Pf(this);Qf(this);0==Object.keys(this.c).length?Sf(this):Tf(this,(Date.now()-b)/1E3)})).catch(F(this,function(a){c&&(c.destroy(),c=null);"aborted"!=a.type&&(a=y(a),this.dispatchEvent(a),this.a&&Tf(this,0))}))};k.cb=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};
k.bb=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};function Tf(a,b){if(null!=a.a.c){var c=Math.max(a.a.c,3),c=Math.max(c-b,0);a.S=window.setTimeout(a.eb.bind(a,!1),1E3*c)}}
function Rf(a,b){var c=b.a.split("/")[0],d=a.c[c];if(d&&d.ma()==b){var e=a.b.get(b.a.split("/")[0]).map(function(a){return a.streamInfos}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return a.J&&a.G});if(0==e.length){c=Error("All usable streams have been removed from the manifest.");c.type="app";c=y(c);a.dispatchEvent(c);return}a.m[c].Oa==b&&delete a.m[c];d.qa(e[0],!0);b.destroy()}b.destroy()}
k.ka=function(){if(!this.b.a.hasOwnProperty("video"))return[];for(var a=this.c.video,a=(a=a?a.ma():null)?a.A:0,b=[],c=this.b.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.streamInfos.length;++f){var g=e.streamInfos[f];if(g.J&&g.G){var h=g.A,g=new ra(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};X.prototype.getVideoTracks=X.prototype.ka;
X.prototype.na=function(){if(!this.b.a.hasOwnProperty("audio"))return[];for(var a=this.c.audio,a=(a=a?a.ma():null)?a.A:0,b=[],c=this.b.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.streamInfos.length;++g){var h=e.streamInfos[g];if(h.J&&h.G){var l=h.A,h=new ia(l,h.bandwidth,f);l==a&&(h.active=!0);b.push(h)}}return b};X.prototype.getAudioTracks=X.prototype.na;
X.prototype.Na=function(){if(!this.b.a.hasOwnProperty("text"))return[];for(var a=this.c.text,b=a?a.ma():null,b=b?b.A:0,c=[],d=this.b.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.streamInfos.length;++h){var l=f.streamInfos[h].A,m=new qa(l,g);l==b&&(m.active=!0,m.enabled=a.Ca());c.push(m)}return c};X.prototype.getTextTracks=X.prototype.Na;X.prototype.Ya=function(){return Number(this.B.initialStreamBufferSize)};
X.prototype.Za=function(){var a;if(this.H){a=this.a.periodInfos[0];for(var b=[],c=0;c<a.streamSetInfos.length;++c)b.push.apply(b,ye(a.streamSetInfos[c]));a=b}else a=[];return a};
X.prototype.Ja=function(a){if(this.H){for(var b={},c=this.a.periodInfos[0],d=0;d<c.streamSetInfos.length;++d){var e=c.streamSetInfos[d];b[e.A]=e}this.b.a={};c=xb(a);for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.b.push(e,b[g])}else if("audio"==e)for(var g=f[0].b.split(";")[0],h=0;h<f.length;++h){var l=f[h];l.b.split(";")[0]==g&&this.b.push(e,b[l.id])}else for(h=0;h<f.length;++h)g=f[h].id,this.b.push(e,b[g])}this.da=!0;if(a=this.b.get("audio"))Uf(this,a),this.b.set("audio",
a),a=a[0].lang||this.D,kb(2,this.D,a)&&(this.da=!1);if(a=this.b.get("text"))Uf(this,a),this.b.set("text",a),a=a[0].lang||this.D,kb(2,this.D,a)||(this.da=!1)}};X.prototype.selectVideoTrack=function(a,b,c){return Vf(this,"video",a,b,c)};k=X.prototype;k.lb=function(a,b,c){return Vf(this,"audio",a,b,c)};k.mb=function(a,b){return Vf(this,"text",a,b)};k.Ma=function(a){var b=this.c.text;b&&b.va(a)};k.nb=function(a){this.Y=a};
function Qf(a){if(a.g){for(var b=!1,c=0;c<a.a.periodInfos.length;++c)for(var d=a.a.periodInfos[c],e=0;e<d.streamSetInfos.length;++e){var f=d.streamSetInfos[e];if("video"==f.contentType)for(var g=0;g<f.streamInfos.length;++g){var h=f.streamInfos[g],l=h.G;h.G=!0;a.g.maxWidth&&h.width>a.g.maxWidth&&(h.G=!1);a.g.maxHeight&&h.height>a.g.maxHeight&&(h.G=!1);a.g.minHeight&&h.height<a.g.minHeight&&(h.G=!1);a.g.maxBandwidth&&h.bandwidth>a.g.maxBandwidth&&(h.G=!1);a.g.minBandwidth&&h.bandwidth<a.g.minBandwidth&&
(h.G=!1);l!=h.G&&(b=!0)}}0!=vb(a.b).length&&b&&(Wf(a),0<a.ka().length||(b=Error("The application has restricted all video tracks!"),b.type="app",b=y(b),a.dispatchEvent(b)))}}k.ua=function(){return[]};k.fa=function(){return!1};k.kb=function(){return this.a?this.a.a:!1};
k.ab=function(a){for(var b,c=!1,d=new z,e=vb(this.b),f=0;f<e.length;++f)for(var g=e[f],h=0;h<g.streamInfos.length;++h){var l=g.streamInfos[h];l.f.forEach(function(a){d.push(a,l)})}for(b in a)if(e=gb[a[b]]||null,g=d.get(b))for(f=0;f<g.length;++f)l=g[f],h=l.J,l.J=!e,h!=l.J&&(c=!0);else Cb(b);c&&(Wf(this),b=this.na(),a=this.ka(),b=this.b.a.hasOwnProperty("audio")&&0==b.length,a=this.b.a.hasOwnProperty("video")&&0==a.length,b||a)&&(a=Error("The key system has restricted all "+(b&&a?"audio and video tracks.":
b?"audio tracks.":"video tracks.")),a.type="drm",a=y(a),this.dispatchEvent(a))};function Wf(a){var b=x({type:"trackschanged",bubbles:!0});a.dispatchEvent(b)}
function Vf(a,b,c,d,e){if(!a.b.a.hasOwnProperty(b)||!a.c[b])return!1;for(var f=a.b.get(b),g=0;g<f.length;++g)for(var h=f[g],l=0;l<h.streamInfos.length;++l){var m=h.streamInfos[l];if(m.A==c){if(!m.J||!m.G)return!1;if("text"!=b&&!a.sa)return c=a.m[b],a.m[b]={Oa:m,Ua:null!=c&&c.Ua||d,Va:null!=c&&c.Va||e},!0;af(a.R,m);a.c[b].qa(m,d,e);return!0}}return!1}
function Uf(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(kb(c,a.D,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.b){b.splice(d,1);b.splice(0,0,e);break}}k.yb=function(){this.h.ra(this.f,"sourceopen");Sf(this).then(F(this,function(){this.u&&this.u.resolve()})).catch(F(this,function(a){this.u&&this.u.reject(a)}))};
function Sf(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.b.a.hasOwnProperty(e)&&b.push(a.b.get(e)[0])}for(var f=Xf(a,b),d=0;d<c.length;++d)if(e=c[d],a.b.a.hasOwnProperty(e)&&!f[e])return a=Error("Unable to select an initial "+e+" stream: all "+e+" streams have been restricted (by the application or by the key system)."),a.type="stream",Promise.reject(a);b=pb(f).map(function(a){return a.segmentIndexSource.create()});return Promise.all(b).then(F(a,function(a){if(!a.every(function(a){return a.length()}))return a=
Error("Some streams are not available."),a.type="stream",Promise.reject(a);a=Yf(this,a);if(!a)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!Zf(this,f))return a=Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a);this.C.start();$f(this,f,a);return Promise.resolve()})).catch(F(a,function(a){if("aborted"!=a.type)return Object.keys(this.c),this.a.a?(v()<this.a.g?(a=Math.max(this.a.g-Date.now()/1E3,3),this.S=window.setTimeout(this.eb.bind(this,
!0),1E3*a)):Tf(this,0),Promise.resolve()):Promise.reject(a)}))}
function Xf(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=null;if("video"==e.contentType){var g=a.C.getInitialVideoTrackId();if(null==g)continue;f=e.streamInfos.filter(function(a){return a.A==g});if(0==f.length)continue;f=f[0]}else if("audio"==e.contentType){f=e.streamInfos.filter(function(a){return a.J&&a.G});if(0==f.length)continue;f=e.streamInfos[Math.floor(f.length/2)]}else 0<e.streamInfos.length&&(f=e.streamInfos[0]);c[e.contentType]=f}return c}
function Zf(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new Le(a,a.video):ag(a,e);if(!e)return pb(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.c=c;return!0}function ag(a,b){var c=new Ce(a,a.video,a.f,ve(b),a.X);c.C(a.B);return c}
function $f(a,b,c){a.Ta=a.video.playbackRate;a.video.playbackRate=0;bg(a,c);var d;a.Y&&a.Y<=c.end&&a.Y>=c.start?d=a.Y:a.a.a?(d=c.end,a.Qa=!0):d=c.start;C(a.h,a.video,"seeking",a.Gb.bind(a));a.video.currentTime!=d&&(a.video.currentTime=d,a.w=d);cg(a,c.start,c.end);c=[];for(var e in a.c){d=a.c[e];c.push(d.qb(a.ca));C(a.h,d,"ended",a.Hb.bind(a));var f=b[e];af(a.R,f);d.qa(f,!1)}Promise.all(c).then(a.tb.bind(a)).catch(F(a,function(a){"destroy"!=a.type&&(a=y(a),this.dispatchEvent(a))}));a.Ma(a.da)}
k.tb=function(a){ba(a&&a.length==Object.keys(this.c).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d<a.length;++d)var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a=dg(this);for(d=0;d<a.length;++d)a[d].ia(c);eg(this,a,c);d=vb(this.b).map(function(a){return a.streamInfos}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.segmentIndexSource.create()];a.F&&b.push(a.F.create());return Promise.all(b)});Promise.all(d).then(F(this,function(a){for(var b=0;b<a.length;++b)a[b][0].ia(c);
this.sa=!0;for(var d in this.m)a=this.m[d],b=this.c[d],af(this.R,a.Oa),b.qa(a.Oa,a.Ua,a.Va);this.m={}})).catch(F(this,function(a){"aborted"!=a.type&&(a=y(a),this.dispatchEvent(a))}))};function eg(a,b,c){if(b=Yf(a,b))bg(a,b),cg(a,b.start,b.end);0!=c&&(c=a.video.currentTime+c,a.video.currentTime=c,a.w=c);a.Qa&&b&&(a.video.currentTime=b.end);a.video.playbackRate=a.Ta;a.a.a&&null!=a.a.c&&Tf(a,0);fg(a);a.ca.resolve()}
function bg(a,b){if(a.a.a)isNaN(a.f.duration)&&(a.f.duration=b.end+2592E3);else if(isNaN(a.f.duration)||b.end>a.f.duration){a.f.duration=b.end;for(var c=0;c<a.f.sourceBuffers.length;++c)a.f.sourceBuffers[c].appendWindowEnd=b.end}}k.Jb=function(){this.W=null;fg(this);var a=Yf(this,dg(this));a&&(this.a.a&&this.Ra!=a.v&&(this.Ra=a.v,null!=this.o&&(window.clearTimeout(this.o),this.o=null)),cg(this,a.start,a.end),this.video.paused||gg(this,this.video.currentTime,a.start,a.end))};
function cg(a,b,c){b=x({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b)}k.Gb=function(){var a=this.video.currentTime;if(null!=this.w){if(a>=this.w-.01&&a<=this.w+.01){this.w=null;return}this.w=null}var b=Yf(this,dg(this));if(b){var c=b.end;(b=gg(this,a,b.start,c))||(a<=c+.01?b=!1:(this.video.currentTime=c,b=!0));if(!b)for(var d in this.c)this.c[d].hb()}};
function gg(a,b,c,d){if(b>=c-.01)return!1;b=0;if(a.a.a){b=.5;for(var e in a.c)if(!a.c[e].ib(c+b)){b=a.a.b;break}}a.video.currentTime=Math.min(c+b,d);return!0}k.Hb=function(){if(!this.a.a){for(var a in this.c)if(!this.c[a].Fa())return;this.Xa()}};k.vb=function(){pb(this.c).every(function(a){return a.Fa()})&&(this.o=window.setTimeout(this.Xa.bind(this),1E3*this.Sa))};k.ub=function(){null!=this.o&&(window.clearTimeout(this.o),this.o=null)};
k.Sb=function(){var a=this.R,b=this.X.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new cf(b))};k.Xa=function(){this.o=null;this.f.endOfStream()};function dg(a){return pb(a.c).map(function(a){return a.$a()}).filter(function(a){return null!=a})}
function Yf(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,f=0;f<b.length;++f){var g=b[f].Da(),c=Math.max(c,g.start);null!=g.end&&(d=Math.min(d,g.end));b[f].length()&&(e=Math.min(e,b[f].v().endTime))}if(d==Number.POSITIVE_INFINITY)if(d=a.a.periodInfos[0],d.a)d=(d.start||0)+d.a;else return null;a.a.a&&(d=Math.max(d-a.a.b,c));return c>d?null:{start:c,end:d,v:e}}function fg(a){a.a.a&&(a.W=window.setTimeout(a.Jb.bind(a),1E3))}function Pf(a){for(var b in a.c)a.c[b].C(a.B)};function Y(a,b,c,d){c||(c=new Bb);d||(d=new W);X.call(this,null,c,d);this.ta=a;this.j=null;this.I=b;this.N=[];this.T=[];this.ea=[];this.i=null}q(Y,X);p("shaka.player.DashVideoSource",Y);Y.prototype.za=function(){return this.ta};Y.prototype.getUrl=Y.prototype.za;Y.prototype.ya=function(){return this.a};Y.prototype.getManifestInfo=Y.prototype.ya;Y.prototype.rb=function(a,b,c){this.N.push(a);this.T.push(b||"");this.ea.push(c||"")};Y.prototype.addExternalCaptions=Y.prototype.rb;
Y.prototype.sb=function(a){this.i=a};Y.prototype.setNetworkCallback=Y.prototype.sb;Y.prototype.destroy=function(){this.j=this.i=this.I=null;X.prototype.destroy.call(this)};
Y.prototype.V=function(){var a=new G(this.i,[new H(this.ta)]);return Pd(new Od(a,this.ba)).then(F(this,function(a){this.j=a;for(var c=0;c<this.N.length;c++){var d=a,e=this.N[c],f=this.T[c],g=this.ea[c];if(0!==d.a.length){var h=new dd;h.contentType="text";h.lang=f||"en";h.c=!0;f=new gd;f.bandwidth=0;f.f=g||"text/vtt";f.s=[new H(e)];h.a.push(f);d.a[0].b.push(h);zd(d.a[0])}}this.a=Pe(new Oe(this.I),a,this.i);return X.prototype.V.call(this)}))};
Y.prototype.cb=function(a){return Pd(new Od(a,this.ba)).then(F(this,function(a){this.j=a;a=Pe(new Oe(this.I),a,this.i);return Promise.resolve(a)}))};Y.prototype.bb=function(){var a=Pe(new Oe(this.I),this.j,this.i);return Promise.resolve(a)};function Z(a,b,c){b||(b=new Bb);c||(c=new W);X.call(this,null,b,c);this.N=a;this.I=[];this.timeoutMs=3E4;this.j={};this.i=this.T=null}q(Z,X);p("shaka.player.OfflineVideoSource",Z);Z.prototype.P=function(a){null!=a.licenseRequestTimeout&&(this.j.licenseRequestTimeout=a.licenseRequestTimeout);null!=a.segmentRequestTimeout&&(this.j.segmentRequestTimeout=a.segmentRequestTimeout);X.prototype.P.call(this,a)};
p("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var a=new Rb,b=Ib(a).then(function(){return Sb(a)});b.then(function(){Kb(a)}).catch(function(){Kb(a)});return b});
Z.prototype.za=function(a,b,c,d){var e,f=null,g={},h=[];a=new G(this.T,[new H(a)]);return Pd(new Od(a,this.ba)).then(F(this,function(a){this.a=Pe(new Oe(c),a,this.T);if(this.a.a)return a=Error("Unable to store live streams offline."),a.type="app",Promise.reject(a);this.P({preferredLanguage:b});return X.prototype.V.call(this)})).then(F(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.f);e=new U(null,a,this);null!=this.j.licenseRequestTimeout&&(e.u=Number(this.j.licenseRequestTimeout));
C(this.h,e,"sessionReady",this.ea.bind(this));C(this.h,e,"error",function(a){f=a});return e.initialize()})).then(F(this,function(){for(var a=vb(this.b),b=0;b<a.length;++b)for(var c=a[b],e=0;e<c.streamInfos.length;++e){var f=c.streamInfos[e];g[f.A]=f}return d()})).then(F(this,function(a){for(var b=0;b<a.length;++b){var c=a[b],d=g[c];if(d)h.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}var e=["audio","video"];h=h.filter(function(a){return 0>e.indexOf(a.a.split("/")[0])?!1:
!0});a=h.map(function(a){return a.F.create()});return Promise.all(a)})).then(F(this,function(a){for(var b=h,c=[],d=0;d<b.length;++d)try{c[d]=this.f.addSourceBuffer(ve(b[d]))}catch(e){}if(b.length!=c.length)a=Error("Error initializing streams."),a.type="storage",a=Promise.reject(a);else{for(d=0;d<a.length;++d)(b=a[d])&&c[d].appendBuffer(b);a=Promise.resolve()}return a})).then(F(this,function(){return pf(e,this.timeoutMs)})).then(F(this,function(){return f?Promise.reject(f):hg(this,h,e.a,this.a.periodInfos[0].a)})).then(F(this,
function(a){this.N=a;return f?(ig(this),Promise.reject(f)):Promise.resolve(a)}))};p("shaka.player.OfflineVideoSource.prototype.store",Z.prototype.za);Z.prototype.ya=function(a){this.T=a};Z.prototype.setNetworkCallback=Z.prototype.ya;Z.prototype.ea=function(a){this.I.push(a.detail.sessionId)};
function hg(a,b,c,d){var e=new df(a.X,a);null!=a.j.segmentRequestTimeout&&(e.b=Number(a.j.segmentRequestTimeout));return Ib(e).then(F(a,function(){return ef(e,b,this.I,d,c)})).then(function(a){Kb(e);return Promise.resolve(a)}).catch(function(a){Kb(e);return Promise.reject(a)})}
Z.prototype.V=function(){var a=new Rb,b,c;return Ib(a).then(F(this,function(){return Tb(a,this.N)})).then(F(this,function(d){var e=[];this.I=d.session_ids;b=d.duration;c={keySystem:d.key_system,distinctiveIdentifierRequired:d.distinctive_identifier,persistentStorageRequired:!0,audioRobustness:d.audio_robustness,videoRobustness:d.video_robustness,withCredentials:d.with_credentials,licenseServerUrl:d.license_server};for(var f=0;f<d.stream_ids.length;++f)e.push(Ub(a,d.stream_ids[f]));return Promise.all(e)})).then(F(this,
function(a){var e=b,f=c,g=new Be;g.b=5;for(var h=new Ae,l=0;l<a.length;++l){var m=a[l],n=new te,t=new se(m.references),A=new Vd(null,m.init_segment);n.segmentIndexSource=t;n.F=A;n.a=m.mime_type;n.b=m.codecs;n.J=!0;this.i&&(null!=this.i.licenseServerUrl&&(f.licenseServerUrl=this.i.licenseServerUrl),null!=this.i.withCredentials&&(f.withCredentials=this.i.withCredentials),f.licensePostProcessor=this.i.licensePostProcessor,f.licensePreProcessor=this.i.licensePreProcessor,f.serverCertificate=this.i.serverCertificate);
m=lc(f);t=new we;t.streamInfos.push(n);t.a.push(m);t.contentType=n.a.split("/")[0];h.streamSetInfos.push(t);h.a=e}g.periodInfos.push(h);this.a=g;return X.prototype.V.call(this)})).then(function(){Kb(a);return Promise.resolve()}).catch(function(b){Kb(a);return Promise.reject(b)})};
Z.prototype.ta=function(a,b){a&&(this.i={licenseServerUrl:a.licenseServerUrl,withCredentials:a.withCredentials,serverCertificate:a.serverCertificate,licensePreProcessor:a.licensePreProcessor,licensePostProcessor:a.licensePostProcessor});var c=null;return jg(this).catch(function(a){return b?(c=a,Promise.resolve()):Promise.reject(a)}).then(F(this,function(){return ig(this)})).then(function(){return Promise.resolve(c)})};Z.prototype.deleteGroup=Z.prototype.ta;Z.prototype.ua=function(){return this.I};
Z.prototype.fa=function(){return!0};function ig(a){var b=new df(null,null);return Ib(b).then(F(a,function(){return hf(b,this.N)})).then(function(){Kb(b);return Promise.resolve()}).catch(function(a){Kb(b);return Promise.reject(a)})}
function jg(a){var b=document.createElement("video");b.src=window.URL.createObjectURL(a.f);var c=new U(null,b,a);null!=a.j.licenseRequestTimeout&&(c.u=Number(a.j.licenseRequestTimeout));return a.V().then(function(){return c.initialize()}).then(F(a,function(){return pf(c,this.timeoutMs)})).then(function(){return qf(c)}).then(F(a,function(){c.destroy();this.destroy();return Promise.resolve()})).catch(F(a,function(a){c.destroy();this.destroy();return Promise.reject(a)}))};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined" && define.amd)define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

//# sourceMappingURL=shaka-player.compiled.debug.map
